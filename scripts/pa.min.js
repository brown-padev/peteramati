!function(){"use strict";let t=function(){return!1};try{window.localStorage&&window.JSON&&(t=function(t,e,n){try{var a=t?window.sessionStorage:window.localStorage;return void 0===e?!!a:void 0===n?a.getItem(e):null===n?a.removeItem(e):"object"==typeof n?a.setItem(e,JSON.stringify(n)):a.setItem(e,n)}catch(t){return!1}})}catch(t){}function e(t){var e,n,a,i,r,s,o=t.split(/(%(?:%|-?(?:\d*|\*?)(?:\.\d*)?[sdefgroxX]))/),l="";for(e=0,i=1;e!=o.length;++e)if("%"!=(n=o[e]).charAt(0))l+=n;else if("%"==n.charAt(1))l+="%";else{if(a=arguments[i],++i,"*"==(r=n.match(/^%(-?)(\d*|\*?)(?:|[.](\d*))(\w)/))[2]&&(r[2]=a.toString(),a=arguments[i],++i),r[4]>="e"&&r[4]<="g"&&null==r[3]&&(r[3]=6),"g"===r[4]?a=(a=Number(a).toPrecision(r[3]).toString()).replace(/\.(\d*[1-9])?0+(|e.*)$/,(function(t,e,n){return(null==e?"":"."+e)+n})):"f"===r[4]?a=Number(a).toFixed(r[3]):"e"===r[4]?a=Number(a).toExponential(r[3]):"r"===r[4]?(a=Number(a).toFixed(+(r[3]||0)),+(r[3]||0)&&(a=a.replace(/\.?0*$/,""))):"d"===r[4]?a=Math.floor(a):"o"===r[4]?a=Math.floor(a).toString(8):"x"===r[4]?a=Math.floor(a).toString(16):"X"===r[4]&&(a=Math.floor(a).toString(16).toUpperCase()),a=a.toString(),""!==r[2]&&"0"!==r[2])for(s="0"===r[2].charAt(0)?"0":" ";a.length<parseInt(r[2],10);)a=r[1]?a+s:s+a;l+=a}return l}function n(t,e,n){return(e+=t.toString()).length<=n?e:e.substring(e.length-n)}function a(t,e,n){return n&&e&&!t.getSeconds()?r("%H:%M",t):n?r("%H:%M:%S",t):e&&t.getSeconds()?r("%#l:%M:%S%P",t):e&&t.getMinutes()?r("%#l:%M%P",t):r(e?"%#l%P":"%I:%M:%S %p",t)}t.json=function(e,n){var a=t(e,n);return!!a&&JSON.parse(a)},t.site=function(e,n,a){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t(e,n,a)},t.site_json=function(e,n){return"/"!==siteinfo.base&&(n=siteinfo.base+n),t.json(e,n)};const i={a:function(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]},A:function(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},d:function(t){return n(t.getDate(),"0",2)},e:function(t,e){return n(t.getDate(),e?"":" ",2)},u:function(t){return t.getDay()||7},w:function(t){return t.getDay()},b:function(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]},B:function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]},h:function(t){return i.b(t)},m:function(t){return n(t.getMonth()+1,"0",2)},y:function(t){return t.getFullYear()%100},Y:function(t){return t.getFullYear()},H:function(t){return n(t.getHours(),"0",2)},k:function(t,e){return n(t.getHours(),e?"":" ",2)},I:function(t){return n(t.getHours()%12||12,"0",2)},l:function(t,e){return n(t.getHours()%12||12,e?"":" ",2)},M:function(t){return n(t.getMinutes(),"0",2)},X:function(t){return r("%#e %b %Y %#q",t)},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t,e){return a(t,e,r.is24)},r:function(t,e){return a(t,e,!1)},R:function(t,e){return a(t,e,!0)},S:function(t){return n(t.getSeconds(),"0",2)},T:function(t){return r("%H:%M:%S",t)},D:function(t){return r("%m/%d/%y",t)},F:function(t){return r("%Y-%m-%d",t)},s:function(t){return Math.floor(t.getTime()/1e3)},n:function(){return"\n"},t:function(){return"\t"},"%":function(){return"%"}};function r(t,e){var n,a,r,s,o=t.split(/(%#?\S)/),l="";for(null==e?e=new Date:"number"==typeof e&&(e=new Date(1e3*e)),n=0;n!=o.length;++n)r="#"==(a=o[n]).charAt(1),"%"==a.charAt(0)&&(s=i[a.charAt(1+r)])?l+=s(e,r):l+=a;return l}window.JSON&&window.JSON.parse||(window.JSON={parse:$.parseJSON}),Element.prototype.closest||(Element.prototype.closest=function(t){return $(this).closest(t)[0]}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.trimStart||(String.prototype.trimStart=function(){return this.replace(/^[\s\uFEFF\xA0]+/,"")});class s{constructor(t){this.value=t}then(t){try{return new s(t(this.value))}catch(t){return Promise.reject(t)}}catch(){return this}finally(t){try{t()}catch(t){}return this}}function o(t,e){return t===e||(t=(null==t?"":t).replace(/\r\n?/g,"\n"))===(e=(null==e?"":e).replace(/\r\n?/g,"\n"))}let l,d,u,h,c;"classList"in document.createElement("span")&&!/MSIE|rv:11\.0/.test(navigator.userAgent||"")?(l=function(t,e){let n=t.classList;return n&&n.contains(e)},d=function(t,e){t.classList.add(e)},u=function(t,e){t.classList.remove(e)},h=function(t,e,n){t.classList.toggle(e,n)},c=function(t){return t.classList}):(l=function(t,e){return $(t).hasClass(e)},d=function(t,e){$(t).addClass(e)},u=function(t,e){$(t).removeClass(e)},h=function(t,e,n){$(t).toggleClass(e,n)},c=function(t){let e=$.trim(t.className);return""===e?[]:e.split(/\s+/)});let p={};function f(t){let e=t.target;(e&&(l(e,"ui")||l(e,"ui-submit"))||"A"===this.tagName&&l(this,"ui"))&&t.preventDefault();let n=c(this);for(let e=0;e<n.length;++e){let a=p[n[e]];if(a)for(let e=0;e<a.length;++e)a[e].call(this,t)}}function g(t,e,n){return null!=n&&(n=!n),h(t,"hidden",n),e&&$(e).find("span.foldarrow").html(l(t,"hidden")?"&#x25B6;":"&#x25BC;"),!1}f.on=function(t,e){p[t]=p[t]||[],p[t].push(e)},f.trigger=function(t,e){let n=p[t];if(n){"string"==typeof e&&(e=$.Event(e));for(let t=0;t<n.length;++t)e.isImmediatePropagationStopped()||n[t].call(this,e)}},$(document).on("click",".ui, .uic",f),$(document).on("change",".uich",f),$(document).on("keydown",".uikd",f),$(document).on("input",".uii",f),$(document).on("unfold",".ui-unfold",f),$(document).on("mouseup mousedown",".uim",f);const m={Spacebar:" ",Esc:"Escape"},v={9:"Tab",13:"Enter",27:"Escape"},b={9:"Tab",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",20:"CapsLock",27:"Escape",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",91:"OSLeft",92:"OSRight",93:"OSRight",224:"OSLeft",225:"AltRight"},x={Alt:2,AltLeft:2,AltRight:2,CapsLock:2,Control:2,ControlLeft:2,ControlRight:2,Meta:2,OSLeft:2,OSRight:2,Shift:2,ShiftLeft:2,ShiftRight:2,ArrowLeft:1,ArrowRight:1,ArrowUp:1,ArrowDown:1,Backspace:1,Enter:1,Escape:1,PageUp:1,PageDown:1,Tab:1};function y(t){let e;return"string"==typeof t?t:null!=(e=t.key)?m[e]||e:(e=t.charCode)?v[e]||String.fromCharCode(e):(e=t.keyCode)?b[e]?b[e]:e>=48&&e<=57||e>=65&&e<=90?String.fromCharCode(e):void 0:""}function w(t){return(t.shiftKey?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0)+(t.metaKey?8:0)}y.printable=function(t){return!(x[y(t)]||"string"!=typeof t&&(t.ctrlKey||t.metaKey))},y.modifier=function(t){return x[y(t)]>1},y.is_default_a=function(t,e){return!(t.shiftKey||t.metaKey||t.ctrlKey||0!=t.button||e&&l("ui",e))},w.SHIFT=1,w.CTRL=2,w.ALT=4,w.META=8;let _=null;function A(t,e){return $("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,width:e||t.width(),fontSize:t.css("fontSize"),fontFamily:t.css("fontFamily"),fontWeight:t.css("fontWeight"),lineHeight:t.css("lineHeight"),resize:"none","word-wrap":"break-word",whiteSpace:"pre-wrap"}).appendTo(document.body)}function k(){for(var t=_.length-1;t>=0;--t)_[t]()}function C(t,e){var n=t.data("autogrower");t.removeData("autogrower"),e&&e.remove();for(var a=_.length-1;a>=0;--a)_[a]===n&&(_[a]=_[_.length-1],_.pop())}function M(t){if("string"==typeof t)return t;if(t){var e,n,a=[];for(e in t)null!=(n=t[e])&&a.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return a.join("&")}return""}function S(t,e,n){if(!1!==t.first&&t.v.length){for(var a=0;a<t.v.length;++a){var i=e.exec(t.v[a]);if(i)return t.pt+=n+i[1]+"/",t.v.splice(a,1),void(t.first=i[1])}t.first=!1}}function T(t,e){if(!1!==t.last&&t.v.length){for(var n=0;n<t.v.length;++n){var a=e.exec(t.v[n]);if(a)return t.t+="/"+a[1],t.v.splice(n,1),void(t.last=a[1])}t.last=!1}}function N(t,e){var n,a,i,r,s="";if(null!=siteinfo.site_relative&&null!=siteinfo.suffix||(siteinfo.site_relative=siteinfo.suffix=""),r={pt:"",t:t+siteinfo.suffix},"string"==typeof e)(i=e.match(/^(.*?)(#.*)$/))&&(e=i[1],s=i[2]),r.v=e.split(/&/);else for(n in r.v=[],e)null==(a=e[n])||("anchor"===n?s="#"+a:r.v.push(encodeURIComponent(n)+"="+encodeURIComponent(a)));return"help"===t?T(r,/^t=(\w+)$/):"api"===t.substr(0,3)?(t.length>3&&(r.t="api"+siteinfo.suffix,r.v.push("fn="+t.substr(4))),S(r,/^u=([^?&#]+)$/,"~"),T(r,/^fn=(\w+)$/),T(r,/^pset=([^?&#]+)$/),T(r,/^commit=([0-9A-Fa-f]+)$/)):"index"===t?S(r,/^u=([^?&#]+)$/,"~"):"pset"!==t&&"run"!==t||(S(r,/^u=([^?&#]+)$/,"~"),T(r,/^pset=([^?&#]+)$/),T(r,/^commit=([0-9A-Fa-f]+)$/)),siteinfo.defaults&&r.v.push(M(siteinfo.defaults)),r.v.length&&(r.t+="?"+r.v.join("&")),siteinfo.site_relative+r.pt+r.t+s}function j(t,e){return e=M(e),N(t,e+=(e?"&":"")+"post="+siteinfo.postvalue)}function E(t,e){var n,a=t.closest(".pa-psetinfo");return e=e||{},n=a.getAttribute("data-pa-user"),e.u=n||siteinfo.uservalue,(n=a.getAttribute("data-pa-pset"))&&(e.pset=n),(n=a.getAttribute("data-pa-hash"))&&(e.commit=n),e}function L(t,e){var n,a="";if(e=e||window.location.href,!/^\w+:\/\//.test(t)&&(n=e.match(/^(\w+:)/))&&(a=n[1]),a&&!/^\/\//.test(t)&&(n=e.match(/^\w+:(\/\/[^\/]+)/))&&(a+=n[1]),a&&!/^\//.test(t)&&(n=e.match(/^\w+:\/\/[^\/]+(\/[^?#]*)/)))for(a=(a+n[1]).replace(/\/[^\/]+$/,"/");"../"===t.substring(0,3);)a=a.replace(/\/[^\/]*\/$/,"/"),t=t.substring(3);return a+t}$.fn.autogrow=function(){return this.each((function(){var t=$(this),e=t.data("autogrower");u(this,"need-autogrow"),e||("TEXTAREA"===this.tagName?e=function(t){var e,n,a;return function(i){if(!1===i)return C(t,e);var r=t.width();if(!(r<=0)){e||(e=A(t,r),n=t.height(),a=e.text("!").height());var s=t[0].value;i&&"keydown"==i.type&&13===i.keyCode&&(s+="\n"),e.css("width",r).text(s+"...");var o=Math.max($(window).height()-4*a,4*a);t.height(Math.min(o,Math.max(e.height(),n)))}}}(t):"INPUT"===this.tagName&&"text"===this.type&&(e=function(t){var e;return function(n){if(!1===n)return C(t,e);var a,i=0;try{i=t.outerWidth()}catch(t){}if(!(i<=0)){if(!e){e=A(t,i);var r=t.css(["paddingRight","paddingLeft","borderLeftWidth","borderRightWidth"]);e.css({width:"auto",display:"table-cell",paddingLeft:r.paddingLeft,paddingRight:parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth)+"px"}),"0px"===(a=t.css(["minWidth","maxWidth"])).minWidth&&t.css("minWidth",i+"px"),"none"!==a.maxWidth||t.hasClass("wide")||t.css("maxWidth","640px")}e.text(t[0].value+"  "),a=t.css(["minWidth","maxWidth"]);var s=Math.min(e.outerWidth(),$(window).width()),o=parseFloat(a.maxWidth);o==o&&(s=Math.min(s,o)),t.outerWidth(Math.max(s,parseFloat(a.minWidth)))}}}(t)),e&&(t.data("autogrower",e).on("change input",e),_||(_=[],$(window).resize(k)),_.push(e))),e&&""!==t.val()&&e()})),this},$.fn.unautogrow=function(){return this.each((function(){var t=$(this).data("autogrower");t&&t(!1)})),this},$((function(){$(".need-autogrow").autogrow()})),f.on("js-range-click",(function(t){if("change"!==t.type){var e=$(this).closest("form"),n=e[0].jsRangeClick||{},a=this.getAttribute("data-range-type")||this.name;e[0].jsRangeClick=n;var i=!1;if("keydown"!==t.type||w(t)||(i=y(t)),!(n.__clicking__||"updaterange"===t.type&&n["__update__"+a]||"keydown"===t.type&&"ArrowDown"!==i&&"ArrowUp"!==i)){var r=[],s=[];e.find("input.js-range-click").each((function(){var t=this.getAttribute("data-range-type")||this.name;a===t&&(r.push(this),l(this,"is-range-group")&&s.push(this))}));var o,d,u,h=n[a];for(u=0;u!==r.length;++u)r[u]===this&&(o=u),r[u]===h&&(d=u);if(i)return 0!==o&&"ArrowUp"===i?--o:o<r.length-1&&"ArrowDown"===i&&++o,$(r[o]).focus().scrollIntoView(),void t.preventDefault();var c,p=!1,f=!1;if("click"===t.type){for(n.__clicking__=!0,l(this,"is-range-group")?(u=0,c=r.length-1,p=this.getAttribute("data-range-group")):(n[a]=this,t.shiftKey&&h?d<=o?(u=d,c=o-1):(u=o+1,c=d):(u=1,c=0,f=this.getAttribute("data-range-group")));u<=c;)r[u].checked===this.checked||l(r[u],"is-range-group")||p&&r[u].getAttribute("data-range-group")!==p||$(r[u]).trigger("click"),++u;delete n.__clicking__}else"updaterange"===t.type&&(n["__updated__"+a]=!0);for(c=0;c!==s.length;++c)if(p=s[c].getAttribute("data-range-group"),!f||p===f){var g=null;for(u=0;u!==r.length;++u)if(r[u].getAttribute("data-range-group")===p&&!l(r[u],"is-range-group"))if(null===g)g=r[u].checked;else if(g!==r[u].checked){g=2;break}2===g?(s[c].indeterminate=!0,s[c].checked=!0):(s[c].indeterminate=!1,s[c].checked=g)}}}})),$((function(){$(".is-range-group").each((function(){f.trigger.call(this,"js-range-click","updaterange")}))}));let O=0,I=[];function D(t){if(void 0===t)return O>0;O>0?I.push(t):t()}$.ajaxPrefilter((function(t){if(!1!==t.global){var e=t.success;t.error?$.isArray(t.error)?t.error.push(n):t.error=[t.error,n]:t.error=n,null==t.timeout&&(t.timeout=1e4),null==t.dataType&&(t.dataType="json"),t.trackOutstanding&&++O}function n(t,n,a){if(e){var i;if(/application\/json/.test(t.getResponseHeader("Content-Type")||"")&&t.responseText)try{i=JSON.parse(t.responseText)}catch(t){}i&&"object"==typeof i&&!1===i.ok||(i={ok:!1}),i.error||(i.error=function(t,e,n){return"parsererror"===e?"Internal error: bad response from server.":n?n.toString():"timeout"===e?"Connection timed out.":e?"Failed ["+e+"].":"Failed."}(0,n,a)),e(i,t,n)}}})),$(document).ajaxComplete((function(t,e,n){if(n.trackOutstanding&&0==--O)for(;I.length;)I.shift()()}));let P,R=0,F=[];function W(t,e,n){return new Promise((function(a){function i(){++R,$.ajax(t,{data:e,method:n||"POST",cache:!1,dataType:"json",success:function(t){a(t),--R,F.length&&F.shift()()}})}R<5?i():F.push(i)}))}function H(e){for(var n="string"==typeof e?1:0,a=t.site_json(!1,"list_digests")||[],i=-1,r=(new Date).getTime(),s=0;s<a.length;++s){var o=a[s];o[n]===e?i=s:o[2]<r-3e4?(a.splice(s,1),--s):r<=o[0]&&(r=o[0]+1)}return i>=0?a[i][2]=r:n&&(a.push([r,e,r]),i=a.length-1),t.site(!1,"list_digests",a),i>=0&&a[i][1-n]}function B(t){var e,n;return(n=/^list(\d+)(?=\s|$)/.exec(t))&&(e=H(+n[1]))?e:t}function U(t,e){var n=function(t){var e=H(t);return e?"list"+e:t}(t=B(t));e&&/(?:^|\/)pset(?:|\.php)\//.test(e)&&(n+=function(t,e){var n,a,i=/(?:^|\/)(~[^\/]+)\/pset(?:|\.php)\/([^\/]+)((?:\/[0-9a-f]+)?)(?=[\/?#]|$)/.exec(e);if(i){if((t=JSON.parse(t)).pset){if(t.pset!==i[2])return"";n=a=i[1]}else n=(a=i[1]+"/pset/"+i[2])+i[3];var r=t.items.indexOf(n);if(r<0&&a!==n&&(r=t.items.indexOf(a)),r>=0)return" "+JSON.stringify({cur:i[1]+"/pset/"+i[2],prev:0===r?null:t.items[r-1],next:r===t.items.length-1?null:t.items[r+1]})}return""}(t,e)),P=(new Date).getTime();var a,i="; Max-Age=20";siteinfo.site_relative&&(a=/^[a-z]+:\/\/[^\/]*(\/.*)/.exec((siteinfo.absolute_base||(siteinfo.absolute_base=L(siteinfo.base)),siteinfo.absolute_base)))&&(i+="; Path="+a[1]),document.cookie="hotlist-info-"+P+"="+encodeURIComponent(n)+siteinfo.cookie_params+i}function z(t,e){var n,a;if(e&&e.startsWith(siteinfo.site_relative)&&function(t){return/(?:^|\/)pset(?:|\.php)(?:$|\/)/.test(t)}(a=e.substring(siteinfo.site_relative.length))&&(n=t.closest(".has-hotlist"))){var i=n.getAttribute("data-hotlist");if(!i){var r=jQuery.Event("pa-hotlist");$(n).trigger(r),(i=r.hotlist)&&"string"!=typeof i&&(i=JSON.stringify(i))}i&&U(i,a)}}function q(){var t,e=location.href;return location.hash&&(e=e.substring(0,e.length-location.hash.length)),this.href.substring(0,e.length+1)===e+"#"||!!D()&&(D((t=this,function(){window.location=t.href})),!0)}$(document).on("click","a",(function(t){l(this,"ui")||y.is_default_a(t)&&!this.target&&q.call(this,t)||z(this,this.getAttribute("href"))})),$(document).on("submit","form",(function(t){l(this,"ui-submit")?f.call(this,t):z(this,this.getAttribute("action"))})),$(window).on("beforeunload",(function(){var t=document.body.getAttribute("data-hotlist");t&&(!P||P+3<(new Date).getTime())&&U(t,location.href)})),$((function(){$(".has-hotlist").each((function(){var t=this.getAttribute("data-hotlist");t&&t.startsWith("list")&&(t=B(t))&&this.setAttribute("data-hotlist",t)}))}));const J=/[&<>\"']/g,K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function V(t){return null!==t&&"number"!=typeof t?t.replace(J,(function(t){return K[t]})):t}function X(t){return encodeURIComponent(t).replace(/[^-A-Za-z0-9%]/g,(function(t){return"_"+t.charCodeAt(0).toString(16)})).replace(/%../g,(function(t){return"_"+t.substr(1).toLowerCase()}))}const G=["Top","Right","Bottom","Left"],Y=["top","right","bottom","left"],Q=["height","width"];function Z(t,e){return"border"+G[t]+e}function tt(t){return Z(t,"Color")}let et=Math.round;var nt;function at(t){var e,n,a=function(t){return $('<div class="bubble hidden'+t+'"><div class="bubtail bubtail0'+t+'"></div></div>').appendTo(document.body)}(t),i=a.children(),r=[i.width(),i.height()];for(e=0;e<4;++e)r[Y[e]]=0,(n=a.css("margin"+G[e]))&&(n=parseFloat(n))&&(r[Y[e]]=n);return a.remove(),r}function it(t,e){!e&&t&&"object"==typeof t?t=(e=t).content:e?"string"==typeof e&&(e={color:e}):e={};var n=null,a=e.dir,i=null,r=e.color?" "+e.color:"",s=$('<div class="bubble'+r+'" style="margin:0"><div class="bubtail bubtail0'+r+'" style="width:0;height:0"></div><div class="bubcontent"></div><div class="bubtail bubtail1'+r+'" style="width:0;height:0"></div></div>')[0];document.body.appendChild(s),e["pointer-events"]&&$(s).css({"pointer-events":e["pointer-events"]});var o=s.childNodes,l=null,d=null;function u(){var t=[0,0,0,0],e=l[1],n=l[0]/2;(d=parseFloat($(s).css(Z(i,"Width"))))!=d&&(d=0),t[1^i]=t[3^i]=n+"px",t[2^i]=e+"px",o[0].style.borderWidth=t.join(" "),t[1^i]=t[3^i]=n+"px",t[2^i]=e+"px",o[2].style.borderWidth=t.join(" ");for(var a=1;a<=3;++a)o[0].style[Y[i^a]]=o[2].style[Y[i^a]]="";o[0].style[Y[i]]=-e-d+"px";var r=d/n*Math.sqrt(e*e+n*n);for(o[2].style[Y[i]]=-e-d+r+"px",a=0;a<3;a+=2)o[a].style.borderLeftColor=o[a].style.borderRightColor=o[a].style.borderTopColor=o[a].style.borderBottomColor="transparent";var u,h,c=(u=$(s).css("backgroundColor"),h=u.match(/^rgb\((.*)\)$/),h?"rgba("+h[1]+", 1)":u).replace(/([\d.]+)\)/,(function(t,e){return.75*e+.25+")"}));o[0].style[tt(2^i)]=$(s).css(tt(i)),o[2].style[tt(2^i)]=c}function h(t,e,n,a){var i=t[Y[n]],r=t[Y[2^n]],s=(1-a)*i+a*r;return s=Math.max(s,Math.min(r,e[Y[n]]+8)),Math.min(s,Math.max(i,e[Y[2^n]]-8))}function c(t,e,n,a,i,r){var s=e[Y[a]],o=e[Y[2^a]],d=n[Q[1&a]],u=t-i*d;return!r&&u<s+8?u=Math.min(t-l[0],s+8):!r&&u+d>o-8&&(u=Math.max(t+l[0]-d,o-8-d)),u}function p(t,e){var a=Math.max(3===e?0:n.left-t.left,1===e?0:t.right-n.right);return("h"===e||1===e||3===e)&&a>100?Math.min(t.width,a)-24:t.width-24}function f(t,e){var a=$(s);a.css("maxWidth","");var i=a.geometry(!0),r=p(t,e);r<i.width&&(a.css("maxWidth",r),i=a.geometry(!0));var o=[n.top-l.bottom-i.height-l[0],n.right+l.left+i.width+l[0],n.bottom+l.top+i.height+l[0],n.left-l.right-i.width-l[0]];return o.width=i.width,o.height=i.height,o.wconstraint=r,o}function g(t,e,n){var a=p(e,n);return(a<t.wconstraint&&a<t.width||a>t.wconstraint&&t.width>=t.wconstraint)&&(t=f(e,n)),t}function m(t,e){var n;return t.length>e&&(n="0123trblnesw".indexOf(t.charAt(e)))>=0?n%4:-1}function v(t,e){var n,a=$(s).css("border"+t+"Radius");return a?((n=a.indexOf(" "))>-1&&(a=e?a.substring(n+1):a.substring(0,n)),parseFloat(a)):0}function b(t,e,n){var a,i;return 1&n?(a=v(G[0]+G[n],1),i=v(G[2]+G[n],1)):(a=v(G[n]+G[3],1),i=v(G[n]+G[1],1)),Math.min(Math.max(t,a),e[Q[1&n^1]]-i-l[0])}function x(){l||(l=at(r)),null==a&&(a="r");var t=/!/.test(a),e=/\*/.test(a),d=a.replace(/[^a0-3neswtrblhv]/,""),p=m(d,0),v=m(d,1);v=p>=0&&v>=0&&(1&v)!=(1&p)?1===v||2===v?1:0:.5,p<0&&(p=/^[ahv]$/.test(d)?d:"a");var x=$(window).geometry(),y=f(x,d);"a"===p&&(y.height+l[0]>Math.max(n.top-x.top,x.bottom-n.bottom)?y=g(y,x,p="h"):p="v");var w,_,A,k,C,M=[x.top+24,x.right-24,x.bottom-24,x.left+24];("v"===p||0===p||2===p)&&!t&&v<0&&y[2]>M[2]&&y[0]<M[0]&&(y[3]>=M[3]||y[1]<=M[1])&&(y=g(y,x,p="h")),y=g(y,x,p="v"===p&&y[2]>M[2]&&y[0]>M[0]||0===p&&!t&&y[2]>x.bottom&&x.top-y[0]<y[2]-x.bottom||2===p&&(t||y[0]>=x.top+8)?2:"v"===p||0===p||2===p?0:"h"===p&&y[3]-x.left<x.right-y[1]||1===p&&!t&&y[3]<x.left||3===p&&(t||y[1]<=x.right-8)?3:1),p!==i&&(i=p,u());var S=parseFloat($(s).css(Z(1&p?0:3,"Width")));1&p?(_=c(k=h(n,x,0,v),x,y,0,v,e),C=b(et(k-_-l[0]/2-S),y,p),o[0].style.top=o[2].style.top=C+"px",w=1==p?n.left-l.right-y.width-l[1]-1:n.right+l.left+l[1]):(w=c(A=h(n,x,3,v),x,y,3,v,e),C=b(et(A-w-l[0]/2-S),y,p),o[0].style.left=o[2].style.left=C+"px",_=0==p?n.bottom+l.top+l[1]:n.top-l.bottom-y.height-l[1]-1),s.style.left=et(w)+"px",s.style.top=et(_)+"px",s.style.visibility="visible"}function y(){s&&s.parentElement.removeChild(s),s=null}var w={near:function(t,e){("string"==typeof t||t.tagName||t.jquery)&&(t=$(t),null==a&&t[0]&&(a=t[0].getAttribute("data-tooltip-dir")),t=t.geometry(!0));for(let e=0;e<4;++e)!(Y[e]in t)&&Y[2^e]in t&&(t[Y[e]]=t[Y[2^e]]);var i,r;return e&&(e=$(e))&&e.length&&e[0]!=window&&(i=t,r=e.geometry(),(i=$.extend({},i)).top+=r.top,i.right+=r.left,i.bottom+=r.top,i.left+=r.left,t=i),n=t,x(),w},at:function(t,e,n){return w.near({top:e,left:t},n)},dir:function(t){return a=t,w},remove:y,color:function(t){return r!==(t=t?" "+t:"")&&(r=t,s.className="bubble"+r,o[0].className="bubtail bubtail0"+r,o[2].className="bubtail bubtail1"+r,i=l=null,n&&x()),w},html:function(t){var e=o[1];if(void 0===t)return e.innerHTML;if("string"==typeof t&&t===e.innerHTML&&"visible"===s.style.visibility)return w;if(n&&$(s).css({maxWidth:"",left:"",top:""}),"string"==typeof t)e.innerHTML=t;else{for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);t&&t.jquery?t.appendTo(e):e.appendChild(t)}return n&&x(),w},text:function(t){return void 0===t?$(o[1]).text():w.html(t?function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}(t):t)},content_node:function(){return o[1].firstChild},hover:function(t,e){return $(s).hover(t,e),w},removeOn:function(t,e){return arguments.length>1?$(t).on(e,y):s&&$(s).on(t,y),w},self:function(){return s?$(s):null},outerHTML:function(){return s?s.outerHTML:null}};return t&&w.html(t),w}window.devicePixelRatio&&window.devicePixelRatio>1&&(nt=window.devicePixelRatio,et=function(t){return Math.round(t*nt)/nt});let rt,st,ot,lt={};function dt(t){if(window.disable_tooltip)return null;var e=$(this);(t=function(t,e){var n=t.getAttribute("data-tooltip-info");return n&&("string"==typeof n&&"{"===n.charAt(0)?n=JSON.parse(n):"string"==typeof n&&(n={builder:n}),e=$.extend(n,e)),e.builder&&lt[e.builder]&&(e=lt[e.builder].call(t,e)||e),(null==e.dir||t.hasAttribute("data-tooltip-dir"))&&(e.dir=t.getAttribute("data-tooltip-dir")||"v"),(null==e.type||t.hasAttribute("data-tooltip-type"))&&(e.type=t.getAttribute("data-tooltip-type")),(null==e.className||t.hasAttribute("data-tooltip-class"))&&(e.className=t.getAttribute("data-tooltip-class")||"dark"),t.hasAttribute("data-tooltip")?e.content=t.getAttribute("data-tooltip"):null==e.content&&t.hasAttribute("aria-label")?e.content=t.getAttribute("aria-label"):null==e.content&&t.hasAttribute("title")&&(e.content=t.getAttribute("title")),e}(e[0],$.extend({},t||{}))).element=this;var n,a=null,i=null,r=null,s=0,o=t.content;function l(){i=clearTimeout(i),a&&a.remove(),e.removeData("tooltipState"),window.global_tooltip===n&&(window.global_tooltip=null)}function d(){o&&!a?(a=it(o,{color:"tooltip "+t.className,dir:t.dir}),r=t.near||t.element,a.near(r).hover(n.enter,n.exit)):o?a.html(o):a&&(a&&a.remove(),a=r=null)}return n={enter:function(){return i=clearTimeout(i),++s,n},exit:function(){var e="focus"===t.type?0:200;return i=clearTimeout(i),0==--s&&"sticky"!==t.type&&(i=setTimeout(l,e)),n},erase:l,_element:e[0],html:function(t){return void 0===t?o:(o=t,d(),n)},text:function(t){return n.html(V(t))},near:function(){return r}},function a(i){if(i instanceof Promise)i.then(a);else{var r=window.global_tooltip;o=i,r&&r._element===t.element&&r.html()===o&&!t.done?n=r:(r&&r.erase(),e.data("tooltipState",n),d(),window.global_tooltip=n)}}(o),t.done=!0,n}function ut(){var t=$(this).data("tooltipState")||dt.call(this);t&&t.enter()}function ht(){var t=$(this).data("tooltipState");t&&t.exit()}function ct(){u(this,"need-tooltip"),"focus"===this.getAttribute("data-tooltip-type")?$(this).on("focus",ut).on("blur",ht):$(this).hover(ut,ht)}function pt(t){return t.closest(".pa-filediff")||document.getElementById(t.closest(".pa-fileref").getAttribute("data-pa-fileid"))}function ft(t){if(l(t,"need-load")){let e=t.closest(".pa-psetinfo");return new Promise((function(n){var a;$.ajax(N("api/filediff",E(t)),{type:"GET",cache:!1,dataType:"json",data:{file:(a=t.id.substr(8),decodeURIComponent(a.replace(/_/g,"%"))),base_hash:e.getAttribute("data-pa-base-hash"),hash:e.getAttribute("data-pa-hash")},success:function(e){if(e.ok&&e.content_html){var a=$(e.content_html);$(t).html(a.html())}u(t,"need-load"),n(t)}})}))}return new s(t)}function gt(t,e){if(null==e){t instanceof Node&&(t=t.hash);var n=t.match(/^#?L([ab]\d+)_(.*)$/);if(!n)return Promise.reject(null);t=n[2],e=n[1]}else{if(t instanceof Node){for(var a=t;a&&!a.hasAttribute("data-pa-file");)a=a.parentElement;if(!a)return Promise.reject(null);t=a.getAttribute("data-pa-file"),a.hasAttribute("data-pa-file-user")&&(t=a.getAttribute("data-pa-file-user")+"-"+t)}t=X(t)}var i="L"+e+"_"+t,r=document.getElementById(i);if(r)return new s(r);var o=document.getElementById("pa-file-"+t);return o?ft(o).then((()=>{const t=$(o).find(".pa-d"+e.charAt(0)),n=e.substr(1);for(let e=0;e<t.length;++e)if(t[e].getAttribute("data-landmark")===n)return t[e].id=i,t[e];const a=$(o).find(".pa-dl[data-landmark='"+e+"']");if(a.length)return a[0];throw null})):Promise.reject(null)}function mt(t,e){var n=null;return gt(t,e).then((t=>n=t),null),n}function vt(t){let e,n,a;return l(t,"pa-gd")?"a"+t.firstChild.getAttribute("data-landmark"):l(t,"pa-dlr")&&(e=t.lastChild.firstChild)&&(n=e.getAttribute("data-landmark"))&&(a=n.indexOf("-"))>=0?"b"+n.substring(a+1):"b"+t.firstChild.nextSibling.getAttribute("data-landmark")}function bt(t,e,n){var a,i=(t=t.closest(".pa-dl, .pa-dg, .pa-filediff"))?t.parentElement:null;for(null==e?(e=!1,a="previousSibling"):(a=e?"nextSibling":"previousSibling",l(t,"pa-dl")&&(t=t[a]));;){for(;!t&&i;){if(1&n&&l(i,"pa-filediff"))return null;t=i[a],i=i.parentElement}if(!t)return null;if(t.nodeType!==Node.ELEMENT_NODE)t=t[a];else{if(l(t,"pa-dl")&&(2&n||/ pa-g[idc]/.test(t.className))&&t.offsetParent)return t;t=l(t,"pa-dg")||l(t,"pa-filediff")?(i=t)[e?"firstChild":"lastChild"]:t[a]}}}function xt(t,e){if(!t||"TEXTAREA"===t.tagName||"A"===t.tagName)return null;const n=t.closest(".pa-dl");let a,i=bt(t,e,1);if(!i||!(a=i.closest(".pa-filediff")))return null;const r=a.getAttribute("data-pa-file"),s={ufile:r,file:r,tr:i},o=a.getAttribute("data-pa-file-user");let d;if(o&&(s.ufile=o+"-"+r),n&&(d=n.getAttribute("data-landmark"))&&/^[ab]\d+$/.test(d)?(s[d.charAt(0)+"line"]=+d.substring(1),s.lineid=d):(s.aline=+i.firstChild.getAttribute("data-landmark"),s.bline=+i.firstChild.nextSibling.getAttribute("data-landmark"),s.lineid=s.bline?"b"+s.bline:"a"+s.aline),n&&l(n,"pa-gw"))s.notetr=n;else for(;i=i.nextSibling,i;)if(i.nodeType===Node.ELEMENT_NODE){if(l(i,"pa-gw")){s.notetr=i;break}if(i.offsetParent&&!l(i,"pa-gn"))break}return s}function yt(t,e){var n,a=e.length?e.join("").concat(t):t,i=t.match(/<[^>]*>/g);if(i)for(n=0;n!==i.length;++n)"/"===i[n].charAt(1)?e.pop():e.push(i[n]);for(n=e.length-1;n>=0;--n){var r=e[n].indexOf(" ");a=a.concat("</",e[n].substr(1,r<0?-1:r-1),">")}return a}function wt(t){return t[0]+1===t[1]?String(t[1]):t[0]+1+"-"+t[1]}function _t(t,e,n,a,i){var r=t[e];return r.map&&0===r.level&&r.attrSet("data-landmark",wt(r.map)),i.renderToken(t,e,n,a)}function At(t,e,n,a,i){var r=t[e];return r.map&&r.level<=1&&r.attrSet("data-landmark",wt(r.map)),i.renderToken(t,e,n,a)}function $t(t,e){if(e.map&&0===e.level){var n=' data-landmark="'+wt(e.map)+'"',a=t.indexOf(" "),i=t.indexOf(">");a>0&&a<i&&(i=a),t=t.substring(0,i)+n+t.substring(i)}return t}function kt(t){return t?function(e,n,a,i,r){var s=e[n];return $t(t(e,n,a,i,r),s)}:_t}function Ct(){if(!st){for(var t of(st=markdownit().use(markdownit_katex),["paragraph_open","heading_open","ordered_list_open","bullet_list_open","table_open","blockquote_open","hr"]))st.renderer.rules[t]=kt(st.renderer.rules[t]);st.renderer.rules.fence=st.renderer.rules.code_block=function(t){return function(e,n,a,i,r){var s,o,l,d,u,h=e[n],c=h,p=h.info?t.utils.unescapeAll(h.info):"",f=!1;if(p&&p.indexOf(" ")>=0&&((u=p.match(/^ *([-a-z+]+) *$/))?p=u[1]:(h.content=p+"\n"+h.content,h.map&&(h.map[0]-=1),p="")),(s=p?p.trim().split(/\s+/g)[0]:"")&&hljs.getLanguage(s))try{o=hljs.highlight(s,h.content,!0).value,f=!0}catch(t){}if(f||(o=t.utils.escapeHtml(h.content)),p&&(l=h.attrIndex("class"),c={attrs:h.attrs?h.attrs.slice():[]},l<0?c.attrs.push(["class",a.langPrefix+s]):c.attrs[l][1]+=" "+a.langPrefix+s),d="><code".concat(r.renderAttrs(c),">"),h.map&&0===h.level){var g=o.split(/\n/),m=[],v=h.map[0]+2;""===g[g.length-1]&&g.pop();var b=g.length;if(f){var x=[];for(l=0;l!==b;++l)m.push('<pre data-landmark="',v+l,l+1!==b?'" class="partial"':'"',d,yt(g[l],x),"\n</code></pre>")}else for(l=0;l!==b;++l)m.push('<pre data-landmark="',v+l,l+1!==b?'" class="partial"':'"',d,g[l],"\n</code></pre>");return m.join("")}return"<pre".concat(d,o,"</code></pre>")}}(st),st.renderer.rules.image=function(t){function e(t,e){return siteinfo.site_relative+"~"+encodeURIComponent(siteinfo.uservalue)+"/raw/"+t.getAttribute("data-pa-pset")+"/"+t.getAttribute("data-pa-hash")+"/"+e}return function(n,a,i,r,s){var o,l,d,u=n[a],h=u.attrIndex("src"),c=u.attrs[h][1];if(siteinfo.uservalue&&ot&&(o=ot.closest(".pa-psetinfo"))){if(!/\/\//.test(c)){for(var p=ot.closest(".pa-filediff"),f=p&&p.hasAttribute("data-pa-file")?p.getAttribute("data-pa-file").replace(/^(.*)\/[^\/]*$/,"$1"):"";;)if(c.startsWith("./"))c=c.substring(2).replace(/^\/+/,"");else if(c.startsWith("../")&&""!==f)c=c.substring(3).replace(/^\/+/,""),f=f.replace(/(?:^|\/)[^\/]+\/*$/,"");else{if(c.startsWith("../")||c.startsWith("/")){c=null;break}if(!(l=c.match(/(^|\/+)[^\/]+\/\.\.(?:\/+|$)(.*)$/)))break;c=l[1]+l[2]}u.attrs[h][1]=c?e(o,f?f+"/"+c:c):"data:image/jpg,"}(l=c.match(/^https:\/\/github\.com\/([^\/]+\/[^\/]+)\/(?:blob|raw)\/([^\/]+)\/(.*)$/))&&(d=(o.getAttribute("data-pa-repourl")||"").match(/^(?:https:\/\/github\.com\/|git@github\.com:)(.*?)\/?$/))&&d[1]==l[1]&&o.getAttribute("data-pa-branch")==l[2]&&(u.attrs[h][1]=e(o,l[3]))}return $t(t(n,a,i,r,s),u)}}(st.renderer.rules.image),st.renderer.rules.list_item_open=At}return st}function Mt(t){for(var e;(e=t.firstChild)&&1!==e.nodeType;)t.removeChild(e);if(e&&e.hasAttribute("data-landmark")){for(;e.nextSibling&&1!==e.nextSibling.nodeType;)t.removeChild(e.nextSibling);if(e.nextSibling){"OL"===t.tagName&&(e.hasAttribute("value")||(e.value=t.start),t.start=e.value+1);var n=document.createElement(t.tagName);n.appendChild(t.removeChild(e)),t=n}t.setAttribute("data-landmark",e.getAttribute("data-landmark"))}return t}function St(){if(!l(this,"pa-markdown")&&!l(this,"pa-highlight")){for(var t,e=this.firstChild,n=[],a=1;e;){var i=e.nextSibling;if(l(e,"pa-dlr"))this.removeChild(e);else if(l(e,"pa-gi")||l(e,"pa-gc")){for(t=+e.firstChild.nextSibling.getAttribute("data-landmark");a<t;)n.push("\n"),++a;n.push(e.lastChild.textContent),l(e.lastChild,"pa-dnonl")||n.push("\n"),++a,d(e,"hidden")}e=i}var r,s=document.createElement("div");for(ot=this,s.innerHTML=Ct().render(n.join("")),ot=null,e=this.firstChild;r=s.firstChild;)if(1===r.nodeType){"OL"===r.tagName||"UL"===r.tagName?r=Mt(r):"P"===r.tagName&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName&&r.firstChild===r.lastChild&&d(r,"image-container");var o=document.createElement("div");o.className="pa-dl pa-dlr";var u=document.createElement("div");u.className="pa-da";var h=document.createElement("div");h.className="pa-db";var c=r.getAttribute("data-landmark");if(c){for(var p=parseInt(c),f=c.indexOf("-"),g=f>=0?parseInt(c.substring(f+1)):p;e&&!((l(e,"pa-gi")||l(e,"pa-gc"))&&+e.firstChild.nextSibling.getAttribute("data-landmark")>=p);)e=e.nextSibling;h.setAttribute("data-landmark",p);for(var m=0,v=e;v;){if(l(v,"pa-gi")||l(v,"pa-gc")){if(+v.firstChild.nextSibling.getAttribute("data-landmark")>=g)break;m|=l(v,"pa-gi")?1:2}v=v.nextSibling}o.className+=2===m?" pa-gc":" pa-gi"}var b=document.createElement("div");for(b.className="pa-dr",r===s.firstChild&&s.removeChild(r),b.appendChild(r);s.firstChild&&1!==s.firstChild.nodeType;)b.appendChild(s.removeChild(s.firstChild));o.appendChild(u),o.appendChild(h),o.appendChild(b),this.insertBefore(o,e)}else s.removeChild(r);d(this,"pa-markdown")}}function Tt(){for(var t=this.firstChild;t;){var e=t.nextSibling;l(t,"pa-dlr")?this.removeChild(t):(l(t,"pa-gi")||l(t,"pa-gc"))&&u(t,"hidden"),t=e}u(this,"pa-markdown")}function Nt(){var t,e=this.getAttribute("data-pa-file");if((t=this.getAttribute("data-language"))||(/\.(?:cc|cpp|hh|hpp|c\+\+|h\+\+|C|H)$/.test(e)?t="c++":/\.(?:c|h)$/.test(e)&&(t="c"),t&&this.setAttribute("data-language",t)),t&&hljs.getLanguage(t)&&!l(this,"pa-highlight")&&!l(this,"pa-markdown")){for(var n,a,i=this.firstChild,r=[],s=1;i;){if(l(i,"pa-gi")||l(i,"pa-gc")){for(n=+i.firstChild.nextSibling.getAttribute("data-landmark");s<n;)r.push("\n"),++s;r.push(i.lastChild.textContent),l(i.lastChild,"pa-dnonl")||r.push("\n"),++s}i=i.nextSibling}try{a=hljs.highlight(t,r.join(""),!0).value.split("\n")}catch(t){return}i=this.firstChild;for(var o=[],u="language-"+t;i;){if(l(i,"pa-gi")||l(i,"pa-gc")){n=+i.firstChild.nextSibling.getAttribute("data-landmark");var h=i.lastChild;h.setAttribute("data-pa-text",h.textContent),h.innerHTML=yt(a[n-1],o),d(h,u)}i=i.nextSibling}d(this,"pa-highlight")}}function jt(t,e,n){!e&&t instanceof Error?t={error:(e=t).toString()}:"string"==typeof t&&(t={error:t}),e&&e.fileName&&!t.url&&(t.url=e.fileName),e&&e.lineNumber&&!t.lineno&&(t.lineno=e.lineNumber),e&&e.columnNumber&&!t.colno&&(t.colno=e.columnNumber),e&&e.stack&&(t.stack=e.stack),$.ajax(j("api/jserror"),{global:!1,method:"POST",cache:!1,data:t}),e&&!n&&"object"==typeof console&&console.error&&console.error(t.error)}ct.erase=function(){var t=this===ct?window.global_tooltip:$(this).data("tooltipState");t&&t.erase()},ct.add_builder=function(t,e){lt[t]=e},$((function(){$(".need-tooltip").each(ct)})),f.on("js-repo-copy",(function(){var t=document.createTextNode(this.getAttribute("data-pa-repo")),e=it(t,{color:"tooltip",dir:"t"});e.near(this);var n=document.createRange();n.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n);try{document.execCommand("copy")}catch(t){}window.getSelection().removeAllRanges(),e.remove(),window.global_tooltip&&window.global_tooltip.elt==this&&window.global_tooltip.text(this.getAttribute("data-pa-repo"))})),f.on("js-repo-list",(function(t){var e=this;$.ajax(N("api",{fn:"repositories",u:this.getAttribute("data-pa-user")}),{method:"POST",cache:!1,success:function(t){var n="Error loading repositories";if(t.repositories&&t.repositories.length){n="Repositories: ";for(var a=0;a<t.repositories.length;++a){var i=t.repositories[a];a&&(n+=", "),n+='<a href="'+V(i.url)+'">'+V(i.name)+"</a>"}}else t.repositories&&(n="No repositories");$('<div style="font-size:medium;font-weight:normal"></div>').html(n).insertAfter(e)}}),t.preventDefault()})),f.on("js-pset-viewoptions",(function(){g(this.nextSibling,this.parentNode)})),f.on("js-pset-setgrader",(function(){var t=$(this.closest("form"));$.ajax(t[0].getAttribute("action"),{data:t.serializeWith({}),type:"POST",cache:!1,dataType:"json",success:function(e){var n;t.find(".ajaxsave61").html(e.ok?"Saved":"<span class='error'>Error: "+e.error+"</span>"),e.ok&&(n=t.find("a.actas")).length&&n.attr("href",n.attr("href").replace(/actas=[^&;]+/,"actas="+encodeURIComponent(e.grader_email)))},error:function(){t.find(".ajaxsave61").html("<span class='error'>Failed</span>")}})})),f.on("js-pset-setcommit",(function(){this.closest("form").submit()})),f.on("js-pset-flag",(function(){var t=$(this),e=t.closest("form");"flag"!=this.name||e.find("[name=flagreason]").length?"flag"==this.name?$.ajax(e.attr("action"),{data:e.serializeWith({flag:1}),type:"POST",cache:!1,dataType:"json",success:function(n){n&&n.ok&&(e.find(".flagreason").remove(),t.replaceWith("<strong>Flagged</strong>"))},error:function(){e.find(".ajaxsave61").html("<span class='error'>Failed</span>")}}):"resolveflag"==this.name&&$.ajax(e.attr("action"),{data:e.serializeWith({resolveflag:1,flagid:t.attr("data-flagid")}),type:"POST",cache:!1,dataType:"json",success:function(e){e&&e.ok&&t.replaceWith("<strong>Resolved</strong>")},error:function(){e.find(".ajaxsave61").html("<span class='error'>Failed</span>")}}):(t.before('<span class="flagreason">Why do you want to flag this commit? &nbsp;<input type="text" name="flagreason" value="" placeholder="Optional reason" /> &nbsp;</span>'),e.find("[name=flagreason]").on("keypress",(function(e){w(e)||"Enter"!==y(e)||(e.preventDefault(),e.stopImmediatePropagation(),t.click())})).autogrow()[0].focus(),t.html("OK"))})),rt="pushState"in window.history?function(t){var e;return history.state||(e={href:location.href},$(document).trigger("collectState",[e]),history.replaceState(e,document.title,e.href)),t&&(e={href:t},$(document).trigger("collectState",[e]),history.pushState(e,document.title,e.href)),!0}:function(){return!1},f.on("pa-diff-unfold",(function(t){return t.metaKey?$(".pa-diff-unfold").each((function(){g(pt(this),this,!1)})):ft(pt(this)).then((t=>g(t,this))),!1})),f.on("pa-diff-toggle-hide-left",(function(t){var e=pt(this),n=l(e,"pa-hide-left");t.metaKey?$(".pa-diff-toggle-hide-left").each((function(){h(pt(this),"pa-hide-left",!n),h(this,"btn-primary",n)})):(h(e,"pa-hide-left",!n),h(this,"btn-primary",n))})),f.on("pa-goto",(function(){$(".pa-line-highlight").removeClass("pa-line-highlight"),gt(this,null).then((t=>{$(t).closest(".pa-filediff").removeClass("hidden");let e=$(t).closest(".pa-dl");e.addClass("pa-line-highlight"),window.scrollTo(0,Math.max(e.geometry().top-Math.max(.1*window.innerHeight,24),0)),rt(this.href)}),null)})),f.on("pa-diff-toggle-markdown",(function(t){var e=pt(this),n=!l(e,"pa-markdown");t.metaKey?$(".pa-diff-toggle-markdown").each((function(){var t=pt(this),e=l(t,"pa-markdown");n&&!e?St.call(t):!n&&e&&Tt.call(t),h(this,"btn-primary",n)})):((n?St:Tt).call(e),h(this,"btn-primary",n))})),$((function(){$(".pa-filediff.need-highlight:not(.need-load)").each(Nt)})),f.on("pa-gx",(function(t){for(var e=t.currentTarget,n=xt(e,!1);n&&!n.bline;)n=xt(n.tr,!1);var a=xt(e,!0);if(n||a){var i=n?n.aline+1:1,r=n?n.bline+1:1,s=a?a.bline:0;if(!(a&&a.aline<=1)){var o={file:(n||a).file,fromline:r};return s&&(o.linecount=s-r),$.ajax(N("api/blob",E(this,o)),{success:function(t){if(t.ok&&t.data){for(var n=t.data.replace(/\n$/,"").split("\n"),a=n.length-1;a>=0;--a){$('<div class="pa-dl pa-gc"><div class="pa-da" data-landmark="'+(i+a)+'"></div><div class="pa-db" data-landmark="'+(r+a)+'"></div><div class="pa-dd"></div></div>').insertAfter(e).find(".pa-dd").text(n[a])}$(e).remove()}}}),!0}}}));let Et=window.onerror,Lt=0;window.onerror=function(t,e,n,a,i){if((e||!n)&&t.indexOf("ResizeObserver loop limit exceeded")<0&&++Lt<=10){var r={error:t,url:e,lineno:n};a&&(r.colno=a),jt(r,i,!0)}return!!Et&&Et.apply(this,arguments)},$(document).ajaxError((function(t,e,n,a){if(4==e.readyState){var i;if(e.responseText&&"{"===e.responseText.charAt(0))try{i=JSON.parse(e.responseText)}catch(t){}if(!i||!i.user_error){var r=L(n.url)+" API failure: ";siteinfo.user&&siteinfo.user.email&&(r+="user "+siteinfo.user.email+", "),r+=e.status,a&&(r+=", "+a),e.responseText&&(r+=", "+e.responseText.substring(0,100)),jt(r)}}}));let Ot=0;const It={0:{format:0,render:Dt}};function Dt(t){return V(t).replace(/((?:https?|ftp):\/\/(?:[^\s<>\"&]|&amp;)*[^\s<>\"().,:;&])([\"().,:;]*)(?=[\s<>&]|$)/g,(function(t,e,n){return'<a href="'+e+'" rel="noreferrer">'+e+"</a>"+n}))}function Pt(t){var e,n;return t&&((e=It[t])||"string"==typeof t&&(n=t.indexOf("."))>0&&(e=It[t.substring(0,n)]))?e:(null==t&&(t=Ot),It[t]||It[0])}function Rt(t,e,n){var a=Pt(t);if(a.format)try{var i=e&&a.render_inline||a.render;return{format:a.formatClass||a.format,content:i.apply(this,n)}}catch(t){jt("do_render format "+a.format+": "+t.toString(),t)}return{format:0,content:Dt(n[0])}}function Ft(t,e){var n,a=[e];for(n=2;n<arguments.length;++n)a.push(arguments[n]);return Rt.call(this,t,!1,a)}function Wt(t,e){var n,a=[e];for(n=2;n<arguments.length;++n)a.push(arguments[n]);return Rt.call(this,t,!0,a)}function Ht(){var t,e,n=$(this),a=this.getAttribute("data-format"),i=this.getAttribute("data-content")||n.text(),r=null;if((e=a.indexOf("."))>0){var s=a.split(/\./);for(a=s[0],r={},e=1;e<s.length;++e)r[s[e]]=!0}(t="DIV"==this.tagName?Ft.call(this,a,i,r):Wt.call(this,a,i,r)).format&&n.html(t.content);var o=$.trim(this.className.replace(/(?:^| )(?:need-format|format\d+)(?= |$)/g," "));this.className=o+(o?" format":"format")+(t.format||0),t.format&&n.trigger("renderText",t)}function Bt(t,e){if(e&&hljs.getLanguage(e))try{return hljs.highlight(e,t,!0).value}catch(t){}return""}let Ut,zt,qt,Jt,Kt,Vt;$.extend(Ft,{add_format:function(t){t.format&&(It[t.format]=t)},format:function(t){return Pt(t)},set_default_format:function(t){Ot=t},inline:Wt,on:Ht,on_page:function(){$(".need-format").each(Ht)}}),Ft.add_format({format:1,render:function(t){return Ut||(Ut=window.markdownit({highlight:Bt}).use(markdownit_katex)),Ut.render(t)}}),$(Ft.on_page);class Xt{constructor(){this.iscomment=!1,this.text=""}empty(){return""===this.text}store_at(t){if(""===this.text&&null==this.version)t.removeAttribute("data-pa-note");else if(""===this.text&&null==this.users)t.setAttribute("data-pa-note",""+this.version);else{const e=[this.iscomment,this.text];null==this.users&&null==this.version&&null==this.format||e.push(this.users,this.version,this.format),t.setAttribute("data-pa-note",JSON.stringify(e))}}static parse(t){const e=new Xt;return"string"==typeof t&&""!==t&&(t=JSON.parse(t)),"number"==typeof t?e.version=t:Array.isArray(t)&&(e.iscomment=t[0],e.text=t[1],e.users=t[2]||null,e.version=t[3]&&"number"==typeof t[3]?t[3]:null,e.format=t[4]&&"number"==typeof t[4]?t[4]:null),e}static at(t){const e=Xt.parse(t.getAttribute("data-pa-note"));return e.element=t,e}static html_skeleton_near(t){if(l(t,"pa-gw"))return t;let e=t.closest(".pa-dl");for(;e&&(e.nodeType!==Node.ELEMENT_NODE||!e.offsetParent||!l(e,"pa-gi")&&!l(e,"pa-gc")&&!l(e,"pa-gd"));)e=e.previousSibling;if(!e)throw new Error("bad html_skeleton_near");const n=vt(e),a="a"===n.charAt(0),i=+n.substring(1);let r=null;for(e=e.nextSibling;e;){if(e.nodeType===Node.ELEMENT_NODE){if(l(e,"pa-gx"))break;if(l(e,"pa-gi")||l(e,"pa-gc")){if(a||i<+e.firstChild.nextSibling.getAttribute("data-landmark"))break;r=null}else if(l(e,"pa-gd")){if(a&&i<+e.firstChild.getAttribute("data-landmark")){r=e;break}r=r||e}}e=e.nextSibling}const s=$('<div class="pa-dl pa-gw" data-landmark="'.concat(n,'"><div class="pa-notebox"></div></div>'))[0];return t.parentElement.insertBefore(s,r||e),s}html_near(t,e){var n=Xt.html_skeleton_near(t),a=$(n);this.store_at(n);var i=a.find(".pa-notebox"),r=i.children();if(e?r.slideUp(80).queue((function(){r.remove()})):r.remove(),""===this.text)return Yt(n),e?a.children().slideUp(80):d(n,"hidden"),n;let s='<div class="pa-notecontent clearfix">';if(this.users){const t=$.isArray(this.users)?this.users:[this.users],e=[];for(let n in t){const a=siteinfo.pc[t[n]];a&&(a.nick?e.push(a.nick):a.nicklen||a.lastpos?e.push(a.name.substr(0,a.nicklen||a.lastpos-1)):e.push(a.name))}e.length&&(s+='<div class="pa-note-author">['+e.join(", ")+"]</div>")}if(s+='<div class="pa-note pa-'+(this.iscomment?"comment":"grade")+"note",this.format&&(s+='" data-format="'+this.format),s+='"></div></div>',i.append(s),this.format){const t=Ft(this.format,this.text);i.find(".pa-note").addClass("format"+(t.format||0)).html(t.content)}else i.find(".pa-note").addClass("format0").text(this.text);return Yt(n),e?i.find(".pa-notecontent").hide().slideDown(80):u(n,"hidden"),n}load_fileid(){const t=this.element,e=t.closest(".pa-filediff");this._file=e.getAttribute("data-pa-file"),t.hasAttribute("data-landmark")?this._lineid=t.getAttribute("data-landmark"):this._lineid=vt(bt(t,!1,1))}get file(){return!this._file&&this.element&&this.load_fileid(),this._file}get lineid(){return!this._lineid&&this.element&&this.load_fileid(),this._lineid}}function Gt(t,e){let n=$(t).find(".pa-note-links a");n.length||(n=$('<a class="ui pa-goto"></a>'),$('<div class="pa-note-links"></div>').append(n).prependTo($(t).find(".pa-notecontent"))),n.attr("href",function(t){let e,n=xt(t);return n&&(e=mt(n.ufile,n.lineid))?"#"+e.id:""}(e));const a=e?"NEXT >":"TOP";n.text()!==a&&n.text(a)}function Yt(t){const e=$(".pa-gw");let n=0;for(;n<e.length&&e[n]!==t;)++n;if(n<e.length){let a=n-1;for(;a>=0&&Xt.at(e[a]).empty();)--a;let i=n+1;for(;i<e.length&&Xt.at(e[i]).empty();)++i;a>=0&&Gt(e[a],Xt.at(t).empty()?e[i]:t),Gt(this,e[i])}}function Qt(t,e,n){t.removeClass("hidden").addClass("editing"),e&&e.store_at(t[0]);var a=t.find(".pa-notebox");if(n){t.css("display","").children().css("display","");var i=a.children();i.slideUp(80).queue((function(){i.remove()}))}var r=$(zt.tr).closest(".pa-psetinfo"),s=e?e.format:null;null==s&&(s=t.closest(".pa-filediff").attr("data-default-format"));var o='<form method="post" action="'+V(j("api/linenote",E(r[0],{file:zt.file,line:zt.lineid,oldversion:e&&e.version||0,format:s})))+'" enctype="multipart/form-data" accept-charset="UTF-8" class="ui-submit pa-noteform"><textarea class="pa-note-entry" name="note"></textarea><div class="aab aabr pa-note-aa"><div class="aabut"><button class="btn-primary" type="submit">Save comment</button></div><div class="aabut"><button type="button" name="cancel">Cancel</button></div>';r[0].hasAttribute("data-pa-user-can-view-grades")||(o+='<div class="aabut"><label><input type="checkbox" name="iscomment" value="1">Show immediately</label></div>');var l=$(o+"</div></form>").appendTo(a),d=l.find("textarea");e&&null!==e.text&&(d.text(e.text),d[0].setSelectionRange&&d[0].setSelectionRange(e.text.length,e.text.length)),d.autogrow().keydown(oe),l.find("input[name=iscomment]").prop("checked",!(!e||!e.iscomment)),l.find("button[name=cancel]").click(se),l.on("submit",(function(){re.call(this.closest(".pa-dl"))})),n&&(d.focus(),l.hide().slideDown(100))}function Zt(){var t;if(zt&&(t=mt(zt.ufile,zt.lineid))){for(t=t.closest(".pa-dl");t&&!t.offsetParent;)t=t.previousSibling;return t}return null}function te(t){t&&null!=t.pageX&&(Vt=t.timeStamp,Jt=t.screenX,Kt=t.screenY)}function ee(t){var e,n;if(!("mousemove"===t.type&&Vt&&(Math.abs(t.screenX-Jt)<=1&&Math.abs(t.screenY-Kt)<=1||t.timeStamp-Vt<=200)||("keydown"===t.type||"keyup"===t.type)&&y.modifier(t))){if("keydown"!==t.type||"ArrowUp"!==(e=y(t))&&"ArrowDown"!==e&&"Enter"!==e||(n=w(t))&&(n!==w.META||"Enter"!==e)||!zt)return ae();var a=Zt();if(!a)return ae();if("ArrowDown"!==e&&"ArrowUp"!==e||(u(a,"live"),a=bt(a,"ArrowDown"===e,0))){if(zt=xt(a),t.preventDefault(),te(t),"Enter"===e)de();else{var i=a.closest(".pa-with-fixed");$(a).addClass("live").scrollIntoView(i?{marginTop:i.firstChild.offsetHeight}:null)}return!0}}}function ne(t,e){d(t,"live"),$(".pa-filediff").removeClass("live"),$(document).off(".pa-linenote"),$(document).on((e?"keydown.pa-linenote ":"")+"mousemove.pa-linenote mousedown.pa-linenote",ee)}function ae(){$(".pa-dl.live").removeClass("live"),$(".pa-filediff").addClass("live"),$(document).off(".pa-linenote")}function ie(t,e){t=t.closest(".pa-dl");var n=Xt.at(t),a=t?$(t).find("textarea"):null;if(!t||!e&&a.length&&!o(n.text,a.val().replace(/\s+$/,"")))return!1;u(t,"editing"),$(t).find(":focus").blur(),n.html_near(t,!0);var i=Zt();return i&&ne(i,!0),!0}function re(t){if(!l(this,"pa-gw"))throw new Error("!");if(l(this,"pa-outstanding"))return!1;d(this,"pa-outstanding");var e,n=this,a=Xt.at(this),i=l(this,"editing"),r=this.closest(".pa-filediff"),s=r.closest(".pa-psetinfo"),o=this.closest(".pa-grade-range-block");if(i){let t=$(this).find("form")[0];e={note:t.note.value},t.iscomment&&t.iscomment.checked&&(e.iscomment=1),$(t).find(".pa-save-message").remove(),$(t).find(".aab").append('<div class="aabut pa-save-message">Saving…</div>')}else"function"==typeof t&&(t=t(a.text,a)),e={note:t};return e.format=a.format,null==e.format&&(e.format=r.getAttribute("data-default-format")),o&&o.setAttribute("data-pa-notes-outstanding",+o.getAttribute("data-pa-notes-outstanding")+1),new Promise((function(t,r){W(j("api/linenote",E(s,{file:a.file,line:a.lineid,oldversion:a.version||0})),e).then((function(e){if(u(n,"pa-outstanding"),e&&e.ok){u(n,"pa-save-failed");const r=e.linenotes[a.file],s=Xt.parse(r&&r[a.lineid]);s.store_at(n),i?($(n).find(".pa-save-message").html("Saved"),ie(n)):s.html_near(n),t(n)}else d(n,"pa-save-failed"),i&&$(n).find(".pa-save-message").html('<strong class="err">'+V(e.error||"Failed")+"</strong>"),r(n);o&&function(t){var e=+t.getAttribute("data-pa-notes-outstanding")-1;e?t.setAttribute("data-pa-notes-outstanding",e):(t.removeAttribute("data-pa-notes-outstanding"),$(t).find(".pa-grade").each((function(){pa_compute_landmark_range_grade.call(this,null,!0)})))}(o)}))}))}function se(){return ie(this,!0),!0}function oe(t){return!("Escape"===y(t)&&!w(t)&&ie(this))&&("Enter"!==y(t)||w(t)!==w.META||($(this).closest("form").submit(),!1))}function le(t,e){return t*t+e*e<144}function de(t){var e=$(zt.notetr||Xt.html_skeleton_near(zt.tr));if(te(t),e.hasClass("editing")){if(ie(e[0]))return t&&t.stopPropagation(),!0;var n=e.find("textarea").focus();return n[0].setSelectionRange&&n[0].setSelectionRange(0,n.val().length),!1}return Qt(e,Xt.at(e[0]),!0),ne(zt.tr,!1),!1}f.on("pa-editablenotes",(function(t){var e=t.target.closest(".pa-dl");if(0===t.button&&e&&!e.matches(".pa-gn, .pa-gx")){var n=xt(t.target),a=(new Date).getTime();"mousedown"===t.type&&n?zt&&zt.tr===n.tr&&qt&&le(qt[0]-t.clientX,qt[1]-t.clientY)&&a-qt[2]<=500||(zt=n,qt=[t.clientX,t.clientY,a,!1]):"mouseup"===t.type&&n?zt&&zt.tr===n.tr&&qt&&le(qt[0]-t.clientX,qt[1]-t.clientY)&&!qt[3]&&(zt=n,qt[3]=!0,de(t)):"click"===t.type&&n?(zt=n,de(t)):zt=qt=null}}));const ue={0:!1,1:{b:!0},2:{f:!0},3:{i:!0},4:{u:!0},5:{bl:!0},7:{rv:!0},8:{x:!0},9:{s:!0},21:{du:!0},22:{b:!1,f:!1},23:{i:!1},24:{u:!1},25:{bl:!1},27:{rv:!1},28:{x:!1},29:{s:!1},30:{fg:0},31:{fg:1},32:{fg:2},33:{fg:3},34:{fg:4},35:{fg:5},36:{fg:6},37:{fg:7},38:"fg",39:{fg:!1},40:{bg:0},41:{bg:1},42:{bg:2},43:{bg:3},44:{bg:4},45:{bg:5},46:{bg:6},47:{bg:7},48:"bg",49:{bg:!1},90:{fg:8},91:{fg:9},92:{fg:10},93:{fg:11},94:{fg:12},95:{fg:13},96:{fg:14},97:{fg:15},100:{bg:8},101:{bg:9},102:{bg:10},103:{bg:11},104:{bg:12},105:{bg:13},106:{bg:14},107:{bg:15}},he={b:1,f:2,i:3,u:4,bl:5,rv:7,x:8,s:9,du:21};function ce(t,e){var n;if(1===arguments.length&&(e=t,t=null),!e||"[m"===e||"[0m"===e)return null;n=""===e.charAt(0)?e.substring(2,e.length-1).split(";"):e.split(";");for(var a=0;a<n.length;++a){var i=ue[parseInt(n[a])];if(!1===i)t=null;else if(i){if("object"==typeof i)for(var r in i)!1!==i[r]?(t=t||{})[r]=i[r]:t&&delete t[r];else if("fg"===i||"bg"===i){var s,o,l;if(t=t||{},a+4<n.length&&2===parseInt(n[a+1]))s=parseInt(n[a+2]),o=parseInt(n[a+3]),l=parseInt(n[a+4]),s<=255&&o<=255&&l<=255&&(t[i]=[s,o,l]);else if(a+2<n.length&&5===parseInt(n[a+1])){var d=parseInt(n[a+1]);d<=15?t[i]=d:d<=231?(s=(d-16-(l=(d-16)%6)-6*(o=(d-16-l)/6%6))/36,t[i]=[51*s,51*o,51*l]):d<=255&&(l=Math.round(255*(d-232)/23),t[i]=[l,l,l])}}}else;}return t&&$.isEmptyObject(t)?null:t}function pe(t){return $(".pa-filediff").filter((function(){return this.getAttribute("data-pa-file")===t}))}function fe(t,n,a){var i=!1;if("string"==typeof t&&(a=n,n=t,t=document.createElement("div"),i=!0),a&&a.clear)for(t.removeAttribute("data-pa-terminal-style"),t.removeAttribute("data-pa-outputpart");t.firstChild;)t.removeChild(t.firstChild);var r,s,o=t.getAttribute("data-pa-terminal-style"),d=null;function u(t,n){t.appendChild(function(t,n){if("string"==typeof t?t=document.createTextNode(t):t instanceof jQuery&&(t=t[0]),!n||"[m"===n||"string"==typeof n&&!(n=ce(n)))return t;var a=document.createElement("span"),i=[];for(var r in he)n[r]&&i.push("ansi"+r);return n.fg&&("number"==typeof n.fg?i.push("ansifg"+n.fg):a.styles.foregroundColor=e("#%02x%02x%02x",n.fg[0],n.fg[1],n.fg[2])),n.bg&&("number"==typeof n.bg?i.push("ansibg"+n.bg):a.styles.backgroundColor=e("#%02x%02x%02x",n.bg[0],n.bg[1],n.bg[2])),i.length&&(a.className=i.join(" ")),a.appendChild(t),a}(n,o))}function h(t){d||(d=document.createDocumentFragment()),d.appendChild(t)}function c(t,e){return/^\x1b\[[\d;]*m$/.test(e)?function(t){if(!t)return"[m";var e=[];for(var n in he)t[n]&&e.push(he[n]);return t.fg&&("number"==typeof t.fg?e.push(t.fg<8?30+t.fg:90+t.fg-8):e.push(38,2,t.fg[0],t.fg[1],t.fg[2])),t.bg&&("number"==typeof t.bg?e.push(t.bg<8?40+t.bg:100+t.bg-8):e.push(48,2,t.bg[0],t.bg[1],t.bg[2])),"["+e.join(";")+"m"}(ce(ce(null,t),e)):t}function p(t,e){return""!==t&&t.charAt(t.length-1)===e}function f(t,e){var n,i,r=!e,s=0;for(r&&(e=document.createElement("span")),/\r/.test(t)&&(t=function(t){var e=/\n$/.test(t);if(e&&t.indexOf("\r")===t.length-1)return t.substring(0,t.length-2)+"\n";var n=o||"[m",a=(e?t.substr(0,t.length-1):t).split(/\r/),i=[];for(let t=0;t<a.length;++t){for(var r=[],s=0,l=null,d=a[t].split(/(\x1b\[[\d;]*m|\x1b\[0?K)/),u=0;u<d.length;u+=2)""!==d[u]&&(r.push(n,d[u]),s+=d[u].length),u+1<d.length&&(p(d[u+1],"K")?l=s:n=c(n,d[u+1]));for(var h=0;h<i.length&&s>=i[h+1].length;)s-=i[h+1].length,h+=2;for(;h<i.length&&s<i[h+1].length&&null===l;)r.push(i[h],i[h+1].substr(s)),s=0,h+=2;i=r}return i.push(n),e&&i.push("\n"),i.join("")}(t));n=t.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=c(o,n[1]),t=n[2];for(((n=t.match(/^([ \t]*)([^:\s]+):(\d+)(?=:)/))||(n=t.match(/^([ \t]*)file \"(.*?)\", line (\d+)/i)))&&function(t,e,n,i,r){for(var s;s=n.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=c(o,s[1]),n=s[2];var l=pe(n);if(!l.length&&a&&a.directory&&(l=pe(n=a.directory+n)),l.length){e.length&&u(t,e);var d="Lb"+i+"_"+X(n),h=$('<a href="#'+d+'" class="uu uic pa-goto"></a>');return h.text(r.substring(e.length).replace(/(?:\x1b\[[\d;]*m|\x1b\[\d*K)/g,"")),u(t,h),!0}return!1}(e,n[1],n[2],n[3],n[0])&&(s=n[0].length,t=t.substr(s));""!==t;){if(i=t,n=t.match(/^(.*?)(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/)){if(""===n[1]){o=c(o,n[2]),t=n[3];continue}i=n[1]}s+i.length>133||s+i.length==133&&"\n"!==i.charAt(132)?(u(e,i=i.substr(0,132-s)),e.className="pa-rl-continues",r&&h(e),e=document.createElement("span"),r=!0,s=0):(u(e,i),s+=i.length),t=t.substr(i.length)}r&&h(e)}"string"==typeof n?((r=n.split(/^/m)).length&&""===r[r.length-1]&&r.pop(),s=r.length&&p(r[r.length-1],"\n")):(r=[],s=!0,d=n);var g=t.lastChild,m=null;if(g&&g.lastChild&&l(g.lastChild,"pa-runcursor")&&(m=g.lastChild,g.removeChild(m)),g&&null!==(n=g.getAttribute("data-pa-outputpart"))&&""!==n&&r.length){for(;g.firstChild;)g.removeChild(g.firstChild);r[0]=n+r[0],g.removeAttribute("data-pa-outputpart")}else g&&(r.length||d)&&(g.appendChild(document.createTextNode("\n")),g.removeAttribute("data-pa-outputpart")),g=null;var v,b,x,y=o;for(v=0;v<r.length;v=b){for(y=o,x=r[v],b=v+1;!p(x,"\n")&&b<r.length;++b)x+=r[b];b==r.length&&s&&(x=x.substring(0,x.length-1)),f(x,v?null:g)}a&&a.cursor&&!t.lastChild&&!d&&h(""),d&&t.appendChild(d);var w=t.childNodes.length;if(w>=4e3){for(v=t.firstChild;"DIV"===v.tagName&&"pa-rl-group"===v.className;)v=v.nextSibling,--w;for(var _=null,A=0;v&&(b=v.nextSibling);)(!_||A>=4e3&&w>=2e3)&&((_=document.createElement("div")).className="pa-rl-group",t.insertBefore(_,v),A=0),t.removeChild(v),_.appendChild(v),v=b,++A,--w}if(a&&a.cursor&&(m||((m=document.createElement("span")).className="pa-runcursor"),t.lastChild.appendChild(m)),!s&&t.lastChild&&(o=y,t.lastChild.setAttribute("data-pa-outputpart",x)),null!=o?t.setAttribute("data-pa-terminal-style",o):t.removeAttribute("data-pa-terminal-style"),i)return t.innerHTML}function ge(){var t=this.closest(".pa-psetinfo");W(N("api/grade",E(t)),null,"GET").then((function(e){e&&e.ok&&$(t).data("pa-gradeinfo",e).each($pa.loadgrades)}))}function me(n,a){var i,s,o,h,c,p,f=$(n).closest("form"),m=n.getAttribute("data-pa-run-category")||n.value,v=$(n).closest(".pa-psetinfo").attr("data-pa-directory"),b=document.getElementById("pa-run-"+m),x=$(b).find("pre");if("object"!=typeof a&&(a={}),a.unfold&&b.dataset.paTimestamp)s=+b.dataset.paTimestamp;else{if(f.prop("outstanding"))return!0;f.find("button").prop("disabled",!0),f.prop("outstanding",!0)}function _(){i||!l(b,"pa-run-short")&&!b.hasAttribute("data-pa-runbottom")||requestAnimationFrame((function(){b.scrollHeight>b.clientHeight&&u(b,"pa-run-short"),b.hasAttribute("data-pa-runbottom")&&(b.scrollTop=Math.max(b.scrollHeight-b.clientHeight,0))}))}delete b.dataset.paTimestamp,g(b,jQuery("#pa-runout-"+m).removeClass("hidden"),!0),s||a.noclear?b.lastChild&&$(b.lastChild).find("span.pa-runcursor").remove():(x.html(""),d(x[0].parentElement,"pa-run-short"),x[0].removeAttribute("data-pa-terminal-style"),$(b).children(".pa-runrange").remove()),b.dataset.paXtermJs&&"false"!==b.dataset.paXtermJs&&window.Terminal&&(u(x[0].parentElement,"pa-run-short"),d(x[0].parentElement,"pa-run-xterm-js"),(i=new Terminal({cols:(o=80,h=132,c=$('<span style="position:absolute">0</span>').appendTo(x),p=Math.trunc(x.width()/c.width()/1.33),c.remove(),Math.max(o,Math.min(p,h))),rows:25})).open(x[0]),i.attachCustomKeyEventHandler((function(t){if("keydown"===t.type){var e=y(t),n=w(t);"Enter"!==e||n?"Escape"!==e||n?"Backspace"!==e||n?e>="a"&&e<="z"&&(14&n)===w.CTRL?e=String.fromCharCode(e.charCodeAt(0)-96):1===e.length&&0==(14&n)&&y.printable(t)||(e=""):e="\b":e="":e="\r",""!==e&&P({write:e})}return!1}))),b.hasAttribute("data-pa-opened")||(b.setAttribute("data-pa-opened","true"),i||(b.setAttribute("data-pa-runbottom","true"),b.addEventListener("scroll",(function(){requestAnimationFrame((function(){b.scrollTop+b.clientHeight>=b.scrollHeight-10?b.setAttribute("data-pa-runbottom","true"):b.removeAttribute("data-pa-runbottom")}))})),_()));var A="",k=-1,C=50,M=null,S=null;function T(){i?i.write("[?25l"):b.lastChild&&$(b.lastChild).find(".pa-runcursor").remove()}function N(){f.find("button").prop("disabled",!1),f.prop("outstanding",!1),T(),n.hasAttribute("data-pa-run-grade")&&ge.call(n.closest(".pa-psetinfo"))}function j(t){i?i.write(t):fe(x[0],t,{cursor:!0,directory:v})}function E(t){"string"==typeof t&&(t=$(t)[0]),i?window.console&&console.log("xterm.js cannot render "+t):fe(x[0],t,{cursor:!0})}function L(t,e){if(null!==A){var n=(A+=t).indexOf("\n\n");if(n<0)return;t=A.substr(n+2),A=null;var s="";e&&e.timestamp&&(s="...started "+r("%l:%M:%S%P %e %b %Y",new Date(1e3*e.timestamp))),i?(""!==s&&(s="[3;1;38;5;86m"+s+"[m\r\n"),a.noclear||(s="c"+s),t=s+t):(a.noclear||x.html(""),""!==s&&E('<span class="pa-runtime">'+s+"</span>"))}""!==t&&j(t)}function O(n,a){var i,r,s,o,h,c,p,f,g,v;function x(){i&&(i.value=p,r.innerHTML=e("%d:%02d.%03d",Math.trunc(p/6e4),Math.trunc(p/1e3)%60,Math.trunc(p)%1e3))}function y(t){if(null===t){if(!g)return;t=((new Date).getTime()-c)*v}var e=h;if((e>=S.length||t<S[e])&&(e=0),e+2<S.length&&t>=S[e])for(var a=S.length;e<a;){var i=e+(a-e>>1&-2);t<=S[i]?a=i:e=i+2}for(;e<S.length&&t>=S[e];)e+=2;p=t,e<h&&(A="",h=0);var r=n.data;L(r.substring(h<S.length?S[h+1]:r.length,e<S.length?S[e+1]:r.length),n),_(),x(),h=e,f&&(f=clearTimeout(f)),g&&(h<S.length?f=setTimeout(y,Math.min(100,(S[h]-(h?S[h-2]:0))/v),null):(s&&d(s,"paused"),T()))}S||("string"==typeof(S=n.time_data)&&(S=function(t){for(var e=[0,0],n=0;n<t.length;){var a=t.indexOf(",",n);if(a<0)break;var i=t.indexOf("\n",a+1);i<0&&(i=t.length),e.push(+t.substring(n,a),+t.substring(a+1,i)),n=i+1}return e}(S)),v=n.time_factor,S.length>2&&(i=$('<div class="pa-runrange"><button type="button" class="pa-runrange-play"></button><input type="range" class="pa-runrange-range" min="0" max="'+S[S.length-2]+'"><span class="pa-runrange-time"></span><span class="pa-runrange-speed-slow" title="Slow">🐢</span><input type="range" class="pa-runrange-speed" min="0.1" max="10" step="0.1"><span class="pa-runrange-speed-fast" title="Fast">🐇</span></div>').prependTo(b),r=i[0].lastChild,s=i[0].firstChild,i=s.nextSibling,o=(r=i.nextSibling).nextSibling.nextSibling,i.addEventListener("input",(function(){g=!1,d(s,"paused"),y(+this.value)}),!1),s.addEventListener("click",(function(){l(s,"paused")?(u(s,"paused"),g=!0,c=(new Date).getTime(),p<S[S.length-2]&&(c-=p/v),y(null)):(d(s,"paused"),g=!1)}),!1),o.addEventListener("input",(function(){v=+this.value,t.site(!1,"pa-runspeed-"+m,[v,(new Date).getTime()]),g&&(c=(new Date).getTime()-p/v,y(null))}),!1)),(h=t.site_json(!1,"pa-runspeed-"+m))&&h[1]>=(new Date).getTime()-864e5&&(v=h[0]),(v<.1||v>10)&&(v=1),o&&(o.value=v),n={data:n.data,timestamp:n.timestamp},a?(h=S.length,p=S[h-2],g=!1,s&&d(s,"paused"),x()):(h=0,p=0,c=(new Date).getTime(),g=!0,S.length&&y(null)))}function I(t){var e,n;if(M&&x.find("span.pa-runqueue").remove(),t&&t.onqueue)return M=t.queueid,n="On queue, "+t.nahead+(1==t.nahead?" job":" jobs")+" ahead",t.headage&&(n+=", oldest began about "+(e=t.headage<10?t.headage:5*Math.round(t.headage/5+.5))+(1==e?" second":" seconds")+" ago"),x[0].insertBefore($("<span class='pa-runqueue'>"+n+"</span>")[0],x[0].lastChild),void setTimeout(P,1e4);if(t&&"working"==t.status?$("#pa-runstop-"+m).length||$('<button id="pa-runstop-'+m+'" class="btn btn-danger pa-runstop" type="button">Stop</button>').click(R).appendTo("#pa-runout-"+m+" > h3"):$("#pa-runstop-"+m).remove(),!t||!t.ok)return e="Unknown error",t&&t.loggedout?e="You have been logged out (perhaps due to inactivity). Please reload this page.":t&&(t.error_text?e=t.error_text:t.error&&!0!==t.error?e=t.error:t.message&&(e=t.message)),j("[1;3;31m"+e+"[m\r\n"),_(),N();if(s=s||t.timestamp,t.data&&t.offset<k&&(t.data=t.data.substring(k-t.offset)),t.data){if(k=t.lastoffset,t.done&&null!=t.time_data&&""===A)return void O(t);L(t.data,t),C=100}t.result&&(null!==A&&L("\n\n",t),L(t.result,t)),t.data||t.result||(C=Math.min(2*C,500)),_(),"old"==t.status?setTimeout(P,2e3):t.done?(N(),t.timed&&!l(b.firstChild,"pa-runrange")&&P({offset:0},D)):setTimeout(P,C)}function D(t){t.data&&t.done&&null!=t.time_data&&O(t,!0)}function P(t,e){var n={};f[0].run||(n.run=m),n.offset=k,s&&(n.check=s),M&&(n.queueid=M),t&&$.extend(n,t),jQuery.ajax(f.attr("action"),{data:f.serializeWith(n),type:"POST",cache:!1,dataType:"json",success:e||I,timeout:3e4,error:function(){f.find(".ajaxsave61").html("Failed"),f.prop("outstanding",!1)}})}function R(){P({stop:1})}return a.headline&&a.noclear&&!i&&x[0].firstChild&&j("\n\n"),a.headline&&a.headline instanceof Node?E(a.headline):a.headline&&j("[1;37m"+a.headline+"[m\n"),a.unfold&&b.getAttribute("data-pa-content")&&j(b.getAttribute("data-pa-content")),b.removeAttribute("data-pa-content"),_(),P(),!1}function ve(t,e){for(var n=$("#pa-runsettings"),a=n.find(".n").length;n.find("[data-runsetting-num="+a+"]").length;)++a;var i=$('<div class="pa-p" data-runsetting-num="'+a+'"><div class="pa-pt"></div><div class="pa-pd"><input name="n'+a+'" class="uich pa-runconfig ignore-diff n" size="30" placeholder="Name"> &nbsp; <input name="v'+a+'" class="uich pa-runconfig ignore-diff v" size="40" placeholder="Value"></div></div>');t&&(i.find(".n").val(t),i.find(".v").val(e)),n.append(i),t||i.find(".n").focus()}function be(t){var e,n,a=0,i=this.getTotalLength();if(a!=i){for(;i-a>.5;)if(e=a+(i-a)/2,(n=this.getPointAtLength(e)).x>=t+.25)i=e;else{if(n.x>=t-.25)return n.y;a=e}if((n=this.getPointAtLength(i===e?a:i)).x>=t-.25&&n.x<=t+.25)return n.y}return null}Ft.add_format({format:2,render:function(t){return fe(t)}}),f.on("pa-runner",(function(){me(this)})),f.on("pa-run-show",(function(){var t=this.closest(".pa-runout").id.substring(10),e=document.getElementById("pa-run-"+t);e.dataset.paTimestamp&&!$(e).is(":visible")?me(jQuery(".pa-runner[value='"+t+"']")[0],{unfold:!0}):g(e,jQuery("#pa-runout-"+t))})),f.on("pa-runconfig",(function(){"define"===this.name?ve():function(){var t,e,n,a=$("#pa-runsettings .pa-p"),i={};for(t=0;t!=a.length;++t)e=$.trim($(a[t]).find(".n").val()),n=$.trim($(a[t]).find(".v").val()),""!=e&&(i[e]=n);$.ajax(a.closest("form").attr("action"),{data:{runsettings:i},type:"POST",cache:!1,dataType:"json"})}()}));const xe={m:2,M:2,z:0,Z:0,l:2,L:2,h:1,H:1,v:1,V:1,c:6,C:6,s:4,S:4,q:4,Q:4,t:2,T:2,a:7,A:7,b:1,B:1};let ye={},we=0,_e=!1;function Ae(t){if(t instanceof SVGPathElement&&(t=t.getAttribute("d")),ye[t])return ye[t];for(var e,n,a,i,r,s,o=[],l=0,d=0,u=0,h=0,c=!1,p=0,f=0,g=1,m=function(t){t instanceof SVGPathElement&&(t=t.getAttribute("d")),t=t.split(/([a-zA-Z]|[-+]?(?:\d+\.?\d*|\.\d+)(?:[Ee][-+]?\d+)?)/);var e,n=1,a=t.length;return function(){for(var i,r=null;n<a;){if((i=t[n])>="A"){if(r)break;r=[i],e=i,"m"!==i&&"M"!==i&&"z"!==i&&"Z"!==i||(e="m"===i||"z"===i?"l":"L")}else{if(!r&&e)r=[e];else if(!r||r.length===xe[r[0]]+1)break;r.push(+i)}n+=2}return r}}(t);i=m();)if("b"!==(r=i[0])&&"B"!==r)if("z"!==r&&"Z"!==r){if(1==xe[r]&&(1==i.length?i=["L"]:"h"===r?i=["l",i[1],0]:"H"===r?i=["L",i[1],d]:"v"===r?i=["l",0,i[1]]:"V"===r&&(i=["L",l,i[1]])),(r=i[0])>="a"&&!p)for(e="a"!==r?1:6;e<i.length;e+=2)i[e]+=l,i[e+1]+=d;else if(r>="a")for("a"===r&&(i[3]+=p),e="a"!==r?1:6;e<i.length;e+=2)n=i[e],a=i[e+1],i[e]=l+n*g+a*f,i[e+1]=d+n*f+a*g;for(r=i[0]=r.toUpperCase();i.length<xe[r]+1;)i.push(u,h);"S"===r?(n=a=0,s&&"C"===s[0]&&(n=l-s[3],a=d-s[4]),i=["C",l+n,d+a,i[1],i[2],i[3],i[4]],r="C"):"T"===r&&(n=a=0,s&&"Q"===s[0]&&(n=l-s[1],a=d-s[2]),i=["Q",l+n,d+a,i[1],i[2]],r="Q"),c||"M"===r||(0!==o.length&&"Z"!==o[o.length-1][0]&&o.push(["M"]),c=!0),"M"===r?(u=i[1],h=i[2],c=!1):"L"===r?o.push(["L",l,d,i[1],i[2]]):"C"===r?o.push(["C",l,d,i[1],i[2],i[3],i[4],i[5],i[6]]):"Q"===r?o.push(["C",l,d,l+2*(i[1]-l)/3,d+2*(i[2]-d)/3,i[3]+2*(i[1]-i[3])/3,i[4]+2*(i[2]-i[4])/3,i[3],i[4]]):(1==++_e&&jt("bad normalize "+r),o.push(i)),s=i,l=i[i.length-2],d=i[i.length-1]}else s=o.length?o[o.length-1]:null,c&&(l==u&&d==h||o.push(["L",l,d,u,h]),o.push(["Z"]),c=!1),l=u,d=h;else p="b"===r?p+i[1]:i[1],g=Math.cos(p),f=Math.sin(p);return we>=1e3&&(ye={},we=0),ye[t]=o,++we,o}function $e(t,e,n){if(n&&!function(t,e,n){function a(t,a,i,r){return t-e[0]>=n||e[0]-i>=n||a-e[1]>=n||e[1]-r>=n}if("clientX"in e){var i=t.getBoundingClientRect(),r=e[0]-e.clientX,s=e[1]-e.clientY;if(i&&a(i.left+r,i.top+s,i.right+r,i.bottom+s))return!1}for(var o,l,d,u,h=Ae(t),c=0;c!==h.length;++c){var p=h[c];if("L"===p[0])o=Math.min(p[1],p[3]),l=Math.min(p[2],p[4]),d=Math.max(p[1],p[3]),u=Math.max(p[2],p[4]);else{if("C"!==p[0]){if("Z"===p[0]||"M"===p[0])continue;return!0}o=Math.min(p[1],p[3],p[5],p[7]),l=Math.min(p[2],p[4],p[6],p[8]),d=Math.max(p[1],p[3],p[5],p[7]),u=Math.max(p[2],p[4],p[6],p[8])}if(!a(o,l,d,u))return!0}return!1}(t,e,n.distance))return n;var a,i,r,s,o=t.getTotalLength(),l=((s=t)instanceof SVGPathElement&&(s=s.getAttribute("d")),ye[s]?ye[s].length:s.replace(/[^A-DF-Za-df-z]+/g,"").length),d=Math.max(o/l/8,4),u=n?(n.distance+.01)*(n.distance+.01):1/0;function h(n){var r=t.getPointAtLength(n),s=e[0]-r.x,o=e[1]-r.y,l=s*s+o*o;return l<u&&(a=[r.x,r.y],i=n,u=l),r}if(l>20){var c,p,f=function(t,e){var n=Ae(t);function a(t,n,a,i){var r=e[0]<t?t-e[0]:e[0]>a?e[0]-a:0,s=e[1]<n?n-e[1]:e[1]>i?e[1]-i:0;return Math.max(r,s)}var i,r,s=1/0,o=-1/0,l=24;for(i=0;i!==n.length;++i)"L"===(r=n[i])[0]?(s=Math.min(s,r[1],r[3]),o=Math.max(o,r[1],r[3])):"C"===r[0]&&(s=Math.min(s,r[1],r[3],r[5],r[7]),o=Math.max(o,r[1],r[3],r[5],r[7]));s-=l,o+=l;var d,u,h,c,p,f=Math.max(Math.ceil((o-s)/l),1),g=new Array(f+1);for(g.fill(1/0),i=0;i!==n.length;++i){if("L"===(r=n[i])[0])d=Math.min(r[1],r[3]),u=Math.min(r[2],r[4]),h=Math.max(r[1],r[3]),c=Math.max(r[2],r[4]);else{if("C"!==r[0])continue;d=Math.min(r[1],r[3],r[5],r[7]),u=Math.min(r[2],r[4],r[6],r[8]),h=Math.max(r[1],r[3],r[5],r[7]),c=Math.max(r[2],r[4],r[6],r[8])}for(p=a(d,u,h,c),d=Math.floor((d-s)/l),h=Math.ceil((h-s)/l);d<=h;)g[d]=Math.min(g[d],p),++d}for(i=0;i!==g.length;++i)g[i]<1/0&&(g[i]=g[i]*g[i]);return g.xmin=s,g.xmax=o,g.width=l,g.point=e,g}(t,e),g=f.xmin,m=f.width;for(r=0;r<o;)c=h(r),f[p=Math.floor((c.x-g)/m)]>u&&f[p-1]>u&&f[p+1]>u?r+=m:r+=d}else for(r=0;r<o;r+=d)h(r);h(o);do{(r=i-d/2)>0&&h(r),(r+=d)<o&&h(r),d/=2}while(d>.5);return a&&(a.distance=Math.sqrt(u),a.pathNode=t,a.pathLength=i),a&&(!n||a.distance<=n.distance+.01)?a:n}class ke{constructor(){this.is=[]}lower(t){for(var e=this.is,n=0,a=e.length;n<a;){var i=n+2*(a-n>>2);if(e[i]>t)a=i;else{if(!(t>e[i+1]))return i;n=i+2}}return n}contains(t){var e=this.lower(t);return e<this.is.length&&t>=this.is[e]}overlaps(t,e){var n=this.lower(t);return n<this.is.length&&e>=this.is[n]}add(t,e){var n=this.is,a=this.lower(t);(a>=n.length||t<n[a])&&n.splice(a,0,t,t);for(var i=a;i+2<n.length&&e>=n[i+2];)i+=2;i!==a&&n.splice(a+1,i-a),n[a+1]=Math.max(n[a+1],e)}clear(){this.is=[]}}function Ce(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}class Me{constructor(t,e,n){const a=$(t),i=n.indexOf("noextra")>=0?e.series.noextra:e.series.all,r=i.min();let s=r<0?r-1:0;e.entry&&"letter"===e.entry.type&&(s=Math.min(65,r<0?r:Math.max(r-5,0))),this.min=s,this.max=i.max(),e.maxtotal&&(this.max=Math.max(this.max,e.maxtotal)),this.min==this.max&&(s=this.min=this.min-1,this.max+=1),this.total=e.maxtotal,this.cutoff=e.cutoff,this.svg=Ce("svg"),this.gg=Ce("g"),this.gx=Ce("g"),this.gy=Ce("g"),this.xl=this.xt=!0,this.yl=this.yt="pdf"!==n.substring(0,3),this.tw=a.width(),this.th=a.height(),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.setAttribute("width",this.tw),this.svg.setAttribute("height",this.th),this.svg.setAttribute("overflow","visible"),this.svg.appendChild(this.gg),this.gx.setAttribute("class","pa-gg-axis pa-gg-xaxis"),this.svg.appendChild(this.gx),this.gy.setAttribute("class","pa-gg-axis pa-gg-yaxis"),this.svg.appendChild(this.gy),this.maxp=0,this.hoveranno=null,this.hoveron=!1,a.html(this.svg);const o=Ce("text");o.appendChild(document.createTextNode("888")),this.gx.appendChild(o);var l=o.getBBox();if(this.xdw=l.width/3,this.xdh=l.height,this.gx.removeChild(o),this.xlw=this.xdw*(this.max>0?Math.floor(Math.log10(this.max))+1:1),this.mt=Math.ceil(Math.max(this.yl?this.xdh/2:0,2)),this.mr=Math.ceil(this.xl?this.xlw/2:0),this.mb=(this.xt?5:0)+(this.xl?this.xdh+3:0),this.yl){const t=this.th-this.mt-Math.max(this.mb,Math.ceil(this.xdh/2));if(t>this.xdh){var d=a.hasClass("pa-grgraph-min-yaxis");this.yfmt=d?"%.0r%%":"%.0r";const e=t/this.xdh;this.ymax=100,this.ylu=e>15?10:e>5?25:e>3?50:100,this.ml=5+(this.yt?5:0)+(d?4.2:3)*this.xdw,a.hasClass("pa-grgraph-min-yaxis")||(this.yltext=Ce("text"),this.yltext.appendChild(document.createTextNode("% of grades")),this.gy.appendChild(this.yltext),(l=this.yltext.getBBox()).width<=.875*t?this.ml+=.5*this.xdw+this.xdh:(this.gy.removeText(this.yltext),this.yltext=null)),this.mb=Math.max(this.mb,Math.ceil(this.xdh/2))}else this.yl=!1,this.ml=0,this.mt=2}else this.ml=this.yt?5:0;this.xl&&(this.ml=Math.max(this.ml,Math.ceil(this.xdw/2))),this.gw=this.tw-this.ml-this.mr;var u=this.gh=this.th-this.mt-this.mb;const h=this.gw/Math.max(this.max-this.min,.001);if(this.xax=function(t){return(t-s)*h},this.yax=function(t){return u-t*u},this.unxax=function(t){return t/h+s},this.unyax=function(t){return-(t-u)/u},e.entry&&e.entry.type){const t=window.pa_grade_types[e.entry.type];t&&t.tics&&(this.xtics=t.tics.call(t))}this.max-this.min>900?this.xfmt="%.0r":this.max-this.min>10?this.xfmt="%.1r":this.xfmt="%.3r",this.gg.setAttribute("transform","translate("+this.ml+","+this.mt+")"),this.gx.setAttribute("transform","translate("+this.ml+","+(this.mt+this.gh+(this.xt?2:-5))+")"),this.gy.setAttribute("transform","translate("+(this.ml+(this.yt?-2:5))+","+this.mt+")")}numeric_xaxis(){const t=Math.floor(Math.log10(this.max))+1,e=this.xdw*(t+.5),n=this.gw/e,a=Math.pow(10,Math.max(0,t-2)),i=(this.max-this.min)/a;let r;r=n>4*i&&a>1?a/2:n>2*i?a:n>i*(a<=1?.75:1)?2*a:a>1&&n>.6*i?2.5*a:n>.3*i?5*a:10*a;const s=[];let o=Math.floor(this.min/r)*r,l=!1;for(;o<this.max+r;){let t=o,n=this.xl;if(this.total&&(t>this.total&&t-r<this.total&&!l&&(t=this.total,o-=r),t==this.total&&(l=!0)),o+=r,t<this.min)continue;t>this.max&&(t=this.max);const a=this.xax(t);if(s.push("M",a,",0v5"),(this.total&&t!=this.total&&Math.abs(a-this.xax(this.total))<e||t!=this.max&&t!=this.total&&Math.abs(a-this.xax(this.max))<e)&&(n=!1),n){const e=Ce("text");e.appendChild(document.createTextNode(t)),e.setAttribute("x",a),e.setAttribute("y",this.xdh+3),this.gx.appendChild(e)}}if(this.xt){const t=Ce("path");t.setAttribute("d",s.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}xtics_xaxis(){let t=new ke,e=new ke,n=[];for(let a=0;a!==this.xtics.length;++a){let i=this.xtics[a];if(i.x<this.min||i.x>this.max)continue;let r=this.xax(i.x);if((i.notic||!e.contains(r))&&(i.notic||(n.push("M",r,",0v5"),e.add(r-3,r+3)),this.xl&&i.text)){let e=this.xdw*(i.label_space||i.text.length+.5)*.5;if(!t.overlaps(r-e,r+e)){const n=Ce("text");n.appendChild(document.createTextNode(i.text)),n.setAttribute("x",r),n.setAttribute("y",this.xdh+3),this.gx.appendChild(n),e=this.xdw*(i.text.length+.5)*.5,t.add(r-e,r+e)}}}if(this.xt){const t=Ce("path");t.setAttribute("d",n.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gx.appendChild(t)}}xaxis(){this.xtics?this.xtics_xaxis():this.numeric_xaxis()}yaxis(){const t=[];let n=0;for(;n<=this.ymax&&this.yl;){const a=Ce("text");a.appendChild(document.createTextNode(e(this.yfmt,n))),a.setAttribute("x",-8),a.setAttribute("y",this.yax(n/this.ymax)+.25*this.xdh),this.gy.appendChild(a),t.push("M-5,",this.yax(n/this.ymax),"h5"),n+=this.ylu}if(this.yt){const e=Ce("path");e.setAttribute("d",t.join("")),e.setAttribute("fill","none"),e.setAttribute("stroke","black"),this.gy.appendChild(e)}this.yltext&&(this.yltext.setAttribute("transform","translate("+(-this.ml+this.xdh)+","+this.yax(.5)+") rotate(-90)"),this.yltext.setAttribute("text-anchor","middle"))}container(){return this.svg.closest(".pa-grgraph")}append_cdf(t,e){const n=t.cdf,a=[],i=1/t.n,r=this.cutoff||0,s=this.min;let o=0;if(r)for(;o<n.length&&n[o+1]<r*t.n;)o+=2;for(;o<n.length;o+=2){if(0!==a.length){const t=Math.max(s,n[o]-Math.min(1,n[o]-n[o-2])/2);a.push("H",this.xax(t))}else a.push("M",this.xax(Math.max(s,n[o]-.5)),",",this.yax(r));a.push("V",this.yax(n[o+1]*i))}0!==a.length&&a.push("H",this.xax(Math.max(this.max,n[n.length-2])));const l=Ce("path");return l.setAttribute("d",a.join("")),l.setAttribute("fill","none"),l.setAttribute("class",e),this.gg.appendChild(l),this.last_curve=l,this.last_curve_series=t,l}append_pdf(t,e){if(0===t.maxp)return null;const n=[],a=t.kde,i=.9/this.maxp,r=this.xax,s=this.yax,o=[0,0,0,0],l=[0,0,0,0],d=[0,0,0,0],u=[0,0,0,0],h=1e-6;function c(t){const e=(t+2)%4,a=(t+3)%4,i=(t+1)%4;let r=o[a],s=l[a],c=o[t],p=l[t];if(d[a]>h){let n=2*u[a]+3*d[a]*d[t]+u[t],i=3*d[a]*(d[a]+d[t]);r=(r*n-o[e]*u[t]+o[t]*u[a])/i,s=(s*n-l[e]*u[t]+l[t]*u[a])/i}if(d[i]>h){let e=2*u[i]+3*d[i]*d[t]+u[t],n=3*d[i]*(d[i]+d[t]);c=(c*e-o[i]*u[t]+o[a]*u[i])/n,p=(p*e-l[i]*u[t]+l[a]*u[i])/n}n.push("C",r,s,c,p,o[t],l[t])}for(let e=0;e!==a.length;++e){const h=r(this.min+e*t.binwidth),f=s(a[e]*i);if(0===e)n.push("M",h,f),o[3]=o[0]=h,l[3]=l[0]=f;else{const t=(e+3)%4,n=e%4;o[n]=h,l[n]=f;const i=o[t]-h,r=l[t]-f;if(u[n]=Math.sqrt(i*i+r*r),d[n]=Math.sqrt(u[n]),e>1&&c(t),e===a.length-1){var p=(e+1)%4;o[p]=h,l[p]=f,u[p]=0,d[p]=0,c(n)}}}const f=Ce("path");return f.setAttribute("d",n.join(" ")),f.setAttribute("fill","none"),f.setAttribute("class",e),this.gg.appendChild(f),this.last_curve=f,this.last_curve_series=t.series,f}remove_if(t){let e=this.gg.firstChild;for(;e;){const n=e.nextSibling;t.call(e)&&this.gg.removeChild(e),e=n}}highlight_last_curve(t,e,n){if(!this.last_curve||!this.last_curve_series.cdfu)return null;var a,i,r,s,o,u,h,c=l(this.last_curve,"pa-gg-pdf"),p=this.last_curve_series.cdf,f=this.last_curve_series.cdfu,g=[];for(i=(a=c?.9/(this.maxp*t.n):1/t.n)*this.gh,r=s=0;r!==p.length;r+=2){for(h=0;s!==p[r+1];++s)e(f[s],t)&&++h;h&&(o=this.xax(p[r]),null!=(u=c?be.call(this.last_curve,o):this.yax(p[r+1]*a))&&g.push("M",o,",",u,"v",h*i))}if(g.length){const t=Ce("path");return t.setAttribute("d",g.join("")),t.setAttribute("fill","none"),t.setAttribute("class",n),this.gg.appendChild(t),d(this.gg,"pa-gg-has-hl"),t}return null}typed_annotation(t){const e=Ce("circle");return e.setAttribute("class","pa-gg-mark hl-"+(t||"main")),e.setAttribute("r",t&&"main"!==t?3.5:5),e}star_annotation(t,e,n,a){null==e&&(e=Math.PI/2),null==n&&(n=5);var i=Ce("path");i.setAttribute("class",a);for(var r=["M"],s=Math.cos,o=Math.sin,l=Math.PI/n,d=0;d<2*n;++d)r.push(t[1&d]*s(e)," ",t[1&d]*o(e),d?" ":"L"),e+=l;return r.push("z"),i.setAttribute("d",r.join("")),i}annotate_last_curve(t,e,n){if(this.last_curve){var a=this.xax(t),i=be.call(this.last_curve,a);if(null===i&&this.cutoff&&(i=this.yax(this.cutoff)),null!==i)return(e=e||this.typed_annotation()).setAttribute("transform","translate("+a+","+i+")"),this.gg.insertBefore(e,n||null),!0}return!1}user_x(t){if(this.last_curve_series.cdfu){if(!this.last_curve_series.ucdf){var e,n,a=this.last_curve_series.cdf,i=this.last_curve_series.cdfu,r=this.last_curve_series.ucdf={};for(e=n=0;n!==i.length;++n){for(;n>=a[e+1];)e+=2;r[i[n]]=a[e]}}return this.last_curve_series.ucdf[t]}}highlight_users(){if(this.last_curve&&this.last_curve_series.cdfu){this.last_highlight=this.last_highlight||{};var t,e=this.container().attributes,n={};for(let t=0;t!==e.length;++t)if(e[t].name.startsWith("data-pa-highlight")){let a;a="data-pa-highlight"===e[t].name?"main":e[t].name.substring(18),n[a]=e[t].value,this.last_highlight[a]=this.last_highlight[a]||""}for(let e in this.last_highlight){var a=n[e]||"";if(this.last_highlight[e]!==a){var i={},r=a.split(/\s+/);for(let t=0;t!==r.length;++t)""!==r[t]&&(i[r[t]]=1);for(var s,o=this.gg.firstChild,d="pa-gg-mark hl-"+e;o&&(!l(o,"pa-gg-mark")||o.className.animVal<d);)o=o.nextSibling;for(;o&&o.className.animVal===d;){s=o.nextSibling;var u=+o.getAttribute("data-pa-uid");i[u]?i[u]=2:this.gg.removeChild(o),o=s}for(let n=0;n!==r.length;++n)if(1===i[r[n]]&&null!=(t=this.user_x(r[n]))){var h=this.typed_annotation(e);h.setAttribute("data-pa-uid",r[n]),this.annotate_last_curve(t,h,o)}this.last_highlight[e]=a}}}}hover(){const t=this;function n(t,e,n){let a=null;for(const i of t){const t=i.getAttribute("transform").match(/^translate\(([-+\d.]+),([-+\d.]+)\)$/);if(t){const r=+t[1]-e[0],s=+t[2]-e[1],o=r*r+s*s;o<n&&(a=[+t[1],+t[2]],a.pathNode=i,n=o)}}return a&&(a.distance=Math.sqrt(n)),a}function a(a){let i={distance:20},r=t.xfmt;if("mousemove"!==a.type&&(t.hoveron="mouseleave"!==a.type),t.hoveron){const e=function(t,e){var n,a=t.ownerSVGElement||t;if(a.createSVGPoint)(n=a.createSVGPoint()).x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());else{var i=t.getBoundingClientRect();n={x:e.clientX-i.left-t.clientLeft,y:e.clientY-i.top-t.clientTop}}var r=[n.x,n.y];return r.clientX=e.clientX,r.clientY=e.clientY,r}(t.svg,a),o=t.gg.querySelectorAll(".pa-gg-pdf, .pa-gg-cdf");for(var s of(e[0]-=t.ml,e[1]-=t.mt,o))i=$e(s,e,i);if(i.pathNode){const e=n(t.gg.querySelectorAll(".pa-gg-mark.hl-main"),i,36)||n(t.gg.querySelectorAll(".pa-gg-mark:not(.hl-main)"),i,25);e&&(i=e,"%.0r"!==r&&"%.1f"!==r||(r="%.2r"))}}let o=t.hoveranno;if(i.pathNode){if(!o){o=t.hoveranno=[t.star_annotation([4,10],null,null,"pa-gg-hover-mark")],t.gg.appendChild(o[0]);var l=Ce("path");l.setAttribute("d","M0,0v5"),l.setAttribute("fill","none"),l.setAttribute("stroke","black"),t.gx.appendChild(l),o.push(l),(l=Ce("rect")).setAttribute("class","pa-gg-hover-box"),l.setAttribute("y",5),l.setAttribute("height",t.xdh+1.5),l.setAttribute("rx",3),t.gx.appendChild(l),o.push(l),(l=Ce("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-hover-text"),l.setAttribute("y",t.xdh+3),t.gx.appendChild(l),o.push(l),(l=Ce("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-anno-name"),l.setAttribute("text-anchor","end"),l.setAttribute("dx",-8),t.gg.appendChild(l),o.push(l),t.yl&&((l=Ce("path")).setAttribute("d","M-5,0h5"),l.setAttribute("fill","none"),l.setAttribute("stroke","black"),t.gy.appendChild(l),o.push(l),(l=Ce("rect")).setAttribute("class","pa-gg-hover-box"),l.setAttribute("height",t.xdh+1),l.setAttribute("rx",3),t.gy.appendChild(l),o.push(l),(l=Ce("text")).appendChild(document.createTextNode("")),l.setAttribute("class","pa-gg-hover-text"),l.setAttribute("x",-8),t.gy.appendChild(l),o.push(l))}o[0].setAttribute("transform","translate("+i[0]+","+i[1]+")"),o[1].setAttribute("transform","translate("+i[0]+",0)"),o[3].setAttribute("x",i[0]),o[3].firstChild.data=e(r,t.unxax(i[0]));var d,u,h=o[3].getBBox();o[2].setAttribute("x",i[0]-h.width/2-2),o[2].setAttribute("width",h.width+4),i.pathNode.hasAttribute("data-pa-uid")&&(d=$(".gtable").data("paTable"))&&(u=d.name_text(i.pathNode.getAttribute("data-pa-uid")))?(o[4].firstChild.data=u,o[4].setAttribute("x",i[0]),o[4].setAttribute("y",i[1])):o[4].firstChild.data="",t.yl&&(o[5].setAttribute("transform","translate(0,"+i[1]+")"),o[7].setAttribute("y",i[1]+.25*t.xdh),o[7].firstChild.data=e(t.yfmt,t.unyax(i[1])*t.ymax),h=o[7].getBBox(),o[6].setAttribute("x",-h.width-10),o[6].setAttribute("y",i[1]-(t.xdh+2)/2),o[6].setAttribute("width",h.width+4))}else o&&(t.gg.removeChild(o[0]),t.gx.removeChild(o[1]),t.gx.removeChild(o[2]),t.gx.removeChild(o[3]),t.gg.removeChild(o[4]),t.yl&&(t.gy.removeChild(o[5]),t.gy.removeChild(o[6]),t.gy.removeChild(o[7])),t.hoveranno=null)}this.svg.addEventListener("mouseenter",a,!1),this.svg.addEventListener("mousemove",a,!1),this.svg.addEventListener("mouseleave",a,!1)}}class Se{constructor(t){this.n=t.n,this.cdf=t.cdf,this.cdfu=t.cdfu||null,this.mean=t.mean||null,this.median=t.median||null,this.stddev=t.stddev||null,this.cutoff=t.cutoff||null}min(){return this.cdf.length?this.cdf[0]:0}max(){return this.cdf.length?this.cdf[this.cdf.length-2]:0}count_at(t){const e=this.cdf;let n=0,a=e.length;for(;n<a;){const i=n+2*(a-n>>2);e[i]>=t?a=i:n=i+2}return e[n+1]}}class Te{constructor(t,e,n,a){const i=e.max,r=e.min,s=(i-r)*n,o=1/s;function l(t){return t>=-s&&t<=s?.75*o*(1-(t*=o)*t):0}const d=[];for(let t=0;t!==a+1;++t)d.push(0);const u=t.cdf,h=(i-r)/a,c=1/h;for(let t=0;t<u.length;t+=2){const e=u[t+1]-(0===t?0:u[t-1]);let n=Math.floor((u[t]-r-s)*c);const i=Math.ceil((u[t]-r+s)*c);for(;n<i;){const i=Math.max(-1,Math.min(a+1,n));i>=0&&i<=a&&(d[i]+=l(n*h-u[t]+r)*e),++n}}let p=0;if(t.n){const e=1/t.n;for(let t=0;t!==a+1;++t)d[t]*=e,p=Math.max(p,d[t])}this.series=t,this.kde=d,this.maxp=p,this.binwidth=h}}class Ne{constructor(t){this.pset=t.pset,this.psetid=t.psetid,this.maxtotal=t.maxtotal||null,this.entry=t.entry||null,this.series={};for(let e in t.series)this.series[e]=new Se(t.series[e])}}function je(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ee(){const e=this,n=$(e).data("paGradeData");if(!n)return d(e,"hidden"),void $(e).removeData("paGradeGraph").off("redrawgraph");const a=e.closest(".pa-psetinfo"),i=!a||a.hasAttribute("data-pa-user-extension"),r=[];n.series.extension&&a&&i&&r.push("cdf-extension","pdf-extension"),r.push("cdf","pdf"),n.series.extension&&!a&&r.push("cdf-extension","pdf-extension"),n.series.noextra&&r.push("cdf-noextra","pdf-noextra"),r.push("all"),e.setAttribute("data-pa-gg-types",r.join(" "));let s=e.getAttribute("data-pa-gg-type");if(s||(s=t(!0,"pa-gg-type")),!s){let e=t(!1,"pa-gg-type");if(e&&"{"===e[0])try{e=JSON.parse(e),"string"==typeof e.type&&"number"==typeof e.at&&e.at>=(new Date).getTime()-72e5&&(s=e.type)}catch(t){}}s&&"default"!==s||(s=r[0]),r.indexOf(s)<0&&(s="pdf"===s.substring(0,3)?r[1]:r[0]),e.setAttribute("data-pa-gg-type",s),$(e).removeClass("cdf pdf all cdf-extension pdf-extension all-extension cdf-noextra pdf-noextra all-noextra hidden").addClass(s);const o="all"===s.substring(0,3),l=s.indexOf("-extension")>=0||o&&i&&n.extension,h=s.indexOf("-noextra")>=0||o&&n.series.noextra&&!l;let c=$(e).find(".plot");c.length||(c=$(e));const p=new Me(c[0],n,s);if($(e).data("paGradeGraph",p),p.total&&p.total<p.max){let t=je("line");t.setAttribute("x1",p.xax(p.total)),t.setAttribute("y1",p.yax(0)),t.setAttribute("x2",p.xax(p.total)),t.setAttribute("y2",p.yax(1)),t.setAttribute("class","pa-gg-anno-total"),p.gg.appendChild(t)}const f=Math.ceil((p.max-p.min)/2),g=.08,m={};"pdf-extension"===s?m.extension=new Te(n.series.extension,p,g,f):"pdf-noextra"===s?m.noextra=new Te(n.series.noextra,p,g,f):"pdf"===s&&(m.main=new Te(n.series.all,p,g,f));for(let t in m)p.maxp=Math.max(p.maxp,m[t].maxp);if("pdf-noextra"===s?p.append_pdf(m.noextra,"pa-gg-pdf pa-gg-noextra"):"pdf"===s?p.append_pdf(m.main,"pa-gg-pdf"):"pdf-extension"===s?p.append_pdf(m.extension,"pa-gg-pdf pa-gg-extension"):("cdf-noextra"===s||"all"===s&&n.series.noextra)&&p.append_cdf(n.series.noextra,"pa-gg-cdf pa-gg-noextra"),"cdf"!==s&&"all"!==s||p.append_cdf(n.series.all,"pa-gg-cdf"),("cdf-extension"===s||"all"===s&&n.series.extension&&i)&&p.append_cdf(n.series.extension,"pa-gg-cdf pa-gg-extension"),n.cutoff&&"pdf"!==s.substring(0,3)){const t=je("rect");t.setAttribute("x",p.xax(0)),t.setAttribute("y",p.yax(n.cutoff)),t.setAttribute("width",p.xax(p.max)),t.setAttribute("height",p.yax(0)-p.yax(n.cutoff)),t.setAttribute("fill","rgba(255,0,0,0.1)"),p.gg.appendChild(t)}let v=null,b=$(a).data("pa-gradeinfo");b&&(v=b.get_total(h&&!o)),null!=v&&p.annotate_last_curve(v),p.xaxis(),p.yaxis(),e.hasAttribute("data-pa-highlight")&&p.highlight_users(),p.hover(),$(e).find(".statistics").each((function(){const t=p.last_curve_series,e=[];t&&t.mean&&e.push("mean "+t.mean.toFixed(1)),t&&t.median&&e.push("median "+t.median.toFixed(1)),t&&t.stddev&&e.push("stddev "+t.stddev.toFixed(1));const n=[e.join(", ")];if(t&&null!=v){const e=t.count_at(v);t.cutoff&&e<t.cutoff*t.n?n.push("≤"+Math.round(100*t.cutoff)+" %ile"):n.push(Math.round(Math.min(Math.max(1,100*e/t.n),99))+" %ile")}n.length?(u(this,"hidden"),this.innerHTML=n.join(" · ")):(d(this,"hidden"),this.innerHTML="")})),$(e).find(".pa-grgraph-type").each((function(){const t=[];s.startsWith("cdf")?t.push("CDF"):s.startsWith("pdf")&&t.push("PDF"),l&&!o&&t.push("extension"),h&&!o&&t.push("no extra credit");const e=t.length?" ("+t.join(", ")+")":"";this.innerHTML="grade statistics"+e})),p.highlight_users(),$(e).off("redrawgraph").on("redrawgraph",Ee)}function Le(t){t=t.replace(/^[^#]*/,"");let e,n=/([^#=\/]+)[=\/]?([^\/]*)/g,a={};for(;e=n.exec(t);)a[e[1]]=decodeURIComponent(e[2].replace(/\+/g," "));return a}function Oe(t){const e=Le(location.hash);for(let n in t)null===t[n]||void 0===t[n]?delete e[n]:e[n]=t[n];const n=function(t){const e=[];for(var n in t)null===t[n]||void 0===t[n]||""===t[n]?e.push(n):e.push(n+"="+encodeURIComponent(t[n]).replace(/%20/g,"+"));return e.sort(),e.length?"#"+e.join("/"):""}(e);n!==location.hash&&rt(location.origin+location.pathname+location.search+n)}function Ie(){return l(document.body,"want-grgraph-hash")}function De(t,e,n){const a="data-pa-highlight"+("main"===e?"":"-"+e);n=n||"",$(t).find(".pa-grgraph").each((function(){const t=this.getAttribute(a)||"",i=this;t===n||"main"!==e&&"course"===this.getAttribute("data-pa-pset")||(n?this.setAttribute(a,n):this.removeAttribute(a),window.requestAnimationFrame((function(){const t=$(i).data("paGradeGraph");t&&t.highlight_users()})))}))}function Pe(t,e){const n={},a={};let i,r=!1;for(let e of t.match(/[-\d.]+/g)||[])n[e]=!0;if($(".js-grgraph-highlight-course").each((function(){const t=this.getAttribute("data-pa-highlight-range")||"90-100",e=this.getAttribute("data-pa-highlight-type")||"h00";if(a[e]=a[e]||[],this.checked=!!n[t]){let n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-([-+]?(?:\d+\.?\d*|\.\d))(\.?)$/);if(n)a[e].push(+n[1],+n[2]+(n[3]?1e-5:0)),r=!0;else{if(!(n=t.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-$/)))throw new Error("bad range");a[e].push(+n[1],1/0),r=!0}}})),r)if(i=function(){let t=null;return $(".pa-grgraph[data-pa-pset=course]").each((function(){const e=$(this).data("paGradeData");if(e&&e.series.all&&e.series.all.cdfu)return t=e.series.all,!1})),t}())for(let t in a){const e=a[t],n=[];if(e.length){for(let t=0;t!==i.cdf.length;t+=2)for(let a=0;a!==e.length;a+=2)if(i.cdf[t]>=e[a]&&i.cdf[t]<e[a+1]){const e=t?i.cdf[t-1]:0;Array.prototype.push.apply(n,i.cdfu.slice(e,i.cdf[t+1]));break}n.sort()}De(document.body,t,n.join(" "))}else setTimeout((function(){Pe(Le(location.hash).hr||"",e+1)}),8<<Math.max(e,230));else for(let t in a)De(document.body,t,"")}function Re(t){const e=Le(t);De(document.body,"main",e.hs||""),$("input[type=checkbox].js-grgraph-highlight").prop("checked",!1);for(let t of(e.hs||"").match(/\d+/g)||[])$("tr[data-pa-uid="+t+"] input[type=checkbox].js-grgraph-highlight").prop("checked",!0);Pe(e.hr||"",0),$(".js-grgraph-highlight-course").prop("checked",!1);for(let t of(e.hr||"").match(/[-\d.]+/g)||[])$('.js-grgraph-highlight-course[data-pa-highlight-range="'+t+'"]').prop("checked",!0)}f.on("js-grgraph-flip",(function(){const e=this.closest(".pa-grgraph"),n=(e.getAttribute("data-pa-gg-types")||"").split(/ /),a=e.getAttribute("data-pa-gg-type");let i=n.indexOf(a);i>=0&&(i=(i+(l(this,"prev")?n.length-1:1))%n.length,e.setAttribute("data-pa-gg-type",n[i]),t(!0,"pa-gg-type",n[i]),t(!1,"pa-gg-type",{type:n[i],at:(new Date).getTime()}),Ee.call(e))})),f.on("js-grgraph-highlight",(function(t){if("change"!==t.type)return;const e=this.getAttribute("data-range-type"),n=[];$(this).closest("form").find("input[type=checkbox]").each((function(){let t;this.getAttribute("data-range-type")===e&&this.checked&&(t=this.closest("tr"))&&t.hasAttribute("data-pa-uid")&&n.push(+t.getAttribute("data-pa-uid"))})),n.sort((function(t,e){return t-e})),Ie()?(Oe({hs:n.length?n.join(" "):null}),De(document.body,"main",n.join(" "))):De(this.closest("form"),"main",n.join(" "))})),f.on("js-grgraph-highlight-course",(function(){const t=[];$(".js-grgraph-highlight-course").each((function(){this.checked&&t.push(this.getAttribute("data-pa-highlight-range"))})),Ie()&&Oe({hr:t.length?t.join(" "):null}),Pe(t.join(" "),0)})),Ie()&&($(window).on("popstate",(function(t){const e=(t.originalEvent||t).state;e&&e.href&&Re(e.href)})).on("hashchange",(function(){Re(location.href)})),$((function(){Re(location.href)})));let Fe={};const We={basic_text:t=>null==t?"":""+t,basic_entry:function(t,e){var n='<div class="pa-pd"><span class="pa-gradewidth"><input type="text" class="uich pa-gradevalue pa-gradewidth" name="'.concat(this.key,'" id="',t,'"></span> <span class="pa-gradedesc">');return e.max_text?n+=e.max_text:this.max&&(n+="of "+this.max),n+"</span></div>"},basic_reflect_value:function(t,e,n){const a=this.simple_text(e);$(t).val()===a||!n.reset&&$(t).is(":focus")||$(t).val(a)},add:(t,e)=>{e.type=t,e.text=e.text||We.basic_text,e.simple_text=e.simple_text||e.text,e.tcell=e.tcell||e.text,e.reflect_value=e.reflect_value||We.basic_reflect_value,Fe[t]=e},find:t=>Fe[t]||Fe.numeric};We.add("numeric",{entry:We.basic_entry}),We.add("formula",{text:function(t){return null==t?"":t.toFixed(1)}}),We.add("text",{entry:function(t){return'<div class="pa-pd"><textarea class="uich pa-pd pa-gradevalue need-autogrow" name="'.concat(this.key,'" id="',t,'"></textarea></div>')},justify:"left",sort:"forward"}),We.add("section",{text:()=>"",entry:()=>""});let He,Be=0;class Ue{constructor(t){Object.assign(this,t),this.type=this.type||"numeric",this.gc=We.find(this.type),this._abbr=null,this._all=null}abbr(){return this._abbr||this.compute_abbr(),this._abbr}compute_abbr(){const t=this._all?this._all.order:[this.key],e=this._all?this._all.entries:{[this.key]:this};let n={};for(let a=0;a!==t.length;++a){const i=t[a],r=e[i],s=r.title||i;let o=s.match(/^(p)(?:art\s*|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||s.match(/^(q)(?:uestion\s*|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i)||s.match(/^[\s:]*()(\S{1,3}[\d.]*)[^\s\d]*[\s:]*/);if(o){let t,e=o[1]+o[2],i=s.substring(o[0].length);for(;t=n[e];){if(!0!==t&&(o=t[1].match(/^(\S{1,3}[\d.]*)\S*[\s:]*(.*)$/))&&(t[0]._abbr+=o[1],n[t[0]._abbr]=[t[0],o[2]],n[e]=t=!0),!(o=i.match(/^(\S{1,3}[\d.]*)[^\s\d]*[\s:]*(.*)$/))){!0!==t&&(e+=":"+a);break}e+=o[1],i=o[2]}r._abbr=e,n[e]=[r,i]}else r._abbr=":"+a}}html_skeleton(t,e){const n=this.key,a=this.title?V(this.title):n;let i;if((t||this.student)&&this.gc.entry){let r={editable:t},s="pa-ge"+ ++Be;i=((e=!1!==e)?'<form class="ui-submit ':'<div class="')+"pa-grade pa-p","section"===this.type&&(i+=" pa-p-section"),!1===this.visible&&(i+=" pa-p-hidden"),i=i.concat('" data-pa-grade="',n),e||(i=i.concat('" data-pa-grade-type="',this.gc.type)),i=i.concat('"><label class="pa-pt" for="',s,'">',a,"</label>"),this.edit_description&&(i+='<div class="pa-pdesc">'+V(this.edit_description)+"</div>"),i+=this.gc.entry.call(this,s,r)+(e?"</form>":"</div>")}else i='<div class="pa-grade pa-p',"section"===this.type&&(i+=" pa-p-section"),i+='" data-pa-grade="'.concat(n,'"><div class="pa-pt">',a,"</div>"),"text"===this.type?i+='<div class="pa-pd pa-gradevalue"></div>':(i+='<div class="pa-pd"><span class="pa-gradevalue pa-gradewidth"></span>',this.max&&"letter"!==this.type&&(i+=' <span class="pa-gradedesc">of '+this.max+"</span>"),i+="</div>"),i+="</div>";return i}fill_dom(t,e,n){const a=$(t),i=a.find(".pa-gradevalue")[0];if(i&&"SPAN"!==i.tagName&&"DIV"!==i.tagName)this.fill_dom_editable(t,i,e,n||{});else{const n=this.text(e);$(i).text()!==n&&$(i).text(n),h(t,"hidden",""===n&&!this.max&&"section"!==this.type)}if(this.landmark&&t.parentElement&&l(t.parentElement,"want-pa-landmark-links")){var r=/^(.*):(\d+)$/.exec(this.landmark),s=$(mt(r[1],"a"+r[2])),o="";if(s.length){var d=$(this).closest(".pa-psetinfo")[0].getAttribute("data-pa-directory")||"";d&&r[1].substr(0,d.length)===d&&(r[1]=r[1].substr(d.length)),o='@<a href="#'+s[0].id+'" class="ui pa-goto">'+V(r[1]+":"+r[2])+"</a>"}var u=a.find(".pa-gradeboxref");s.length?u.length&&u.html()===o||(u.remove(),a.find(".pa-pd").first().append('<span class="pa-gradeboxref">'+o+"</span>")):u.remove()}}fill_dom_editable(t,e,n,a){const i=$(t);if(this.max&&(!n||n<=this.max?i.find(".pa-gradeabovemax").remove():i.find(".pa-gradeabovemax").length||i.find(".pa-pd").after('<div class="pa-pd pa-gradeabovemax">Grade is above max</div>')),null==a.autograde||n===a.autograde)i.find(".pa-gradediffers").remove();else{const t=("late_hours"===this.key?"auto-late hours":"autograde")+" is "+this.text(a.autograde);i.find(".pa-gradediffers").length||i.find(".pa-pd").first().append('<span class="pa-gradediffers"></span>');const e=i.find(".pa-gradediffers");e.text()!==t&&e.text(t)}this.gc.reflect_value.call(this,e,n,a),a.reset&&a.mixed?e.setAttribute("placeholder","Mixed"):e.hasAttribute("placeholder")&&e.removeAttribute("placeholder"),a.reset&&e.setAttribute("data-default-value",this.simple_text(n))}text(t){return this.gc.text.call(this,t)}simple_text(t){return this.gc.simple_text.call(this,t)}tcell(t){return this.gc.tcell.call(this,t)}static closest(t){const e=t.closest(".pa-grade");return ze.closest(e).entries[e.getAttribute("data-pa-grade")]}static late_hours(){return He=He||new Ue({key:"late_hours",title:"late hours"}),He}}class ze{constructor(t){if(Object.assign(this,t),this.entries)for(let t in this.entries)this.entries[t]=new Ue(this.entries[t]),this.entries[t]._all=this;this.elements=this.entries}fill_dom_at(t){const e=t.getAttribute("data-pa-grade"),n=this.entries[e];"late_hours"===e?Ue.late_hours().fill_dom(t,this.late_hours,{autograde:this.auto_late_hours}):n&&n.fill_dom(t,this.grades?this.grades[n.pos]:null,{autograde:this.autogrades?this.autogrades[n.pos]:null})}get_total(t){let e=0;for(let n=0;n<this.order.length;++n){const a=this.entries[this.order[n]];!a||!a.in_total||t&&this.is_extra||(e+=this.grades&&this.grades[n]||0)}return Math.round(1e3*e)/1e3}static parse_json(t){return new ze(JSON.parse(t))}static store(t,e){$(t).data("pa-gradeinfo",new ze(e)),window.$pa.loadgrades.call(t)}static closest(t){let e=t.closest(".pa-psetinfo"),n=null;for(;e;){var a=$(e).data("pa-gradeinfo");if("string"==typeof a&&(a=ze.parse_json(a),$(e).data("pa-gradeinfo",a)),n=n?$.extend(n,a):a,n&&n.entries)break;e=e.parentElement.closest(".pa-psetinfo")}return n}}We.add("checkbox",{text:function(t){return null==t||0===t?"–":t==(this.max||1)?"✓":""+t},simple_text:We.basic_text,tcell:function(t){return null==t||0===t?"":t==(this.max||1)?"✓":""+t},entry:function(t,e){var n='<div class="pa-pd"><span class="pa-gradewidth"><input type="checkbox" class="ui pa-gradevalue ml-0" name="'.concat(this.key,'" id="',t,'" value="',this.max,'"></span>');return e.editable&&(n=n.concat(' <span class="pa-gradedesc">of ',this.max,' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>')),n+"</div>"},justify:"center",reflect_value:function(t,e,n){const a=null==e||""===e||0===e||this&&e===this.max;a||"checkbox"!==t.type?a&&"checkbox"!==t.type&&n.reset&&qe.recheckbox(t):qe.uncheckbox(t),"checkbox"===t.type?(t.checked=!!e,t.indeterminate=n.mixed):t.value===e||!n.reset&&$(t).is(":focus")||(t.value=""+e)}});class qe{static uncheckbox(t){const e=Ue.closest(t);"checkbox"===t.type&&(t.value=t.checked?e.max:""),t.type="text",t.className=(l(t,"ui")||l(t,"uich")?"uich ":"")+"pa-gradevalue pa-gradewidth";const n=t.closest(".pa-pd");$(n).find(".pa-grade-uncheckbox").remove(),$(n).find('input[name^="'+t.name+':"]').addClass("hidden")}static recheckbox(t){const e=t.value.trim(),n=Ue.closest(t);t.type="checkbox",t.checked=""!==e&&"0"!==e,t.value=n.max,t.className=(l(t,"uich")?"ui ":"")+"pa-gradevalue",$(t.closest(".pa-pd")).find(".pa-gradedesc").append(' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a>')}}f.on("pa-grade-uncheckbox",(function(){$(this.closest(".pa-pd")).find(".pa-gradevalue").each((function(){qe.uncheckbox(this),this.focus(),this.select()}))}));const Je={98:"A+",95:"A",92:"A-",88:"B+",85:"B",82:"B-",78:"C+",75:"C",72:"C-",68:"D+",65:"D",62:"D-",50:"F"};function Ke(t){return{text:function(e){return null==e||0===e?"–":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},simple_text:We.basic_text,tcell:function(e){return null==e||0===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):""+e},entry:function(t,e){let n='<div class="pa-pd"><span class="pa-gradewidth"><input type="hidden" class="uich pa-gradevalue" name="'.concat(this.key,'">');for(let e=0;e<this.max;++e)n=n.concat('<input type="checkbox" class="ui js-multicheckbox-grade ml-0" name="',this.key,":",e,'" value="1"'),e===this.max-1&&(n+=' id="'+t+'"'),n+=">";return n+="</span>",e.editable&&(n=n.concat(' <span class="pa-gradedesc">of ',this.max,' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>')),n+"</div>"},justify:"left",reflect_value:function(t,e,n){const a=null==e||""===e||0===e||e>=0&&(!this||e<=this.max)&&Math.abs(e-Math.round(e))<.05;a||"hidden"!==t.type?a&&"hidden"!==t.type&&n.reset&&qe.recheckbox(t):qe.uncheckbox(t),t.value===e||!n.reset&&$(t).is(":focus")||(t.value=e);const i=t.name+":",r=Math.round(e||0);$(t.closest(".pa-pd")).find("input[type=checkbox]").each((function(){if(this.name.startsWith(i)){const t=+this.name.substring(i.length);this.checked=t<r,this.indeterminate=n.mixed}}))}}}function Ve(t){return document.getElementById(t)}function Xe(t,e){return"string"==typeof e&&(e=""===e?[]:[e]),0===e.length?"":(e=1===e.length?e[0]:"<p>"+e.join("</p><p>")+"</p>",0!==t&&1!==t&&2!==t||(t=["info","warning","error"][t]),'<div class="msg msg-'+t+'">'+e+"</div>")}function Ge(t){return"checkbox"===t.type||"radio"===t.type}function Ye(t){var e=function(t){return t.hasAttribute("data-default-value")?t.getAttribute("data-default-value"):Ge(t)?(t.hasAttribute("data-default-checked")?t.getAttribute("data-default-checked"):t.defaultChecked)?t.value:"":t.defaultValue}(t);return Ge(t)?t.checked?e!==t.value:""!==e:!o("SELECT"===t.tagName?$(t).val():t.value,e)}function Qe(){this.clear()}var Ze;function tn(t){var e=new Qe,n=null;function a(t){var e=n.find("form")[0],a=n.find(".popup-body"),i=Xe(2,t.error);for(var r in n.find(".msg-error").remove(),a.length?a.prepend(i):n.find("h2").after(i),t.errf||{}){var s=e[r];if(s){var o=$(s).closest(".entryi, .f-i");(o.length?o:$(s)).addClass("has-error")}}return n}function i(){ct.erase(),n.find("textarea, input").unautogrow(),n.trigger("closedialog"),n.remove(),u(document.body,"modal-open")}return t=t||{},e.push('<div class="modal" role="dialog"><div class="modal-dialog'+(t.anchor&&t.anchor!==window?"":" modal-dialog-centered")+(t.style?'" style="'+V(t.style):"")+'" role="document"><div class="modal-content"><form enctype="multipart/form-data" accept-charset="UTF-8"'+(t.form_class?' class="'+t.form_class+'"':"")+">","</form></div></div></div>"),e.push_actions=function(t){return e.push('<div class="popup-actions">',"</div>"),t&&e.push(t.join("")).pop(),e},e.show=function(r){if(!n){for(var s in(n=$(e.render()).appendTo(document.body)).find(".need-tooltip").each(ct),n.on("click",(function(t){t.target===n[0]&&i()})),n.find("button[name=cancel]").on("click",i),t.action&&(t.action instanceof HTMLFormElement?n.find("form").attr({action:t.action.action,method:t.action.method}):n.find("form").attr({action:t.action,method:t.method||"post"})),{minWidth:1,maxWidth:1,width:1})null!=t[s]&&n.children().css(s,t[s]);n.show_errors=a,n.close=i}return!1!==r&&(!function(t,e){ct.erase(),t.jquery&&(t=t[0]);for(;!l(t,"modal-dialog");)t=t.childNodes[0];var n,a=t.parentNode;if(d(a,"show"),d(document.body,"modal-open"),!l(t,"modal-dialog-centered")){var i=$(e).geometry(),r=$(window).geometry(),s=$(a).offset(),o=(i.top+i.bottom-t.offsetHeight)/2;o=Math.max(r.top+5,Math.min(r.bottom-5-t.offsetHeight,o))-s.top,t.style.top=o+"px";var u=(i.right+i.left-t.offsetWidth)/2;u=Math.max(r.left+5,Math.min(r.right-5-t.offsetWidth,u))-s.left,t.style.left=u+"px"}$(t).find("input, button, textarea, select").filter(":visible").each((function(){if(l(this,"want-focus"))return n=this,!1;n||l(this,"dangerous")||l(this,"no-focus")||(n=this)})),n&&function(t){if(t.jquery&&(t=t[0]),t.focus(),!t.hotcrp_ever_focused){if(t.select&&l(t,"want-select"))t.select();else if(t.setSelectionRange)try{t.setSelectionRange(t.value.length,t.value.length)}catch(t){}t.hotcrp_ever_focused=!0}}(n)}(n,t.anchor||window),n.find(".need-autogrow").autogrow(),n.find(".need-tooltip").each(ct)),n},e}We.add("letter",{text:t=>null==t?"":Je[t]||""+t,entry:function(t,e){return e.max_text="letter grade",We.basic_entry.call(this,t,e)},justify:"left",tics:()=>{const t=[];for(let e in Je)1===Je[e].length&&t.push({x:e,text:Je[e]});for(let e in Je)2===Je[e].length&&t.push({x:e,text:Je[e],label_space:5});for(let e in Je)2===Je[e].length&&t.push({x:e,text:Je[e].substring(1),label_space:2,notic:!0});return t}}),We.add("checkboxes",Ke("✓")),We.add("stars",Ke("⭐")),f.on("js-multicheckbox-grade",(function(){const t=this.name.indexOf(":"),e=this.name.substring(0,t),n=this.name.substring(t+1),a=this.closest("form").elements[e],i=this.checked?+n+1+"":n;a.value!==i&&(a.value=i,$(a).trigger("change"))})),We.add("select",{entry:function(t){let e='<div class="pa-pd"><span class="select"><select class="uich pa-gradevalue" name="'.concat(this.key,'" id="',t,'"><option value="">None</option>');for(let t=0;t!==this.options.length;++t){const n=V(this.options[t]);e=e.concat('<option value="',n,'">',n,"</option>")}return e+"</select></span></div>"},justify:"left",sort:"forward",reflect_value:function(t,e,n){const a=this.simple_text(e);$(t).val()===a||!n.reset&&$(t).is(":focus")||$(t).val(a),n.reset&&n.mixed?(""!==t.options[0].value&&$(t).prepend('<option value="">Mixed</option>'),t.selectedIndex=0):""!==a&&t.remove(0)}}),$.fn.extend({geometry:function(t){var e,n;if(this[0]==window)e={left:this.scrollLeft(),top:this.scrollTop()};else{if(1==this.length&&this[0].getBoundingClientRect)return e=$.extend({},this[0].getBoundingClientRect()),(n=window.pageXOffset)&&(e.left+=n,e.right+=n),(n=window.pageYOffset)&&(e.top+=n,e.bottom+=n),"width"in e||(e.width=e.right-e.left,e.height=e.bottom-e.top),e;e=this.offset()}return e&&(e.width=t?this.outerWidth():this.width(),e.height=t?this.outerHeight():this.height(),e.right=e.left+e.width,e.bottom=e.top+e.height),e},scrollIntoView:function(t){t=t||{};for(let e=0;e!==this.length;++e){let n=$(this[e]).geometry(),a=this[e].parentNode;for(;a&&a.tagName&&"visible"===$(a).css("overflow-y");)a=a.parentNode;a=a&&a.tagName?a:window;let i=$(a).geometry();if(n.top<i.top+(t.marginTop||0)||t.atTop){let e=Math.max(n.top-(t.marginTop||0),0);a===window?a.scrollTo(a.scrollX,e):a.scrollTop=e}else if(n.bottom>i.bottom-(t.marginBottom||0)){let e=Math.max(n.bottom+(t.marginBottom||0)-i.height,0);a===window?a.scrollTo(a.scrollX,e):a.scrollTop=e}}return this},serializeWith:function(t){var e=this.serialize();if(null!=e&&t){let n=e.length&&"&"!=e[e.length-1]?"&":"";for(let a in t)null!=t[a]&&(e+=n+encodeURIComponent(a)+"="+encodeURIComponent(t[a]),n="&")}return e}}),$((function(){$("form.need-unload-protection").each((function(){var t=this;u(t,"need-unload-protection"),$(t).on("submit",(function(){d(this,"submitting")})),$(window).on("beforeunload",(function(){if(l(t,"alert")&&!l(t,"submitting"))return"If you leave this page now, your edits may be lost."}))}))})),Qe.prototype.push=function(t,e){return t&&e?(this.open.push(this.html+t),this.close.push(e),this.html="",this.open.length-1):(this.html+=t,this)},Qe.prototype.pop=function(t){var e=this.open.length;for(null==t&&(t=Math.max(0,e-1));e>t;)--e,this.html=this.open[e]+this.html+this.close[e],this.open.pop(),this.close.pop();return this},Qe.prototype.pop_n=function(t){return this.pop(Math.max(0,this.open.length-t)),this},Qe.prototype.push_pop=function(t){return this.html+=t,this.pop()},Qe.prototype.pop_push=function(t,e){return this.pop(),this.push(t,e)},Qe.prototype.pop_collapse=function(t){for(null==t&&(t=this.open.length?this.open.length-1:0);this.open.length>t;)""!==this.html&&(this.html=this.open[this.open.length-1]+this.html+this.close[this.open.length-1]),this.open.pop(),this.close.pop();return this},Qe.prototype.render=function(){return this.pop(0),this.html},Qe.prototype.clear=function(){return this.open=[],this.close=[],this.html="",this},Qe.prototype.next_htctl_id=(Ze=1,function(){for(;document.getElementById("htctl"+Ze);)++Ze;return"htctl"+(++Ze-1)});var en=function(){var t,e=!1;function n(n,a){var i,s;n&&"string"==typeof n&&(n=Ve(n)),n&&e&&(i=new Date(1e3*a),s=r(t?"%A %#e %b %Y %#R your time":"%A %#e %b %Y %#r your time",i),"SPAN"==n.tagName?(n.innerHTML=" ("+s+")",n.style.display="inline"):(n.innerHTML=s,n.style.display="block"))}return n.initialize=function(n,a){t=a,e=Math.abs((new Date).getTimezoneOffset()-n)>=60},n}(),nn=[];function an(t){if(t)"string"==typeof t?nn.push(an[t]):nn.push(t);else for(var e=0;e<nn.length;++e)nn[e]()}an.time=function(t,e){en.initialize(t,e)};var rn={},sn=1;function on(t,e,n){var a,i,r,s,o,l;if(t instanceof Array)for(a=0;a<t.length;a++)on(t[a],e,n);else if("string"==typeof t)o=n,null!=rn[t]&&null!=rn[t][n]&&(o=rn[t][n]),l=o||"",on(Ve("fold"+t)||Ve(t),e,o),(i=Ve("foldsession."+t+l))?i.src=i.src.replace(/val=.*/,"val="+(e?1:0)+"&u="+sn++):(i=Ve("foldsession."+t))&&(i.src=i.src.replace(/val=.*/,"val="+(e?1:0)+"&sub="+(n||l)+"&u="+sn++)),!e&&(i=Ve("fold"+t+l+"_d"))&&(i.setSelectionRange&&null==i.hotcrp_ever_focused&&(i.setSelectionRange(i.value.length,i.value.length),i.hotcrp_ever_focused=!0),i.focus());else if(t&&(r="fold"+(l=n||"")+"o",s="fold"+l+"c",null==e&&t.className.indexOf(r)>=0&&(e=!0),t.className=e?t.className.replace(r,s):t.className.replace(s,r),document.recalc))try{t.innerHTML=t.innerHTML+""}catch(t){}return!1}function ln(){u(this,"need-pa-grade");var t,e=this.getAttribute("data-pa-grade"),n=ze.closest(this);if(n&&e&&(t=n.entries[e])&&($(this).html(t.html_skeleton(n.editable)),$(this).find(".need-autogrow").autogrow(),n.fill_dom_at($(this).find(".pa-grade")[0]),t.landmark_range&&this.closest(".pa-gradebox")&&cn.call(this.firstChild,t),this.hasAttribute("data-pa-landmark-buttons")))for(var a=JSON.parse(this.getAttribute("data-pa-landmark-buttons")),i=0;i<a.length;++i)"string"==typeof a[i]?$(this).find(".pa-pd").first().append(a[i]):a[i].className&&$(this).find(".pa-pd").first().append('<button type="button" class="btn uic uikd pa-grade-button" data-pa-grade-button="'+a[i].className+'">'+a[i].title+"</button>")}function dn(){u(this,"need-pa-gradelist"),d(this,"pa-gradelist");let t=this.closest(".pa-psetinfo"),e=ze.closest(t);if(!e)return;let n=this.firstChild;for(;n&&!l(n,"pa-grade");)n=n.nextSibling;for(let t=0;t!==e.order.length;++t){let a=e.order[t];if(a)if(n&&n.getAttribute("data-pa-grade")===a)n=n.nextSibling;else{let t=$(e.entries[a].html_skeleton(e.editable))[0];this.insertBefore(t,n),e.fill_dom_at(t)}}for(;n;){let t=n;n=n.nextSibling,this.removeChild(t)}$(this).find(".need-autogrow").autogrow()}function un(){if(!l(this,"pa-psetinfo"))throw new Error("bad pa_loadgrades");var t=ze.closest(this);if(t&&t.order){$(this).find(".need-pa-grade").each((function(){ln.call(this,!0)})),$(this).find(".pa-gradelist").each((function(){dn.call(this,!0)})),$(this).find(".pa-grade").each((function(){t.fill_dom_at(this)}));var e=[t.get_total(),t.maxtotal],n=""+e[0],a=!1;e[0]&&$(this).find(".pa-gradelist:not(.pa-gradebox)").each((function(){$(this).find(".pa-total").length||$(this).prepend(function(t,e){var n='<div class="pa-total pa-p',a=0;for(var i in t.entries)"text"!==t.entries[i].type&&"select"!==t.entries[i].type&&"section"!==t.entries[i].type&&++a;return a<=1&&(n+=" hidden"),n+'"><div class="pa-pt">total</div><div class="pa-pd"><span class="pa-gradevalue pa-gradewidth"></span> <span class="pa-gradedesc">of '+e[1]+"</span></div></div>"}(t,e))})),$(this).find(".pa-total").each((function(){var t=$(this).find(".pa-gradevalue");t.text()!==n&&(t.text(n),a=!0)})),a&&$(this).find(".pa-grgraph").trigger("redrawgraph")}}function hn(t,e,n,a){var i=-1,r=-1,s=this;if("function"==typeof t){n=t,a=e;var o=Ue.closest(this),l=o&&o.landmark_range?/:(\d+):(\d+)$/.exec(o.landmark_range):null;if(!l||!(s=s.closest(".pa-filediff")))return null;t=+l[1],e=+l[2]}for(;s=bt(s,!0,3);){var d=s.firstChild;d.hasAttribute("data-landmark")&&(i=+d.getAttribute("data-landmark")),(d=d.nextSibling)&&d.hasAttribute("data-landmark")&&(r=+d.getAttribute("data-landmark")),i>=t&&i<=e&&(!a||s.matches(a))&&n.call(this,s,i,r)}}function cn(t,e){var n=this.closest(".pa-grade"),a=$(n).find(".pa-pt").html(),i=null;t||(t=Ue.closest(n)),hn.call(this,(function(t){var e,n,r=Xt.at(t);r.text&&((e=/^[\s❮→]*(\+)(\d+(?:\.\d+)?|\.\d+)((?![.,]\w|[\w%$*])\S*?)[.,;:❯]?(?:\s|$)/.exec(r.text))||(e=/^[\s❮→]*()(\d+(?:\.\d+)?|\.\d+)(\/[\d.]+(?![.,]\w|[\w%$*\/])\S*?)[.,;:❯]?(?:\s|$)/.exec(r.text)))&&(null===i&&(i=0),i+=parseFloat(e[2]),n=a+": "+V(e[1])+"<b>"+V(e[2])+"</b>"+V(e[3]));var s=$(t).find(".pa-note-gradecontrib");!s.length&&n&&(s=$('<div class="pa-note-gradecontrib"></div>').insertBefore($(t).find(".pa-note"))),n?s.html(n):s.remove()}),".pa-gw"),t.round&&null!=i&&(i="up"===t.round?Math.ceil(i):"down"===t.round?Math.floor(i):Math.round(i));var r=$(this).find(".pa-notes-grade");if(null===i)r.remove();else{if(!r.length){r=$('<a class="uic uikd pa-notes-grade" href=""></a>');for(var s=this.lastChild.firstChild;s&&(1!==s.nodeType||l(s,"pa-gradewidth")||l(s,"pa-gradedesc"));)s=s.nextSibling;this.firstChild.nextSibling.insertBefore(r[0],s)}r.text("Notes grade "+i)}var o=$(this).find(".pa-gradevalue")[0];if(o){var d,u=null===i?"":""+i;e&&(d=$(o).val())==o.getAttribute("data-pa-notes-grade")&&u!=d&&$(o).val(u).change(),o.setAttribute("data-pa-notes-grade",u)}return i}f.on("js-foldup",(function(t,e){var n,a,i,r=this;if("number"==typeof e?e={n:e}:e||(e={}),"DIV"!==this.tagName||!t||!t.target.closest("a")||e.required){!("n"in e)&&r.hasAttribute("data-fold-target")&&(a=r.getAttribute("data-fold-target").match(/^(\D[^#]*$|.*(?=#)|)#?(\d*)([cou]?)$/))&&(""!==a[1]&&(r=document.getElementById(a[1])),e.n=parseInt(a[2])||0,"f"in e||""===a[3]||("u"===a[3]&&"INPUT"===this.tagName&&"checkbox"===this.type?e.f=this.checked:e.f="c"===a[3]));for(var s="fold"+(e.n||"");r&&(!r.id||"fold"!=r.id.substr(0,4))&&!l(r,"has-fold")&&(null==e.n||!l(r,s+"c")&&!l(r,s+"o"));)r=r.parentNode;if(!r)return!0;if(null==e.n){i=c(r);for(var o=0;o!==i.length;++o)"fold"===i[o].substring(0,4)&&(a=i[o].match(/^fold(\d*)[oc]$/))&&(null==e.n||+a[1]<e.n)&&(e.n=+a[1],s="fold"+(e.n||""))}if(!("f"in e)&&("INPUT"===this.tagName||"SELECT"===this.tagName)){var d=null;if("checkbox"===this.type)e.f=!this.checked;else if("radio"===this.type){if(!this.checked)return!0;d=this.value}else"select-one"===this.type&&(d=this.selectedIndex<0?"":this.options[this.selectedIndex].value);if(null!==d){var u=(r.getAttribute("data-"+s+"-values")||"").split(/\s+/);e.f=u.indexOf(d)<0}}n=!l(r,s+"c"),"f"in e&&!e.f===n||(e.f=n,on(r,n,e.n||0),$(r).trigger(e.f?"fold":"unfold",e)),this.hasAttribute("aria-expanded")&&this.setAttribute("aria-expanded",n?"false":"true"),t&&"object"==typeof t&&"click"===t.type&&!l(t.target,"uic")&&(t.stopPropagation(),t.preventDefault())}})),f.on("js-pset-upload-grades",(function(){$("#upload").removeClass("hidden")})),f.on("pa-signin-radio",(function(){let t;"login"===this.value?(on("logingroup",!1),on("logingroup",!1,2),t="Sign in"):"forgot"===this.value?(on("logingroup",!0),on("logingroup",!1,2),t="Reset password"):"new"===this.value&&(on("logingroup",!0),on("logingroup",!0,2),t="Create account"),document.getElementById("signin").value=t})),f.on("pa-gradevalue",(function(){var t,e,n=this.closest("form"),a=this;n&&l(n,"pa-grade")?$(n).submit():"hidden"===a.type&&(t=a.closest(".pa-grade").getAttribute("data-pa-grade-type"))&&(e=We.find(t))&&setTimeout((function(){e.reflect_value.call(null,a,+a.value,{})}),0)})),function(){function t(t){var e=$(t);e.find(".pa-gradediffers, .pa-save-message").remove();var n=e.find(".pa-pd").first(),a=n.find(".pa-gradedesc");a.length||($(n[0].firstChild).after(' <span class="pa-gradedesc"></span>'),a=n.find(".pa-gradedesc")),a.append('<span class="pa-save-message"><span class="spinner"></span></span>');var i=ze.closest(t),r={},s={};e.find("input.pa-gradevalue, textarea.pa-gradevalue, select.pa-gradevalue").each((function(){var t=i.entries[this.name];i.grades&&t&&null!=i.grades[t.pos]?s[this.name]=i.grades[t.pos]:"late_hours"===this.name&&null!=i.late_hours&&(s[this.name]=i.late_hours),"checkbox"!==this.type&&"radio"!==this.type||this.checked?r[this.name]=this.value:"checkbox"===this.type&&(r[this.name]=0)})),e.data("paOutstandingPromise",new Promise((function(n,a){W(j("api/grade",E(e[0])),{grades:r,oldgrades:s}).then((function(i){e.removeData("paOutstandingPromise"),i.ok?(e.find(".pa-save-message").html('<span class="savesuccess"></span>').addClass("fadeout"),$(t).closest(".pa-psetinfo").data("pa-gradeinfo",new ze(i)).each(un),n(t)):(e.find(".pa-save-message").html('<strong class="err">'+i.error+"</strong>"),a(t))}))})))}f.on("pa-grade",(function(e){e.preventDefault();var n=$(this).data("paOutstandingPromise");n?n.then(t):t(this)}))}(),f.on("pa-grade-button",(function(t){if("keydown"===t.type){var e,n=y(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var a=e.getAttribute("data-pa-grade"),i=$(".pa-grade[data-pa-grade="+a+"] .pa-grade-button[data-pa-grade-button="+this.getAttribute("data-pa-grade-button")+"]").filter(":visible"),r=i.toArray().indexOf(this);if(r>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var s=i[(r+("n"===n||"N"===n?1:i.length-1))%i.length],o=s.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),s.focus(),$(s).scrollIntoView()}else i.click();t.preventDefault()}}}else"click"===t.type&&f.trigger.call(this,this.getAttribute("data-pa-grade-button"),t)})),$((function(){$(".need-pa-grade").each(ln),$(".need-pa-gradelist").each(dn)})),f.on("pa-notes-grade",(function(t){if("keydown"===t.type){var e,n=y(t);if(t.ctrlKey&&("n"===n||"N"===n||"p"===n||"P"===n||"A"===n)&&(e=this.closest(".pa-grade"))){var a=e.getAttribute("data-pa-grade"),i=$(".pa-grade[data-pa-grade="+a+"] .pa-notes-grade").filter(":visible"),r=i.toArray().indexOf(this);if(r>=0){if("n"===n||"N"===n||"p"===n||"P"===n){var s=i[(r+("n"===n||"N"===n?1:i.length-1))%i.length],o=s.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),s.focus(),$(s).scrollIntoView()}else i.click();t.preventDefault()}}}else if("click"===t.type){var l=$(this).closest(".pa-grade").find(".pa-gradevalue");l.length&&l.val()!=l.attr("data-pa-notes-grade")&&l.val(l.attr("data-pa-notes-grade")).change(),t.preventDefault()}})),$((function(){var t=document.body.getAttribute("data-now")-(new Date).getTime()/1e3;$(".pa-download-timed").each((function(){var e=this,n=setInterval(a,15e3);function a(){var a,i=+e.getAttribute("data-pa-download-at"),s=+e.getAttribute("data-pa-commit-at"),o=+e.getAttribute("data-pa-download-expiry"),l=(new Date).getTime()/1e3+t;a=l>o?r("%Y/%m/%d %H:%M",i):Math.round((l-i)/60)+" min",s>i&&(a+=" · "+Math.round((s-i)/60)+" min before commit"),$(e).find(".pa-download-timer").text(a),l>o&&clearInterval(n)}a()}))})),f.on("pa-anonymized-link",(function(t){var e=this.getAttribute("data-pa-link");t&&t.metaKey?window.open(e):window.location=e})),window.$pa={beforeunload:function(){var t=!0;if($(".pa-gw textarea").each((function(){var e=this.closest(".pa-dl"),n=Xt.at(e);o(this.value,n.text)||l(e,"pa-save-failed")||(t=!1)})),!t)return event.returnValue="You have unsaved notes. You will lose them if you leave the page now."},checklatest:function(){var t,e,n,a=(new Date).getTime();function i(a){!a||!a.hash||a.hash===n||a.snaphash&&a.snaphash===n||($(".pa-commitcontainer .pa-pd").first().append('<div class="pa-inf-error"><span class="pa-inf-alert">Newer commits are available.</span> <a href="'+N("pset",{u:siteinfo.uservalue,pset:e,commit:a.hash})+'">Load them</a></div>'),clearTimeout(t))}(e=$(".pa-commitcontainer").first().attr("data-pa-pset"))&&(n=$(".pa-commitcontainer").first().attr("data-pa-commit"),setTimeout((function r(){var s=(new Date).getTime();t=s-a<=6e4?setTimeout(r,n?1e4:2e3):s-a<=6e5?setTimeout(r,n?2e4:1e4):s-a<=36e5?setTimeout(r,1.25*(s-a)):null,$.ajax(j("api/latestcommit",{u:siteinfo.uservalue,pset:e}),{type:"GET",cache:!1,dataType:"json",success:i})}),2e3))},filediff_markdown:St,fold:on,grgraph:function(){const t=this,e=t.getAttribute("data-pa-pset");$.ajax(j("api/gradestatistics",e?{pset:e}:{}),{type:"GET",cache:!0,dataType:"json",success:function(e){e.series&&e.series.all&&($(t).data("paGradeData",new Ne(e)),Ee.call(t))}})},onload:an,loadgrades:un,load_runsettings:function(t){var e,n,a=$("#pa-runsettings"),i=a.find(".n");for(n in i.attr("data-outstanding","1"),t){for(e=0;e!=i.length&&$.trim($(i[0]).val())!=n;++e);e==i.length?ve(n,t[n]):$.trim(a.find("[name=v"+e+"]").val())!=t[n]&&(a.find("[name=v"+e+"]").val(t[n]),$(i[e]).removeAttr("data-outstanding"))}for(e=0;e!=i.length;++e)$(i[e]).attr("data-outstanding")&&$("[data-runsetting-num="+$(i[e]).attr("name").substr(1)+"]").remove()},pset_actions:function(){var t=$(this);function e(){var e=t.find("select[name='state']").val();t.find(".pa-if-enabled").toggleClass("hidden","disabled"===e),t.find(".pa-if-visible").toggleClass("hidden","disabled"===e||"invisible"===e)}e(),t.find("select[name='state']").on("change",e),t.find("input, select").on("change",(function(){t.find("[type='submit']").addClass("alert")})),t.removeClass("need-pa-pset-actions")},render_text_page:Ft.on_page,render_pset_table:function(n,a){var i,s,o,c,p,f,g,m,v,b,x,y=$(this),w=0,_=[],A=null,k=n.flagged_commits,C=n.grades_visible,M={f:k?"at":"username",last:!0,rev:1},S=-1,T=null,E=n.anonymous,L={checkbox:{th:'<th class="gt-checkbox" scope="col"></th>',td:function(t,e){return""==e?"<td></td>":'<td class="gt-checkbox"><input type="checkbox" name="'+z(t)+'" value="1" class="'+(this.className||"uic js-range-click papsel")+'" data-range-type="s61"></td>'},tw:1.5},rownumber:{th:'<th class="gt-rownumber" scope="col"></th>',td:function(t,e){return""==e?"<td></td>":'<td class="gt-rownumber">'+e+".</td>"},tw:.75*Math.ceil(Math.log10(Math.max(a.length,1)))+1},pset:{th:'<th class="gt-pset l plsortable" data-pa-sort="pset" scope="col">Pset</th>',td:function(t){return'<td class="gt-pset"><a href="'+R(t)+'" class="track">'+V(siteinfo.psets[t.psetid].title)+(t.hash?"/"+t.hash.substr(0,7):"")+"</a></td>"},tw:12},at:{th:'<th class="gt-at l plsortable" data-pa-sort="at" scope="col">Flagged</th>',td:function(t){return'<td class="gt-at">'+(t.at?r("%#e %b %#k:%M",t.at):"")+"</td>"},tw:8},username:{th:function(){var t='<span class="heading">'+(E||!M.email?"Username":"Email")+"</span>";return n.anonymous&&n.can_override_anonymous?t+=' <a href="" class="uu n js-switch-anon">[anon]</a>':n.anonymous&&(t+=' <span class="n">[anon]</span>'),'<th class="gt-username l plsortable" data-pa-sort="username" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-username">'+H(t)+"</td>"},tw:12,pin:!0},name:{th:function(){return'<th class="gt-name l plsortable" data-pa-sort="name" scope="col">Name</th>'},td:function(t){return'<td class="gt-name">'+U(t,!1)+"</td>"},tw:14},name2:{th:function(){var t='<span class="heading">'+(E?"Username":"Name")+"</span>";return n.anonymous&&n.can_override_anonymous&&(t+=' <a href="" class="uu n js-switch-anon">[anon]</a>'),'<th class="gt-name2 l plsortable" data-pa-sort="name2" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-name2">'+U(t,!0)+"</td>"},tw:14},extension:{th:'<th class="gt-extension l plsortable" data-pa-sort="extension" scope="col">X?</th>',td:function(t){return'<td class="gt-extension">'+(t.x?"X":"")+"</td>"},tw:2},grader:{th:'<th class="gt-grader l plsortable" data-pa-sort="grader" scope="col">Grader</th>',td:function(t){var e=t.gradercid?"???":"";return t.gradercid&&siteinfo.pc[t.gradercid]&&(e=q(siteinfo.pc[t.gradercid])),'<td class="gt-grader">'+e+"</td>"},tw:6},notes:{th:'<th class="gt-notes l plsortable" data-pa-sort="gradestatus" scope="col">⎚</th>',td:function(t){var e="";return t.grades_visible&&(e+="⎚"),k&&t.is_grade&&(e+="✱"),t.has_notes&&(e+="♪"),!k&&t.has_nongrader_notes&&(e+="<sup>*</sup>"),'<td class="gt-notes">'+e+"</td>"},tw:2},conversation:{th:'<th class="gt-conversation l" scope="col">Flag</th>',td:function(t){return'<td class="gt-conversation l">'+V(t.conversation||t.conversation_pfx||"")+(t.conversation_pfx?"…":"")+"</td>"},tw:20},gdialog:{th:"<th></th>",td:function(){return'<td><a href="" class="ui x js-gdialog" tabindex="-1" scope="col">Ⓖ</a></td>'},tw:1.5,pin:!0},total:{th:'<th class="gt-total r plsortable" data-pa-sort="total" scope="col">Tot</th>',td:function(t){return'<td class="gt-total r">'+t.total+"</td>"},tw:3},grade:{th:function(){return'<th class="'+("right"===this.justify?"gt-grade r":"gt-grade l")+' plsortable" data-pa-sort="grade'+this.gidx+'" scope="col">'+this.gabbr+"</th>"},td:function(t,e,n){var a=t.grades[this.gidx],i=V(this.ge.tcell(a));if(n)return i;var r='<td class="'+this.klass;return t.highlight_grades&&t.highlight_grades[this.gkey]&&(r+=" gt-highlight"),r+'">'+i+"</td>"},tw:function(){var t=0;if(this.klass=this.gkey===n.total_key?"gt-total":"gt-grade","right"===this.justify&&(this.klass+=" r"),"select"===this.ge.gc.type){this.klass+=" gt-el";for(var e=0;e!==this.ge.options.length;++e)t=Math.max(t,this.ge.options[e].length);t=Math.floor(1.25*Math.min(t,10))/2}else t=3;return Math.max(t,.5*this.gabbr.length+1.5)}},ngrades:{th:'<th class="gt-ngrades r plsortable" data-pa-sort="ngrades" scope="col">#G</th>',td:function(t){return'<td class="gt-ngrades r">'+(t.ngrades_nonempty||"")+"</td>"},tw:2},repo:{th:'<th class="gt-repo" scope="col"></th>',td:function(t){var e;return e=t.repo?E?'<a href="" data-pa-link="'+V(t.repo)+'" class="ui pa-anonymized-link">repo</a>':'<a class="track" href="'+V(t.repo)+'">repo</a>':"",t.repo_broken&&(e+=' <strong class="err">broken</strong>'),t.repo_unconfirmed&&(e+=' <strong class="err">unconfirmed</strong>'),t.repo_too_open&&(e+=' <strong class="err">open</strong>'),t.repo_handout_old&&(e+=' <strong class="err">handout</strong>'),t.repo_partner_error&&(e+=' <strong class="err">partner</strong>'),t.repo_sharing&&(e+=' <strong class="err">sharing</strong>'),'<td class="gt-repo">'+e+"</td>"},tw:10}};function O(t){return function(){return t}}function I(){"name"!==M.f&&"name2"!==M.f&&"username"!==M.f&&"email"!==M.f&&null!=M.nameflag||(M.nameflag=0,"name"!==M.f&&"name2"!==M.f||(M.nameflag|=1),M.last&&(M.nameflag|=2),M.email&&(M.nameflag|=4),E&&(M.nameflag|=8))}function D(t){return E&&t.anon_username||t.username||""}function P(t){var e={u:D(t),pset:t.psetid?siteinfo.psets[t.psetid].urlkey:n.key};return!t.hash||t.is_grade&&!k?t.gradehash&&(e.commit=t.gradehash,e.commit_is_grade=1):e.commit=t.hash,e}function R(t){return V(N("pset",P(t)))}function F(t,e){return'<a href="'.concat(R(e),'" class="track',e.dropped?' gt-dropped">':'">',t,"</a>")}function H(t){return F(V(E&&t.anon_username?t.anon_username:M.email&&t.email?t.email:t.username||""),t)}function B(t,e){return null!=t.first&&null!=t.last?e?t.last.concat(", ",t.first):t.first.concat(" ",t.last):null!=t.first?t.first:null!=t.last?t.last:""}function U(t,e){var n=V(e&&E?t.anon_username||"?":B(t,T));return e?F(n,t):n}function z(t){var e=E&&t.anon_username||t.username;return"s:"+encodeURIComponent(e).replace(/\./g,"%2E")}function q(t){return t.__nickname||(t.nick?t.__nickname=t.nick:t.nicklen||t.lastpos?t.__nickname=t.name.substr(0,t.nicklen||t.lastpos-1):t.__nickname=t.name),t.__nickname}function J(t){var e,n,i=t.children("tbody"),r=t.children("thead")[0].firstChild.childNodes.length,s=i[0],o=function(t){for(var e={},n=t.find("tbody")[0].firstChild,a=null;n;)n.hasAttribute("data-pa-partner")?a.push(n):e[n.getAttribute("data-pa-spos")]=a=[n],n=n.nextSibling;return e}(t),h=0,c=!1,p=s.firstChild;for(e=0;e!==a.length;++e){for(var f=a[e];(n=p)&&"gt-boring"===n.className;)p=p.nextSibling,s.removeChild(n);f.boringness!==c&&!1!==c&&s.insertBefore($('<tr class="gt-boring"><td colspan="'+r+'"><hr></td></tr>')[0],p),c=f.boringness;var g=o[f._spos];for(n=0;n<g.length;++n)p!==g[n]?s.insertBefore(g[n],p):p=p.nextSibling,u(g[n],"k"+(1-h%2)),d(g[n],"k"+h%2);++h}h=0,i.find(".gt-rownumber").html((function(){return++h+"."}));var m=M.f&&M.last;m!==T&&(T=m,i.find(".gt-name, .gt-name2").html((function(){return U(_[this.parentNode.getAttribute("data-pa-spos")],l(this,"gt-name2"))})))}function K(){for(var t=[],e=0;e!==a.length;++e)t.push(D(a[e]));o.value=t.join(" ")}function X(){J(y),A&&J(A),o&&K(),t.site(!0,"pa-pset"+n.id+"-table",JSON.stringify(M))}function G(){for(var t={},e=y.find("tbody")[0].firstChild;e;)t[e.getAttribute("data-pa-uid")]=e,e=e.nextSibling;return t}function Y(){var t=A?$([y[0],A[0]]):y;t.find("td.gt-username").each((function(){var t=_[this.parentNode.getAttribute("data-pa-spos")];$(this).html(H(t))})),t.find("th.gt-username > span.heading").html(E||!M.email?"Username":"Email"),t.find("td.gt-name2").each((function(){var t=_[this.parentNode.getAttribute("data-pa-spos")];$(this).html(U(t,!0))})),t.find("th.gt-name2 > span.heading").html(E?"Username":"Name")}function Q(){y.toggleClass("gt-anonymous",!!E),w&&s&&(y.css("width",w-(E?s.width:0)+"px"),$(y[0].firstChild).find(".gt-name").css("width",(E?0:s.width)+"px"))}function Z(t){(E=!E)||(M.override_anonymous=!0),Q(),Y(),y.find("tbody input.gt-check").each((function(){var t=_[this.parentNode.parentNode.getAttribute("data-pa-spos")];this.setAttribute("name",z(t))})),at(),X(),y.closest("form").find("input[name=anonymous]").val(E?1:0),t.preventDefault(),t.stopPropagation()}function tt(t){let n="";return 8&S&&t.anon_username?n=t.anon_username+" ":1&S&&(n=B(t,2==(2&S))+" "),4&S&&t.email?n+=t.email:n+=t.username||"",null!=t.psetid&&(n+=e(" %5d",t.psetid)),null!=t.at&&(n+=e(" %11g",t.at)),n.toLowerCase()}function et(t,e){return t._sort_user<e._sort_user?-M.rev:t._sort_user==e._sort_user?0:M.rev}function nt(t,e){var n=t.gradercid?siteinfo.pc[t.gradercid]:null,a=e.gradercid?siteinfo.pc[e.gradercid]:null,i=n&&q(n)||"~~~",r=a&&q(a)||"~~~";return i!=r?i<r?-M.rev:M.rev:0}function at(){var t,e=M.f,n=M.rev;if(function(){if(M.nameflag!==S){S=M.nameflag;for(var t=0;t<a.length;++t)a[t]._sort_user=tt(a[t])}}(),"name"!==e&&"name2"!==e||E)if("extension"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.x!=e.x?t.x?n:-n:et(t,e)}));else if("grader"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:nt(t,e)||et(t,e)}));else if("gradestatus"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.grades_visible!=e.grades_visible?t.grades_visible?-1:1:t.has_notes!=e.has_notes?t.has_notes?-1:1:nt(t,e)||et(t,e)}));else if("pset"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.psetid!=e.psetid?siteinfo.psets[t.psetid].pos<siteinfo.psets[e.psetid].pos?-n:n:t.pos<e.pos?-n:n}));else if("at"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.at!=e.at?t.at<e.at?-n:n:t.pos<e.pos?-n:n}));else if("total"===e)a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.total!=e.total?t.total<e.total?-n:n:-et(t,e)}));else if((t=/^grade(\d+)$/.exec(e))&&f[+t[1]]){var i=+t[1],r=f[i].type&&"forward"===f[i].gc.sort,s=r?-n:n;a.sort((function(t,e){if(t.boringness!==e.boringness)return t.boringness-e.boringness;var a=t.grades&&t.grades[i],o=e.grades&&e.grades[i];return""===a||null==a||""===o||null==o?""!==a&&null!=a?s:""!==o&&null!=o?-s:-et(t,e):a<o?-n:a>o?n:r?et(t,e):-et(t,e)}))}else"ngrades"===e&&m?a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.ngrades_nonempty!==e.ngrades_nonempty?t.ngrades_nonempty<e.ngrades_nonempty?-n:n:-et(t,e)})):M.email&&!E?(e="username",a.sort((function(t,e){if(t.boringness!==e.boringness)return t.boringness-e.boringness;var a=(t.email||"").toLowerCase(),i=(e.email||"").toLowerCase();return a!==i?""===a||""===i?""===a?n:-n:a<i?-n:n:et(t,e)}))):("name2"!==e&&(e="username"),a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:et(t,e)})));else a.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:et(t,e)}));var o=A?$([y[0].firstChild,A[0].firstChild]):$(y[0].firstChild);o.find(".plsortable").removeClass("plsortactive plsortreverse"),o.find("th[data-pa-sort='"+e+"']").addClass("plsortactive").toggleClass("plsortreverse",M.rev<0)}function it(){if(this.hasAttribute("data-pa-sort")){var t,e=this.getAttribute("data-pa-sort");e!==M.f?(M.f=e,"username"===e||"name"===e||"name2"===e||"grader"===e||"extension"===e||"pset"===e||"at"===e||(t=e.match(/^grade(\d+)$/))&&f[t[1]].type&&"forward"===f[t[1]].gc.sort?M.rev=1:M.rev=-1):"name"===e||"name2"===e&&!E?(M.rev=-M.rev,1===M.rev&&(M.last=!M.last)):"username"===e?(-1!==M.rev||E||(M.email=!M.email,Y()),M.rev=-M.rev):M.rev=-M.rev,I(),at(),X()}}function rt(){h(this.closest(".pa-pd"),"pa-grade-changed",this.hasAttribute("data-pa-unmixed")||Ye(this))}function st(t,e,a){for(var i=t[e.uid],r=_[i.getAttribute("data-pa-spos")],s=0,o=0;o!==a.length;++o){var l,d=a[o],u=n.grades.entries[d];u&&(l=v[u.colpos])&&(r.grades[u.pos]!==e.grades[o]&&(r.grades[u.pos]=e.grades[o],i.childNodes[u.colpos].innerText=l.td.call(l,r,null,!0)),null!=e.grades[o]&&""!==e.grades[o]&&++s)}e.total!==r.total&&(r.total=e.total,b&&(i.childNodes[b].innerText=r.total)),s!==r.ngrades_nonempty&&(r.ngrades_nonempty=s,x&&(i.childNodes[x].innerText=r.ngrades_nonempty||""))}function ot(t){c.find(".has-error").removeClass("has-error"),t.ok?c.find(".pa-messages").html(""):(c.find(".pa-messages").html(Xe(2,V(t.error))),t.errf&&c.find(".pa-gradevalue").each((function(){t.errf[this.name]&&d(this,"has-error")})))}function lt(t){var e=!1,a={};if(c.find(".pa-gradevalue").each((function(){if((this.hasAttribute("data-pa-unmixed")||Ye(this))&&!this.indeterminate){var t,i=this.name,r=n.grades.entries[i];t="checkbox"===this.type?this.checked?this.value:"":$(this).val();for(var s=0;s!==p.length;++s){var o=p[s];a[o.uid]=a[o.uid]||{grades:{},oldgrades:{}},a[o.uid].grades[i]=t,a[o.uid].oldgrades[i]=o.grades[r.pos]}e=!0}})),e)if(1===p.length)W(j("api/grade",P(p[0])),a[p[0].uid]).then((function(e){ot(e),e.ok&&(st(G(),e,e.order),t())}));else{for(var i=0;i!==p.length;++i)p[i].gradehash&&(a[p[i].uid].commit=p[i].gradehash,a[p[i].uid].commit_is_grade=1);W(j("api/multigrade",{pset:n.key}),{us:JSON.stringify(a)}).then((function(e){if(ot(e),e.ok){var n=G();for(var a in e.us)st(n,e.us[a],e.order);t()}}))}else t()}function dt(){var t=this.getAttribute("data-pa-spos");lt((function(){ht([t])}))}function ut(){u(this,"has-error")}function ht(t){p=[];for(var e=0;e!==t.length;++e)p.push(_[t[e]]);c.find("h2").html(V(n.title)+" : "+p.map((function(t){return V(E?t.anon_username:t.username||t.email)})).join(", "));var a=1===p.length?p[0]:null;if(a){var i=(a.first||a.last?a.first+" "+a.last+" ":"")+"<"+a.email+">";c.find(".gt-name-email").html(V(i)).removeClass("hidden")}else c.find(".gt-name-email").addClass("hidden");if(c.find(".pa-gradelist").toggleClass("pa-pset-hidden",!!p.find((function(t){return!t.grades_visible}))),c.find(".pa-grade").each((function(){for(var t=this.getAttribute("data-pa-grade"),e=n.grades.entries[t],a=p[0].grades[e.pos],i=!1,r=1;r!==p.length;++r){var s=p[r].grades[e.pos];s===a||null==s&&""===a||""===s&&null==a||(i=!0)}i?e.fill_dom(this,null,{reset:!0,mixed:!0}):e.fill_dom(this,a,{reset:!0})})),a){for(var r,s=y.find("tbody")[0].firstChild;s&&s.getAttribute("data-pa-spos")!=a._spos;)s=s.nextSibling;for(r=s;r&&(r===s||!r.hasAttribute("data-pa-spos"));)r=r.previousSibling;for(c.find("button[name=prev]").attr("data-pa-spos",r?r.getAttribute("data-pa-spos"):"").prop("disabled",!r),r=s;r&&(r===s||!r.hasAttribute("data-pa-spos"));)r=r.nextSibling;c.find("button[name=next]").attr("data-pa-spos",r?r.getAttribute("data-pa-spos"):"").prop("disabled",!r)}}function ct(t){let e;!t.ctrlKey||"n"!==t.key&&"p"!==t.key||!(e=c.find("button[name="+("n"===t.key?"next":"prev")+"]"))||e[0].disabled?"Return"===t.key||"Enter"===t.key?(lt((function(){c.close()})),t.stopImmediatePropagation(),t.preventDefault()):"Esc"===t.key||"Escape"===t.key?(t.stopImmediatePropagation(),c.close()):"Backspace"===t.key&&this.hasAttribute("placeholder")&&pt.call(this):(dt.call(e[0]),t.stopImmediatePropagation(),t.preventDefault())}function pt(){this.hasAttribute("placeholder")&&(this.setAttribute("data-pa-unmixed",1),this.removeAttribute("placeholder"),rt.call(this))}function ft(){var t=tn();t.push("<h2></h2>"),E||t.push('<strong class="gt-name-email"></strong>'),t.push('<div class="pa-messages"></div>'),t.push('<div class="pa-gradelist in-modal">',"</div>");for(var e=0;e!==f.length;++e)t.push(f[e].html_skeleton(!0,!1));t.pop(),t.push_actions(),t.push('<button type="button" name="bsubmit" class="btn-primary">Save</button>'),t.push('<button type="button" name="cancel">Cancel</button>'),t.push('<button type="button" name="prev" class="btnl">&lt;</button>'),t.push('<button type="button" name="next" class="btnl">&gt;</button>'),(c=t.show(!1)).children(".modal-dialog").addClass("modal-dialog-wide"),c.find("form").addClass("pa-psetinfo").data("pa-gradeinfo",n.grades);var a=y.find(".papsel:checked").toArray().map((function(t){return t.parentElement.parentElement.getAttribute("data-pa-spos")})),i=this.closest("tr").getAttribute("data-pa-spos");a.indexOf(i)<0?ht([i]):(c.find("button[name=prev], button[name=next]").prop("disabled",!0).addClass("hidden"),ht(a)),c.on("change blur",".pa-gradevalue",rt),c.on("input change",".pa-gradevalue",ut),c.on("keydown",ct),c.on("keydown","input, textarea, select",ct),c.on("input","input, textarea, select",pt),c.find("button[name=bsubmit]").on("click",(function(){lt((function(){c.close()}))})),c.find("button[name=prev], button[name=next]").on("click",dt),t.show()}function gt(){let t=0;for(;t!==v.length&&!v[t].pin;)++t;var e=$('<div style="position:absolute;left:0;top:0;bottom:0;width:'+(v[t].left-10)+'px;pointer-events:none"></div>').prependTo(y.parent())[0],n=!1,a=!1;var i=new IntersectionObserver((function(t){for(var i of t)i.target===e?a=i.isIntersecting:n=i.isIntersecting;!n||a||A?n&&a&&A&&(A.parent().remove(),A=null):function(){let t,e,n=0,a=0,i=[];for(;n!==v.length&&!v[n].pin;)++n;for(t=n;t!==v.length&&v[t].pin;++t)a+=v[t].width;e='<table class="gtable gtable-fixed gtable-overlay new" style="position:absolute;left:-24px;width:'+(a+24)+'px"><thead><tr class="k0 kfade"><th style="width:24px"></th>';for(let a=n;a!==t;++a)e+='<th style="width:'+v[a].width+'px"'+v[a].th.call(v[a]).substring(3);A=$(e+"</thead><tbody></tbody></table>");var r=y[0].firstChild.firstChild,s=A[0].firstChild.firstChild;for(let e=n;e!==t;++e)s.childNodes[e-n+1].className=r.childNodes[e].className;for(y[0].parentNode.prepend($('<div style="position:sticky;left:0;z-index:2"></div>').append(A)[0]),A.find("thead").on("click","th",it),A.find(".js-switch-anon").click(Z),r=y.children("tbody")[0].firstChild;r;){if(l(r,"gt-boring"))i.push('<tr class="gt-boring"><td colspan="'+(t-n+1)+'"><hr></td></tr>');else{let e=r.getAttribute("data-pa-spos"),a='<tr class="'+r.className+' kfade" data-pa-spos="'+e;r.hasAttribute("data-pa-uid")&&(a+='" data-pa-uid="'+r.getAttribute("data-pa-uid")),r.hasAttribute("data-pa-partner")&&(a+='" data-pa-partner="1'),a+='"><td></td>';for(let i=n;i!==t;++i)a+='<td style="height:'+r.childNodes[i].clientHeight+'px"'+v[i].td.call(v[i],_[e],"").substring(3);i.push(a+"</tr>")}r=r.nextSibling}A.find("tbody").html(i.join("")),setTimeout((function(){A&&u(A[0],"new")}),0)}()}));i.observe(e),i.observe(y.parent()[0])}function mt(t,e){for(var n=[],a=0;a!==v.length;++a)n.push(v[a].td.call(v[a],t,e));return n}y.parent().on("click","a.js-gdialog",(function(t){ft.call(this),t.preventDefault()})),function(){var e=t.site(!0,"pa-pset"+n.id+"-table");if(e&&(M=JSON.parse(e)),M.f&&/^\w+$/.test(M.f)||(M.f="username"),1!==M.rev&&-1!==M.rev&&(M.rev=1),E&&n.can_override_anonymous&&M.override_anonymous||delete M.override_anonymous,E&&M.override_anonymous&&(E=!1),null==M.nameflag&&I(),f=[],g=[],n.grades){n.grades=new ze(n.grades);for(let t=0;t!==n.grades.order.length;++t){const e=n.grades.order[t],a=n.grades.entries[e];"text"!==a.type&&(f.push(a),g.push(e))}}var r=-1;for(let t=0;t<a.length;++t){const e=a[t];e.dropped?e.boringness=2:e.gradehash||n.gitless_grades?e.boringness=0:e.boringness=1;let i=0;for(var l=0;l<g.length;++l)g[l]!=n.total_key&&null!=e.grades[l]&&""!==e.grades[l]&&++i;e.ngrades_nonempty=i,-1===r?r=i:r!==i&&(!e.boringness||i>0)&&(r=-2)}if(m=-2===r,n.col)v=n.col;else{v=[],n.checkbox&&v.push("checkbox"),v.push("rownumber"),k?(v.push("pset"),v.push("at")):v.push("gdialog"),v.push("username","name","extension","grader"),k&&v.push("conversation"),(k||!n.gitless_grades||C)&&v.push("notes"),n.need_total&&(b=v.length,v.push("total"));for(let t=0;t!==g.length;++t){const e=f[t];e.colpos=v.length,v.push({type:"grade",gidx:t,gkey:g[t],gabbr:e.abbr(),ge:e,justify:e.gc.justify||"right"})}m&&(x=v.length,v.push("ngrades")),n.gitless||v.push("repo")}for(let t=0;t!==v.length;++t)"string"==typeof v[t]&&(v[t]={type:v[t]}),v[t].index=t,Object.assign(v[t],L[v[t].type]),"string"==typeof v[t].th&&(v[t].th=O(v[t].th)),"username"!==v[t].type||i||(i=v[t]),"name"!==v[t].type||s||(s=v[t]);y[0].closest("form")&&(o=$('<input name="slist" type="hidden" value="">')[0],y.after(o))}(),function(){var t=$('<thead><tr class="k0"></tr></thead>')[0],e=y.hasClass("want-gtable-fixed"),i=parseFloat(window.getComputedStyle(document.documentElement).fontSize);for(let n=0;n!==v.length;++n){var r=v[n].th.call(v[n]),s=$(r);if(e){v[n].left=w;var l=v[n].tw;"number"!=typeof l&&(l=l.call(v[n])),l*=i,v[n].width=l,s.css("width",l+"px"),w+=l}t.firstChild.appendChild(s[0])}Q(),y[0].appendChild(t),y.toggleClass("gt-useemail",!!M.email),y.find("thead").on("click","th",it),y.find(".js-switch-anon").click(Z),e&&y.removeClass("want-gtable-fixed").css("table-layout","fixed");var d=$('<tbody class="has-hotlist"></tbody>')[0],u=0,h=0,c=[];y[0].appendChild(d),n.no_sort||at(),T="name"===M.f&&M.last;for(let t=0;t!==a.length;++t){var p=a[t];p._spos=_.length,_.push(p),++u,p.boringness!==h&&1!=u&&c.push('<tr class="gt-boring"><td colspan="'+v.length+'"><hr></td></tr>'),h=p.boringness;var f=mt(p,u),g='<tr class="k'+u%2+'" data-pa-spos="'+p._spos;p.uid&&(g+='" data-pa-uid="'+p.uid),c.push(g+'">'+f.join("")+"</tr>");for(var m=0;p.partners&&m<p.partners.length;++m){var b=p.partners[m];b._spos=_.length,_.push(b);for(var x=mt(p.partners[m],""),A=0;A<x.length;++A)x[A]===f[A]&&(x[A]="<td></td>");g='<tr class="k'+u%2+' gtrow-partner" data-pa-spos="'+b._spos,b.uid&&(g+='" data-pa-uid="'+b.uid),c.push(g+'" data-pa-partner="1">'+x.join("")+"</tr>")}c.length>50&&($(c.join("")).appendTo(d),c=[])}0!==c.length&&$(c.join("")).appendTo(d),o&&K(),e&&window.IntersectionObserver&&gt()}(),y.data("paTable",{name_text:function(t){var e,n=y.find("tr[data-pa-uid="+t+"]").attr("data-pa-spos");return n?(e=_[n])?(E?e.anon_username:B(e,T))||"?":"[none]":null}}),y.children("tbody").on("pa-hotlist",(function(t){for(var e=[],i=0;i<a.length;++i){var r=a[i],s="~".concat(encodeURIComponent(D(r)));k&&(s=s.concat("/pset/",siteinfo.psets[r.psetid].urlkey),r.hash&&(s=s.concat("/",r.hash))),e.push(s)}t.hotlist={pset:k?null:n.key,items:e}}))},runmany:function t(){var e=$("#runmany61"),n=e.closest("form");if(n.prop("unload61")||($(window).on("beforeunload",(function(){if(n.prop("outstanding")||$("#runmany61_users").text())return"Several server requests are outstanding."})),n.prop("unload61","1")),!n.prop("outstanding")){for(var a,i=$("#runmany61_users").text().split(/[\s,;]+/);!a&&i.length;)a=i.shift();if(!a)return $("#runmany61_who").text("<done>"),void $("#runmany61_users").text("");$("#runmany61_who").text(a),n.find("[name='u']").val(a),$("#runmany61_users").text(i.join(" "));var r=$('<a href="'+siteinfo.site_relative+"~"+encodeURIComponent(a)+"/pset/"+n.find("[name='pset']").val()+'" class="q ansib ansifg7"></a>');r.text(a),me(e[0],{noclear:!0,headline:r[0]})}setTimeout(t,10)},store_gradeinfo:ze.store}}();
//# sourceMappingURL=pa.min.js.map?version=0c76485dcbf9
