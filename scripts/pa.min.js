!function(){"use strict";let t=function(){return!1};try{window.localStorage&&window.JSON&&(t=function(t,e,a){try{var n=t?window.sessionStorage:window.localStorage;return void 0===e?!!n:void 0===a?n.getItem(e):null===a?n.removeItem(e):"object"==typeof a?n.setItem(e,JSON.stringify(a)):n.setItem(e,a)}catch(t){return!1}})}catch(t){}function e(t){var e,a,n,i,r,s,o=t.split(/(%(?:%|-?(?:\d*|\*?)(?:\.\d*)?[sdefgroxX]))/),l="";for(e=0,i=1;e!=o.length;++e)if("%"!=(a=o[e]).charAt(0))l+=a;else if("%"==a.charAt(1))l+="%";else{if(n=arguments[i],++i,"*"==(r=a.match(/^%(-?)(\d*|\*?)(?:|[.](\d*))(\w)/))[2]&&(r[2]=n.toString(),n=arguments[i],++i),r[4]>="e"&&r[4]<="g"&&null==r[3]&&(r[3]=6),"g"===r[4]?n=(n=Number(n).toPrecision(r[3]).toString()).replace(/\.(\d*[1-9])?0+(|e.*)$/,(function(t,e,a){return(null==e?"":"."+e)+a})):"f"===r[4]?n=Number(n).toFixed(r[3]):"e"===r[4]?n=Number(n).toExponential(r[3]):"r"===r[4]?(n=Number(n).toFixed(+(r[3]||0)),+(r[3]||0)&&(n=n.replace(/\.?0*$/,""))):"d"===r[4]?n=Math.floor(n):"o"===r[4]?n=Math.floor(n).toString(8):"x"===r[4]?n=Math.floor(n).toString(16):"X"===r[4]&&(n=Math.floor(n).toString(16).toUpperCase()),n=n.toString(),""!==r[2]&&"0"!==r[2])for(s="0"===r[2].charAt(0)?"0":" ";n.length<parseInt(r[2],10);)n=r[1]?n+s:s+n;l+=n}return l}function a(t,e,a){return(e+=t.toString()).length<=a?e:e.substring(e.length-a)}function n(t,e,a){return a&&e&&!t.getSeconds()?s("%H:%M",t):a?s("%H:%M:%S",t):e&&t.getSeconds()?s("%#l:%M:%S%P",t):e&&t.getMinutes()?s("%#l:%M%P",t):s(e?"%#l%P":"%I:%M:%S %p",t)}t.json=function(e,a){var n=t(e,a);return!!n&&JSON.parse(n)},t.site=function(e,a,n){return"/"!==siteinfo.base&&(a=siteinfo.base+a),t(e,a,n)},t.site_json=function(e,a){return"/"!==siteinfo.base&&(a=siteinfo.base+a),t.json(e,a)};const r={a:function(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]},A:function(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},d:function(t){return a(t.getDate(),"0",2)},e:function(t,e){return a(t.getDate(),e?"":" ",2)},u:function(t){return t.getDay()||7},w:function(t){return t.getDay()},b:function(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]},B:function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]},h:function(t){return r.b(t)},m:function(t){return a(t.getMonth()+1,"0",2)},y:function(t){return t.getFullYear()%100},Y:function(t){return t.getFullYear()},H:function(t){return a(t.getHours(),"0",2)},k:function(t,e){return a(t.getHours(),e?"":" ",2)},I:function(t){return a(t.getHours()%12||12,"0",2)},l:function(t,e){return a(t.getHours()%12||12,e?"":" ",2)},M:function(t){return a(t.getMinutes(),"0",2)},X:function(t){return s("%#e %b %Y %#q",t)},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t,e){return n(t,e,s.is24)},r:function(t,e){return n(t,e,!1)},R:function(t,e){return n(t,e,!0)},S:function(t){return a(t.getSeconds(),"0",2)},T:function(t){return s("%H:%M:%S",t)},D:function(t){return s("%m/%d/%y",t)},F:function(t){return s("%Y-%m-%d",t)},s:function(t){return Math.floor(t.getTime()/1e3)},n:function(t){return"\n"},t:function(t){return"\t"},"%":function(t){return"%"}};function s(t,e){var a,n,i,s,o=t.split(/(%#?\S)/),l="";for(null==e?e=new Date:"number"==typeof e&&(e=new Date(1e3*e)),a=0;a!=o.length;++a)i="#"==(n=o[a]).charAt(1),"%"==n.charAt(0)&&(s=r[n.charAt(1+i)])?l+=s(e,i):l+=n;return l}window.JSON&&window.JSON.parse||(window.JSON={parse:$.parseJSON}),Element.prototype.closest||(Element.prototype.closest=function(t){return $(this).closest(t)[0]}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.trimStart||(String.prototype.trimStart=function(){return this.replace(/^[\s\uFEFF\xA0]+/,"")});class o{constructor(t){this.value=t}then(t){try{return new o(t(this.value))}catch(t){return Promise.reject(t)}}catch(t){return this}finally(t){try{t()}catch(t){}return this}}function l(t){if("string"==typeof t)return t;if(t){var e,a,n=[];for(e in t)null!=(a=t[e])&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(a));return n.join("&")}return""}function u(t,e,a){if(!1!==t.first&&t.v.length){for(var n=0;n<t.v.length;++n){var i=e.exec(t.v[n]);if(i)return t.pt+=a+i[1]+"/",t.v.splice(n,1),void(t.first=i[1])}t.first=!1}}function d(t,e){if(!1!==t.last&&t.v.length){for(var a=0;a<t.v.length;++a){var n=e.exec(t.v[a]);if(n)return t.t+="/"+n[1],t.v.splice(a,1),void(t.last=n[1])}t.last=!1}}function h(t,e){var a,n,i,r,s="";if(null!=siteinfo.site_relative&&null!=siteinfo.suffix||(siteinfo.site_relative=siteinfo.suffix=""),r={pt:"",t:t+siteinfo.suffix},"string"==typeof e)(i=e.match(/^(.*?)(#.*)$/))&&(e=i[1],s=i[2]),r.v=e.split(/&/);else for(a in r.v=[],e)null==(n=e[a])||("anchor"===a?s="#"+n:r.v.push(encodeURIComponent(a)+"="+encodeURIComponent(n)));return"help"===t?d(r,/^t=(\w+)$/):"api"===t.substr(0,3)?(t.length>3&&(r.t="api"+siteinfo.suffix,r.v.push("fn="+t.substr(4))),u(r,/^u=([^?&#]+)$/,"~"),d(r,/^fn=(\w+)$/),d(r,/^pset=([^?&#]+)$/),d(r,/^commit=([0-9A-Fa-f]+)$/)):"index"===t?u(r,/^u=([^?&#]+)$/,"~"):"pset"!==t&&"run"!==t||(u(r,/^u=([^?&#]+)$/,"~"),d(r,/^pset=([^?&#]+)$/),d(r,/^commit=([0-9A-Fa-f]+)$/)),siteinfo.defaults&&r.v.push(l(siteinfo.defaults)),r.v.length&&(r.t+="?"+r.v.join("&")),siteinfo.site_relative+r.pt+r.t+s}function c(t,e){return e=l(e),h(t,e+=(e?"&":"")+"post="+siteinfo.postvalue)}function p(t,e){var a,n=t.closest(".pa-psetinfo");return e=e||{},a=n.getAttribute("data-pa-user"),e.u=a||peteramati_uservalue,(a=n.getAttribute("data-pa-pset"))&&(e.pset=a),(a=n.getAttribute("data-pa-hash"))&&(e.commit=a),e}function f(){return siteinfo.absolute_base||(siteinfo.absolute_base=function(t,e){var a,n="";if(e=e||window.location.href,!/^\w+:\/\//.test(t)&&(a=e.match(/^(\w+:)/))&&(n=a[1]),n&&!/^\/\//.test(t)&&(a=e.match(/^\w+:(\/\/[^\/]+)/))&&(n+=a[1]),n&&!/^\//.test(t)&&(a=e.match(/^\w+:\/\/[^\/]+(\/[^?#]*)/)))for(n=(n+a[1]).replace(/\/[^\/]+$/,"/");"../"===t.substring(0,3);)n=n.replace(/\/[^\/]*\/$/,"/"),t=t.substring(3);return n+t}(siteinfo.base)),siteinfo.absolute_base}function g(t,e,a){!e&&t instanceof Error?t={error:(e=t).toString()}:"string"==typeof t&&(t={error:t}),e&&e.fileName&&!t.url&&(t.url=e.fileName),e&&e.lineNumber&&!t.lineno&&(t.lineno=e.lineNumber),e&&e.columnNumber&&!t.colno&&(t.colno=e.columnNumber),e&&e.stack&&(t.stack=e.stack),$.ajax(c("api/jserror"),{global:!1,method:"POST",cache:!1,data:t}),e&&!a&&"object"==typeof console&&console.error&&console.error(t.error)}let m,v,b,x,y,w=window.onerror,A=0;window.onerror=function(t,e,a,n,i){if((e||!a)&&++A<=10){var r={error:t,url:e,lineno:a};n&&(r.colno=n),g(r,i,!0)}return!!w&&w.apply(this,arguments)},$(document).ajaxError((function(t,e,a,n){if(4==e.readyState){var i;if(e.responseText&&"{"===e.responseText.charAt(0))try{i=JSON.parse(e.responseText)}catch(t){}if(!i||!i.user_error){var r=url_absolute(a.url)+" API failure: ";siteinfo.user&&siteinfo.user.email&&(r+="user "+siteinfo.user.email+", "),r+=e.status,n&&(r+=", "+n),e.responseText&&(r+=", "+e.responseText.substring(0,100)),g(r)}}})),"classList"in document.createElement("span")&&!/MSIE|rv:11\.0/.test(navigator.userAgent||"")?(m=function(t,e){let a=t.classList;return a&&a.contains(e)},v=function(t,e){t.classList.add(e)},b=function(t,e){t.classList.remove(e)},x=function(t,e,a){t.classList.toggle(e,a)},y=function(t){return t.classList}):(m=function(t,e){return $(t).hasClass(e)},v=function(t,e){$(t).addClass(e)},b=function(t,e){$(t).removeClass(e)},x=function(t,e,a){$(t).toggleClass(e,a)},y=function(t){let e=$.trim(t.className);return""===e?[]:e.split(/\s+/)});let _={};function k(t){let e=t.target;(e&&(m(e,"ui")||m(e,"ui-submit"))||"A"===this.tagName&&m(this,"ui"))&&t.preventDefault();let a=y(this);for(let e=0;e<a.length;++e){let n=_[a[e]];if(n)for(let e=0;e<n.length;++e)n[e].call(this,t)}}function C(t,e,a){return null!=a&&(a=!a),x(t,"hidden",a),e&&$(e).find("span.foldarrow").html(m(t,"hidden")?"&#x25B6;":"&#x25BC;"),!1}k.on=function(t,e){_[t]=_[t]||[],_[t].push(e)},k.trigger=function(t,e){let a=_[t];if(a){"string"==typeof e&&(e=$.Event(e));for(let t=0;t<a.length;++t)e.isImmediatePropagationStopped()||a[t].call(this,e)}},$(document).on("click",".ui, .uic",k),$(document).on("change",".uich",k),$(document).on("keydown",".uikd",k),$(document).on("input",".uii",k),$(document).on("unfold",".ui-unfold",k),$(document).on("mouseup mousedown",".uim",k);const M={Spacebar:" ",Esc:"Escape"},S={9:"Tab",13:"Enter",27:"Escape"},T={9:"Tab",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",20:"CapsLock",27:"Escape",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",91:"OSLeft",92:"OSRight",93:"OSRight",224:"OSLeft",225:"AltRight"},N={Alt:2,AltLeft:2,AltRight:2,CapsLock:2,Control:2,ControlLeft:2,ControlRight:2,Meta:2,OSLeft:2,OSRight:2,Shift:2,ShiftLeft:2,ShiftRight:2,ArrowLeft:1,ArrowRight:1,ArrowUp:1,ArrowDown:1,Backspace:1,Enter:1,Escape:1,PageUp:1,PageDown:1,Tab:1};function j(t){let e;return"string"==typeof t?t:null!=(e=t.key)?M[e]||e:(e=t.charCode)?S[e]||String.fromCharCode(e):(e=t.keyCode)?T[e]?T[e]:e>=48&&e<=57||e>=65&&e<=90?String.fromCharCode(e):void 0:""}function E(t){return(t.shiftKey?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0)+(t.metaKey?8:0)}j.printable=function(t){return!(N[j(t)]||"string"!=typeof t&&(t.ctrlKey||t.metaKey))},j.modifier=function(t){return N[j(t)]>1},j.is_default_a=function(t,e){return!(t.shiftKey||t.metaKey||t.ctrlKey||0!=t.button||e&&hasClass("ui",e))},E.SHIFT=1,E.CTRL=2,E.ALT=4,E.META=8;let L=0,O=[];function I(t){if(void 0===t)return L>0;L>0?after.push(t):t()}$.ajaxPrefilter((function(t,e,a){if(!1!==t.global){var n=t.success;t.error?$.isArray(t.error)?t.error.push(i):t.error=[t.error,i]:t.error=i,null==t.timeout&&(t.timeout=1e4),null==t.dataType&&(t.dataType="json"),t.trackOutstanding&&++L}function i(t,e,a){if(n){var i;if(/application\/json/.test(t.getResponseHeader("Content-Type")||"")&&t.responseText)try{i=JSON.parse(t.responseText)}catch(t){}i&&"object"==typeof i&&!1===i.ok||(i={ok:!1}),i.error||(i.error=function(t,e,a){return"parsererror"===e?"Internal error: bad response from server.":a?a.toString():"timeout"===e?"Connection timed out.":e?"Failed ["+e+"].":"Failed."}(0,e,a)),n(i,t,e)}}})),$(document).ajaxComplete((function(t,e,a){if(a.trackOutstanding&&0==--L)for(;O.length;)O.shift()()}));let D=0,P=[];function R(t,e,a){return new Promise((function(n,i){function r(){++D,$.ajax(t,{data:e,method:a||"POST",cache:!1,dataType:"json",success:function(t){n(t),--D,P.length&&P.shift()()}})}D<5?r():P.push(r)}))}let F,W=null;function H(t,e){return $("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,width:e||t.width(),fontSize:t.css("fontSize"),fontFamily:t.css("fontFamily"),fontWeight:t.css("fontWeight"),lineHeight:t.css("lineHeight"),resize:"none","word-wrap":"break-word",whiteSpace:"pre-wrap"}).appendTo(document.body)}function B(){for(var t=W.length-1;t>=0;--t)W[t]()}function U(t,e){var a=t.data("autogrower");t.removeData("autogrower"),e&&e.remove();for(var n=W.length-1;n>=0;--n)W[n]===a&&(W[n]=W[W.length-1],W.pop())}function z(e){for(var a="string"==typeof e?1:0,n=t.site_json(!1,"list_digests")||[],i=-1,r=(new Date).getTime(),s=0;s<n.length;++s){var o=n[s];o[a]===e?i=s:o[2]<r-3e4?(n.splice(s,1),--s):r<=o[0]&&(r=o[0]+1)}return i>=0?n[i][2]=r:a&&(n.push([r,e,r]),i=n.length-1),t.site(!1,"list_digests",n),i>=0&&n[i][1-a]}function q(t){var e,a;return(a=/^list(\d+)(?=\s|$)/.exec(t))&&(e=z(+a[1]))?e:t}function J(t,e){var a=function(t){var e=z(t);return e?"list"+e:t}(t=q(t));e&&/(?:^|\/)pset(?:|\.php)\//.test(e)&&(a+=function(t,e){var a,n,i=/(?:^|\/)(~[^\/]+)\/pset(?:|\.php)\/([^\/]+)((?:\/[0-9a-f]+)?)(?=[\/?#]|$)/.exec(e);if(i){if((t=JSON.parse(t)).pset){if(t.pset!==i[2])return"";a=n=i[1]}else a=(n=i[1]+"/pset/"+i[2])+i[3];var r=t.items.indexOf(a);if(r<0&&n!==a&&(r=t.items.indexOf(n)),r>=0)return" "+JSON.stringify({cur:i[1]+"/pset/"+i[2],prev:0===r?null:t.items[r-1],next:r===t.items.length-1?null:t.items[r+1]})}return""}(t,e)),F=(new Date).getTime();var n,i="; Max-Age=20";siteinfo.site_relative&&(n=/^[a-z]+:\/\/[^\/]*(\/.*)/.exec(f()))&&(i+="; Path="+n[1]),document.cookie="hotlist-info-"+F+"="+encodeURIComponent(a)+siteinfo.cookie_params+i}function K(t,e){var a,n;if(e&&e.startsWith(siteinfo.site_relative)&&function(t){return/(?:^|\/)pset(?:|\.php)(?:$|\/)/.test(t)}(n=e.substring(siteinfo.site_relative.length))&&(a=t.closest(".has-hotlist"))){var i=a.getAttribute("data-hotlist");if(!i){var r=jQuery.Event("pa-hotlist");$(a).trigger(r),(i=r.hotlist)&&"string"!=typeof i&&(i=JSON.stringify(i))}i&&J(i,n)}}function V(t){var e=location.href;return location.hash&&(e=e.substring(0,e.length-location.hash.length)),this.href.substring(0,e.length+1)===e+"#"||!!I()&&(I(make_link_callback(this)),!0)}$.fn.autogrow=function(){return this.each((function(){var t=$(this),e=t.data("autogrower");b(this,"need-autogrow"),e||("TEXTAREA"===this.tagName?e=function(t){var e,a,n;return function(i){if(!1===i)return U(t,e);var r=t.width();if(!(r<=0)){e||(e=H(t,r),a=t.height(),n=e.text("!").height());var s=t[0].value;i&&"keydown"==i.type&&13===i.keyCode&&(s+="\n"),e.css("width",r).text(s+"...");var o=Math.max($(window).height()-4*n,4*n);t.height(Math.min(o,Math.max(e.height(),a)))}}}(t):"INPUT"===this.tagName&&"text"===this.type&&(e=function(t){var e;return function(a){if(!1===a)return U(t,e);var n,i=0;try{i=t.outerWidth()}catch(t){}if(!(i<=0)){if(!e){e=H(t,i);var r=t.css(["paddingRight","paddingLeft","borderLeftWidth","borderRightWidth"]);e.css({width:"auto",display:"table-cell",paddingLeft:r.paddingLeft,paddingLeft:parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth)+"px"}),"0px"===(n=t.css(["minWidth","maxWidth"])).minWidth&&t.css("minWidth",i+"px"),"none"!==n.maxWidth||t.hasClass("wide")||t.css("maxWidth","640px")}e.text(t[0].value+"  "),n=t.css(["minWidth","maxWidth"]);var s=Math.min(e.outerWidth(),$(window).width()),o=parseFloat(n.maxWidth);o==o&&(s=Math.min(s,o)),t.outerWidth(Math.max(s,parseFloat(n.minWidth)))}}}(t)),e&&(t.data("autogrower",e).on("change input",e),W||(W=[],$(window).resize(B)),W.push(e))),e&&""!==t.val()&&e()})),this},$.fn.unautogrow=function(){return this.each((function(){var t=$(this).data("autogrower");t&&t(!1)})),this},$((function(){$(".need-autogrow").autogrow()})),k.on("js-range-click",(function(t){if("change"!==t.type){var e=$(this).closest("form"),a=e[0].jsRangeClick||{},n=this.getAttribute("data-range-type")||this.name;e[0].jsRangeClick=a;var i=!1;if("keydown"!==t.type||E(t)||(i=j(t)),!(a.__clicking__||"updaterange"===t.type&&a["__update__"+n]||"keydown"===t.type&&"ArrowDown"!==i&&"ArrowUp"!==i)){var r=[],s=[];e.find("input.js-range-click").each((function(){var t=this.getAttribute("data-range-type")||this.name;n===t&&(r.push(this),m(this,"is-range-group")&&s.push(this))}));var o,l,u,d=a[n];for(u=0;u!==r.length;++u)r[u]===this&&(o=u),r[u]===d&&(l=u);if(i)return 0!==o&&"ArrowUp"===i?--o:o<r.length-1&&"ArrowDown"===i&&++o,$(r[o]).focus().scrollIntoView(),void t.preventDefault();var h,c=!1,p=!1;if("click"===t.type){for(a.__clicking__=!0,m(this,"is-range-group")?(u=0,h=r.length-1,c=this.getAttribute("data-range-group")):(a[n]=this,t.shiftKey&&d?l<=o?(u=l,h=o-1):(u=o+1,h=l):(u=1,h=0,p=this.getAttribute("data-range-group")));u<=h;)r[u].checked===this.checked||m(r[u],"is-range-group")||c&&r[u].getAttribute("data-range-group")!==c||$(r[u]).trigger("click"),++u;delete a.__clicking__}else"updaterange"===t.type&&(a["__updated__"+n]=!0);for(h=0;h!==s.length;++h)if(c=s[h].getAttribute("data-range-group"),!p||c===p){var f=null;for(u=0;u!==r.length;++u)if(r[u].getAttribute("data-range-group")===c&&!m(r[u],"is-range-group"))if(null===f)f=r[u].checked;else if(f!==r[u].checked){f=2;break}2===f?(s[h].indeterminate=!0,s[h].checked=!0):(s[h].indeterminate=!1,s[h].checked=f)}}}})),$((function(){$(".is-range-group").each((function(){k.trigger.call(this,"js-range-click","updaterange")}))})),$(document).on("click","a",(function(t){m(this,"ui")||j.is_default_a(t)&&!this.target&&V.call(this,t)||K(this,this.getAttribute("href"))})),$(document).on("submit","form",(function(t){m(this,"ui-submit")?k.call(this,t):K(this,this.getAttribute("action"))})),$(window).on("beforeunload",(function(){var t=document.body.getAttribute("data-hotlist");t&&(!F||F+3<(new Date).getTime())&&J(t,location.href)})),$((function(){$(".has-hotlist").each((function(){var t=this.getAttribute("data-hotlist");t&&t.startsWith("list")&&(t=q(t))&&this.setAttribute("data-hotlist",t)}))}));const X=/[&<>\"']/g,G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Y(t){return null!==t&&"number"!=typeof t?t.replace(X,(function(t){return G[t]})):t}function Q(t){return encodeURIComponent(t).replace(/[^-A-Za-z0-9%]/g,(function(t){return"_"+t.charCodeAt(0).toString(16)})).replace(/%../g,(function(t){return"_"+t.substr(1).toLowerCase()}))}const Z=["Top","Right","Bottom","Left"],tt=["top","right","bottom","left"],et=["height","width"];function at(t,e){return"border"+Z[t]+e}function nt(t){return at(t,"Color")}let it=Math.round;var rt;function st(t){var e,a,n=function(t){return $('<div class="bubble hidden'+t+'"><div class="bubtail bubtail0'+t+'"></div></div>').appendTo(document.body)}(t),i=n.children(),r=[i.width(),i.height()];for(e=0;e<4;++e)r[tt[e]]=0,(a=n.css("margin"+Z[e]))&&(a=parseFloat(a))&&(r[tt[e]]=a);return n.remove(),r}function ot(t,e){!e&&t&&"object"==typeof t?t=(e=t).content:e?"string"==typeof e&&(e={color:e}):e={};var a=null,n=e.dir,i=null,r=e.color?" "+e.color:"",s=$('<div class="bubble'+r+'" style="margin:0"><div class="bubtail bubtail0'+r+'" style="width:0;height:0"></div><div class="bubcontent"></div><div class="bubtail bubtail1'+r+'" style="width:0;height:0"></div></div>')[0];document.body.appendChild(s),e["pointer-events"]&&$(s).css({"pointer-events":e["pointer-events"]});var o=s.childNodes,l=null,u=null;function d(){var t=[0,0,0,0],e=l[1],a=l[0]/2;(u=parseFloat($(s).css(at(i,"Width"))))!=u&&(u=0),t[1^i]=t[3^i]=a+"px",t[2^i]=e+"px",o[0].style.borderWidth=t.join(" "),t[1^i]=t[3^i]=a+"px",t[2^i]=e+"px",o[2].style.borderWidth=t.join(" ");for(var n=1;n<=3;++n)o[0].style[tt[i^n]]=o[2].style[tt[i^n]]="";o[0].style[tt[i]]=-e-u+"px";var r=u/a*Math.sqrt(e*e+a*a);for(o[2].style[tt[i]]=-e-u+r+"px",n=0;n<3;n+=2)o[n].style.borderLeftColor=o[n].style.borderRightColor=o[n].style.borderTopColor=o[n].style.borderBottomColor="transparent";var d,h,c=(d=$(s).css("backgroundColor"),h=d.match(/^rgb\((.*)\)$/),h?"rgba("+h[1]+", 1)":d).replace(/([\d.]+)\)/,(function(t,e){return.75*e+.25+")"}));o[0].style[nt(2^i)]=$(s).css(nt(i)),o[2].style[nt(2^i)]=c}function h(t,e,a,n){var i=t[tt[a]],r=t[tt[2^a]],s=(1-n)*i+n*r;return s=Math.max(s,Math.min(r,e[tt[a]]+8)),Math.min(s,Math.max(i,e[tt[2^a]]-8))}function c(t,e,a,n,i,r){var s=e[tt[n]],o=e[tt[2^n]],u=a[et[1&n]],d=t-i*u;return!r&&d<s+8?d=Math.min(t-l[0],s+8):!r&&d+u>o-8&&(d=Math.max(t+l[0]-u,o-8-u)),d}function p(t,e){var n=Math.max(3===e?0:a.left-t.left,1===e?0:t.right-a.right);return("h"===e||1===e||3===e)&&n>100?Math.min(t.width,n)-24:t.width-24}function f(t,e){var n=$(s);n.css("maxWidth","");var i=n.geometry(!0),r=p(t,e);r<i.width&&(n.css("maxWidth",r),i=n.geometry(!0));var o=[a.top-l.bottom-i.height-l[0],a.right+l.left+i.width+l[0],a.bottom+l.top+i.height+l[0],a.left-l.right-i.width-l[0]];return o.width=i.width,o.height=i.height,o.wconstraint=r,o}function g(t,e,a){var n=p(e,a);return(n<t.wconstraint&&n<t.width||n>t.wconstraint&&t.width>=t.wconstraint)&&(t=f(e,a)),t}function m(t,e){var a;return t.length>e&&(a="0123trblnesw".indexOf(t.charAt(e)))>=0?a%4:-1}function v(t,e){var a,n=$(s).css("border"+t+"Radius");return n?((a=n.indexOf(" "))>-1&&(n=e?n.substring(a+1):n.substring(0,a)),parseFloat(n)):0}function b(t,e,a){var n,i;return 1&a?(n=v(Z[0]+Z[a],1),i=v(Z[2]+Z[a],1)):(n=v(Z[a]+Z[3],1),i=v(Z[a]+Z[1],1)),Math.min(Math.max(t,n),e[et[1&a^1]]-i-l[0])}function x(){l||(l=st(r)),null==n&&(n="r");var t=/!/.test(n),e=/\*/.test(n),u=n.replace(/[^a0-3neswtrblhv]/,""),p=m(u,0),v=m(u,1);v=p>=0&&v>=0&&(1&v)!=(1&p)?1===v||2===v?1:0:.5,p<0&&(p=/^[ahv]$/.test(u)?u:"a");var x=$(window).geometry(),y=f(x,u);"a"===p&&(y.height+l[0]>Math.max(a.top-x.top,x.bottom-a.bottom)?y=g(y,x,p="h"):p="v");var w,A,_,k,C,M=[x.top+24,x.right-24,x.bottom-24,x.left+24];("v"===p||0===p||2===p)&&!t&&v<0&&y[2]>M[2]&&y[0]<M[0]&&(y[3]>=M[3]||y[1]<=M[1])&&(y=g(y,x,p="h")),y=g(y,x,p="v"===p&&y[2]>M[2]&&y[0]>M[0]||0===p&&!t&&y[2]>x.bottom&&x.top-y[0]<y[2]-x.bottom||2===p&&(t||y[0]>=x.top+8)?2:"v"===p||0===p||2===p?0:"h"===p&&y[3]-x.left<x.right-y[1]||1===p&&!t&&y[3]<x.left||3===p&&(t||y[1]<=x.right-8)?3:1),p!==i&&(i=p,d());var S=parseFloat($(s).css(at(1&p?0:3,"Width")));1&p?(A=c(k=h(a,x,0,v),x,y,0,v,e),C=b(it(k-A-l[0]/2-S),y,p),o[0].style.top=o[2].style.top=C+"px",w=1==p?a.left-l.right-y.width-l[1]-1:a.right+l.left+l[1]):(w=c(_=h(a,x,3,v),x,y,3,v,e),C=b(it(_-w-l[0]/2-S),y,p),o[0].style.left=o[2].style.left=C+"px",A=0==p?a.bottom+l.top+l[1]:a.top-l.bottom-y.height-l[1]-1),s.style.left=it(w)+"px",s.style.top=it(A)+"px",s.style.visibility="visible"}function y(){s&&s.parentElement.removeChild(s),s=null}var w={near:function(t,e){var i;for(("string"==typeof t||t.tagName||t.jquery)&&(t=$(t),null==n&&t[0]&&(n=t[0].getAttribute("data-tooltip-dir")),t=t.geometry(!0)),i=0;i<4;++i)!(tt[i]in t)&&tt[2^i]in t&&(t[tt[i]]=t[tt[2^i]]);return e&&(e=$(e))&&e.length&&e[0]!=window&&(t=geometry_translate(t,e.geometry())),a=t,x(),w},at:function(t,e,a){return w.near({top:e,left:t},a)},dir:function(t){return n=t,w},remove:y,color:function(t){return r!==(t=t?" "+t:"")&&(r=t,s.className="bubble"+r,o[0].className="bubtail bubtail0"+r,o[2].className="bubtail bubtail1"+r,i=l=null,a&&x()),w},html:function(t){var e=o[1];if(void 0===t)return e.innerHTML;if("string"==typeof t&&t===e.innerHTML&&"visible"===s.style.visibility)return w;if(a&&$(s).css({maxWidth:"",left:"",top:""}),"string"==typeof t)e.innerHTML=t;else{for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);t&&t.jquery?t.appendTo(e):e.appendChild(t)}return a&&x(),w},text:function(t){return void 0===t?$(o[1]).text():w.html(t?text_to_html(t):t)},content_node:function(){return o[1].firstChild},hover:function(t,e){return $(s).hover(t,e),w},removeOn:function(t,e){return arguments.length>1?$(t).on(e,y):s&&$(s).on(t,y),w},self:function(){return s?$(s):null},outerHTML:function(){return s?s.outerHTML:null}};return t&&w.html(t),w}window.devicePixelRatio&&window.devicePixelRatio>1&&(rt=window.devicePixelRatio,it=function(t){return Math.round(t*rt)/rt});let lt,ut,dt={};function ht(t){if(window.disable_tooltip)return null;var e=$(this);(t=function(t,e){var a=t.getAttribute("data-tooltip-info");return a&&("string"==typeof a&&"{"===a.charAt(0)?a=JSON.parse(a):"string"==typeof a&&(a={builder:a}),e=$.extend(a,e)),e.builder&&dt[e.builder]&&(e=dt[e.builder].call(t,e)||e),(null==e.dir||t.hasAttribute("data-tooltip-dir"))&&(e.dir=t.getAttribute("data-tooltip-dir")||"v"),(null==e.type||t.hasAttribute("data-tooltip-type"))&&(e.type=t.getAttribute("data-tooltip-type")),(null==e.className||t.hasAttribute("data-tooltip-class"))&&(e.className=t.getAttribute("data-tooltip-class")||"dark"),t.hasAttribute("data-tooltip")?e.content=t.getAttribute("data-tooltip"):null==e.content&&t.hasAttribute("aria-label")?e.content=t.getAttribute("aria-label"):null==e.content&&t.hasAttribute("title")&&(e.content=t.getAttribute("title")),e}(e[0],$.extend({},t||{}))).element=this;var a,n=null,i=null,r=null,s=0,o=t.content;function l(){i=clearTimeout(i),n&&n.remove(),e.removeData("tooltipState"),window.global_tooltip===a&&(window.global_tooltip=null)}function u(){o&&!n?(n=ot(o,{color:"tooltip "+t.className,dir:t.dir}),r=t.near||t.element,n.near(r).hover(a.enter,a.exit)):o?n.html(o):n&&(n&&n.remove(),n=r=null)}return a={enter:function(){return i=clearTimeout(i),++s,a},exit:function(){var e="focus"===t.type?0:200;return i=clearTimeout(i),0==--s&&"sticky"!==t.type&&(i=setTimeout(l,e)),a},erase:l,_element:e[0],html:function(t){return void 0===t?o:(o=t,u(),a)},text:function(t){return a.html(escape_entities(t))},near:function(){return r}},function n(i){if(i instanceof Promise)i.then(n);else{var r=window.global_tooltip;o=i,r&&r._element===t.element&&r.html()===o&&!t.done?a=r:(r&&r.erase(),e.data("tooltipState",a),u(),window.global_tooltip=a)}}(o),t.done=!0,a}function ct(){var t=$(this).data("tooltipState")||ht.call(this);t&&t.enter()}function pt(){var t=$(this).data("tooltipState");t&&t.exit()}function ft(){b(this,"need-tooltip"),"focus"===this.getAttribute("data-tooltip-type")?$(this).on("focus",ct).on("blur",pt):$(this).hover(ct,pt)}function gt(t){return t.closest(".pa-filediff")||document.getElementById(t.closest(".pa-fileref").getAttribute("data-pa-fileid"))}function mt(t){if(m(t,"need-load")){let e=t.closest(".pa-psetinfo");return new Promise((function(a,n){var i;$.ajax(h("api/filediff",p(t)),{type:"GET",cache:!1,dataType:"json",data:{file:(i=t.id.substr(8),decodeURIComponent(i.replace(/_/g,"%"))),base_hash:e.getAttribute("data-pa-base-hash"),hash:e.getAttribute("data-pa-hash")},success:function(e){if(e.ok&&e.content_html){var n=$(e.content_html);$(t).html(n.html())}b(t,"need-load"),a(t)}})}))}return new o(t)}function vt(t,e){if(null==e){t instanceof Node&&(t=t.hash);var a=t.match(/^#?L([ab]\d+)_(.*)$/);if(!a)return Promise.reject(null);t=a[2],e=a[1]}else{if(t instanceof Node){for(var n=t;n&&!n.hasAttribute("data-pa-file");)n=n.parentElement;if(!n)return Promise.reject(null);t=n.getAttribute("data-pa-file"),n.hasAttribute("data-pa-file-user")&&(t=n.getAttribute("data-pa-file-user")+"-"+t)}t=Q(t)}var i="L"+e+"_"+t,r=document.getElementById(i);if(r)return new o(r);var s=document.getElementById("pa-file-"+t);return s?mt(s).then((t=>{const a=$(s).find(".pa-d"+e.charAt(0)),n=e.substr(1);for(let t=0;t<a.length;++t)if(a[t].getAttribute("data-landmark")===n)return a[t].id=i,a[t];const r=$(s).find(".pa-dl[data-landmark='"+e+"']");if(r.length)return r[0];throw null})):Promise.reject(null)}function bt(t,e){var a=null;return vt(t,e).then((t=>a=t),null),a}function yt(t,e,a){var n,i=(t=t.closest(".pa-dl, .pa-dg, .pa-filediff"))?t.parentElement:null;for(null==e?(e=!1,n="previousSibling"):(n=e?"nextSibling":"previousSibling",m(t,"pa-dl")&&(t=t[n]));;){for(;!t&&i;){if(1&a&&m(i,"pa-filediff"))return null;t=i[n],i=i.parentElement}if(!t)return null;if(t.nodeType!==Node.ELEMENT_NODE)t=t[n];else{if(m(t,"pa-dl")&&(2&a||/ pa-g[idc]/.test(t.className))&&t.offsetParent)return t;t=m(t,"pa-dg")||m(t,"pa-filediff")?(i=t)[e?"firstChild":"lastChild"]:t[n]}}}function wt(t,e){if(!t||"TEXTAREA"===t.tagName||"A"===t.tagName)return null;var a,n=t.closest(".pa-dl"),i=yt(t,e,1);if(!i||!(a=i.closest(".pa-filediff")))return null;var r,s=a.getAttribute("data-pa-file"),o={ufile:s,file:s,tr:i},l=a.getAttribute("data-pa-file-user");if(l&&(o.ufile=l+"-"+s),n&&(r=n.getAttribute("data-landmark"))&&/^[ab]\d+$/.test(r)?(o[r.charAt(0)+"line"]=+r.substring(1),o.lineid=r):(o.aline=+i.firstChild.getAttribute("data-landmark"),o.bline=+i.firstChild.nextSibling.getAttribute("data-landmark"),o.lineid=o.bline?"b"+o.bline:"a"+o.aline),n&&m(n,"pa-gw"))o.notetr=n;else{do{i=i.nextSibling}while(i&&(i.nodeType!==Node.ELEMENT_NODE||m(i,"pa-gn")||!i.offsetParent));i&&m(i,"pa-gw")&&(o.notetr=i)}return o}function At(t,e){var a,n=e.length?e.join("").concat(t):t,i=t.match(/<[^>]*>/g);if(i)for(a=0;a!==i.length;++a)"/"===i[a].charAt(1)?e.pop():e.push(i[a]);for(a=e.length-1;a>=0;--a){var r=e[a].indexOf(" ");n=n.concat("</",e[a].substr(1,r<0?-1:r-1),">")}return n}function _t(t){return t[0]+1===t[1]?String(t[1]):t[0]+1+"-"+t[1]}function $t(t,e,a,n,i){var r=t[e];return r.map&&0===r.level&&r.attrSet("data-landmark",_t(r.map)),i.renderToken(t,e,a,n)}function kt(t,e,a,n,i){var r=t[e];return r.map&&r.level<=1&&r.attrSet("data-landmark",_t(r.map)),i.renderToken(t,e,a,n)}function Ct(t,e){if(e.map&&0===e.level){var a=' data-landmark="'+_t(e.map)+'"',n=t.indexOf(" "),i=t.indexOf(">");n>0&&n<i&&(i=n),t=t.substring(0,i)+a+t.substring(i)}return t}function Mt(t){return t?function(e,a,n,i,r){var s=e[a];return Ct(t(e,a,n,i,r),s)}:$t}function St(){if(!lt){for(var t of(lt=markdownit().use(markdownit_katex),["paragraph_open","heading_open","ordered_list_open","bullet_list_open","table_open","blockquote_open","hr"]))lt.renderer.rules[t]=Mt(lt.renderer.rules[t]);lt.renderer.rules.fence=lt.renderer.rules.code_block=function(t){return function(e,a,n,i,r){var s,o,l,u,d,h=e[a],c=h,p=h.info?t.utils.unescapeAll(h.info):"",f=!1;if(p&&p.indexOf(" ")>=0&&((d=p.match(/^ *([-a-z+]+) *$/))?p=d[1]:(h.content=p+"\n"+h.content,h.map&&(h.map[0]-=1),p="")),(s=p?p.trim().split(/\s+/g)[0]:"")&&hljs.getLanguage(s))try{o=hljs.highlight(s,h.content,!0).value,f=!0}catch(t){}if(f||(o=t.utils.escapeHtml(h.content)),p&&(l=h.attrIndex("class"),c={attrs:h.attrs?h.attrs.slice():[]},l<0?c.attrs.push(["class",n.langPrefix+s]):c.attrs[l][1]+=" "+n.langPrefix+s),u="><code".concat(r.renderAttrs(c),">"),h.map&&0===h.level){var g=o.split(/\n/),m=[],v=h.map[0]+2;""===g[g.length-1]&&g.pop();var b=g.length;if(f){var x=[];for(l=0;l!==b;++l)m.push('<pre data-landmark="',v+l,l+1!==b?'" class="partial"':'"',u,At(g[l],x),"\n</code></pre>")}else for(l=0;l!==b;++l)m.push('<pre data-landmark="',v+l,l+1!==b?'" class="partial"':'"',u,g[l],"\n</code></pre>");return m.join("")}return"<pre".concat(u,o,"</code></pre>")}}(lt),lt.renderer.rules.image=function(t){function e(t,e){return siteinfo.site_relative+"~"+encodeURIComponent(peteramati_uservalue)+"/raw/"+t.getAttribute("data-pa-pset")+"/"+t.getAttribute("data-pa-hash")+"/"+e}return function(a,n,i,r,s){var o,l,u,d=a[n],h=d.attrIndex("src"),c=d.attrs[h][1];if(peteramati_uservalue&&ut&&(o=ut.closest(".pa-psetinfo"))){if(!/\/\//.test(c)){for(var p=ut.closest(".pa-filediff"),f=p&&p.hasAttribute("data-pa-file")?p.getAttribute("data-pa-file").replace(/^(.*)\/[^\/]*$/,"$1"):"";;)if(c.startsWith("./"))c=c.substring(2).replace(/^\/+/,"");else if(c.startsWith("../")&&""!==f)c=c.substring(3).replace(/^\/+/,""),f=f.replace(/(?:^|\/)[^\/]+\/*$/,"");else{if(c.startsWith("../")||c.startsWith("/")){c=null;break}if(!(l=c.match(/(^|\/+)[^\/]+\/\.\.(?:\/+|$)(.*)$/)))break;c=l[1]+l[2]}d.attrs[h][1]=c?e(o,f?f+"/"+c:c):"data:image/jpg,"}(l=c.match(/^https:\/\/github\.com\/([^\/]+\/[^\/]+)\/(?:blob|raw)\/([^\/]+)\/(.*)$/))&&(u=(o.getAttribute("data-pa-repourl")||"").match(/^(?:https:\/\/github\.com\/|git@github\.com:)(.*?)\/?$/))&&u[1]==l[1]&&o.getAttribute("data-pa-branch")==l[2]&&(d.attrs[h][1]=e(o,l[3]))}return Ct(t(a,n,i,r,s),d)}}(lt.renderer.rules.image),lt.renderer.rules.list_item_open=kt}return lt}function Tt(t){for(var e;(e=t.firstChild)&&1!==e.nodeType;)t.removeChild(e);if(e&&e.hasAttribute("data-landmark")){for(;e.nextSibling&&1!==e.nextSibling.nodeType;)t.removeChild(e.nextSibling);if(e.nextSibling){"OL"===t.tagName&&(e.hasAttribute("value")||(e.value=t.start),t.start=e.value+1);var a=document.createElement(t.tagName);a.appendChild(t.removeChild(e)),t=a}t.setAttribute("data-landmark",e.getAttribute("data-landmark"))}return t}function Nt(){if(!m(this,"pa-markdown")&&!m(this,"pa-highlight")){for(var t,e=this.firstChild,a=[],n=1;e;){var i=e.nextSibling;if(m(e,"pa-gr"))this.removeChild(e);else if(m(e,"pa-gi")||m(e,"pa-gc")){for(t=+e.firstChild.nextSibling.getAttribute("data-landmark");n<t;)a.push("\n"),++n;a.push(e.lastChild.textContent),m(e.lastChild,"pa-dnonl")||a.push("\n"),++n,v(e,"hidden")}e=i}var r,s=document.createElement("div");for(ut=this,s.innerHTML=St().render(a.join("")),ut=null,e=this.firstChild;r=s.firstChild;)if(1===r.nodeType){"OL"===r.tagName||"UL"===r.tagName?r=Tt(r):"P"===r.tagName&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName&&r.firstChild===r.lastChild&&v(r,"image-container");var o=document.createElement("div");o.className="pa-dl pa-gr";var l=document.createElement("div");l.className="pa-da";var u=document.createElement("div");u.className="pa-db";var d=r.getAttribute("data-landmark");if(d){for(var h=parseInt(d),c=d.indexOf("-"),p=c>=0?parseInt(d.substring(c+1)):h;e&&!((m(e,"pa-gi")||m(e,"pa-gc"))&&+e.firstChild.nextSibling.getAttribute("data-landmark")>=h);)e=e.nextSibling;u.setAttribute("data-landmark",h);for(var f=0,g=e;g;){if(m(g,"pa-gi")||m(g,"pa-gc")){if(+g.firstChild.nextSibling.getAttribute("data-landmark")>=p)break;f|=m(g,"pa-gi")?1:2}g=g.nextSibling}o.className+=2===f?" pa-gc":" pa-gi"}var b=document.createElement("div");for(b.className="pa-dr",r===s.firstChild&&s.removeChild(r),b.appendChild(r);s.firstChild&&1!==s.firstChild.nodeType;)b.appendChild(s.removeChild(s.firstChild));o.appendChild(l),o.appendChild(u),o.appendChild(b),this.insertBefore(o,e)}else s.removeChild(r);v(this,"pa-markdown")}}function jt(){for(var t=this.firstChild;t;){var e=t.nextSibling;m(t,"pa-gr")?this.removeChild(t):(m(t,"pa-gi")||m(t,"pa-gc"))&&b(t,"hidden"),t=e}b(this,"pa-markdown")}function Et(){var t,e=this.getAttribute("data-pa-file");if((t=this.getAttribute("data-language"))||(/\.(?:cc|cpp|hh|hpp|c\+\+|h\+\+|C|H)$/.test(e)?t="c++":/\.(?:c|h)$/.test(e)&&(t="c"),t&&this.setAttribute("data-language",t)),t&&hljs.getLanguage(t)&&!m(this,"pa-highlight")&&!m(this,"pa-markdown")){for(var a,n,i=this.firstChild,r=[],s=1;i;){if(m(i,"pa-gi")||m(i,"pa-gc")){for(a=+i.firstChild.nextSibling.getAttribute("data-landmark");s<a;)r.push("\n"),++s;r.push(i.lastChild.textContent),m(i.lastChild,"pa-dnonl")||r.push("\n"),++s}i=i.nextSibling}try{n=hljs.highlight(t,r.join(""),!0).value.split("\n")}catch(t){return}i=this.firstChild;for(var o=[],l="language-"+t;i;){if(m(i,"pa-gi")||m(i,"pa-gc")){a=+i.firstChild.nextSibling.getAttribute("data-landmark");var u=i.lastChild;u.setAttribute("data-pa-text",u.textContent),u.innerHTML=At(n[a-1],o),v(u,l)}i=i.nextSibling}v(this,"pa-highlight")}}ft.erase=function(){var t=this===ft?window.global_tooltip:$(this).data("tooltipState");t&&t.erase()},ft.add_builder=function(t,e){dt[t]=e},$((function(){$(".need-tooltip").each(ft)})),k.on("js-repo-copy",(function(){var t=document.createTextNode(this.getAttribute("data-pa-repo")),e=ot(t,{color:"tooltip",dir:"t"});e.near(this);var a=document.createRange();a.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(a);try{document.execCommand("copy")}catch(t){}window.getSelection().removeAllRanges(),e.remove(),global_tooltip&&global_tooltip.elt==this&&global_tooltip.text(this.getAttribute("data-pa-repo"))})),k.on("js-repo-list",(function(t){var e=this;$.ajax(h("api",{fn:"repositories",u:this.getAttribute("data-pa-user")}),{method:"POST",cache:!1,success:function(t){var a="Error loading repositories";if(t.repositories&&t.repositories.length){a="Repositories: ";for(var n=0;n<t.repositories.length;++n){var i=t.repositories[n];n&&(a+=", "),a+='<a href="'+Y(i.url)+'">'+Y(i.name)+"</a>"}}else t.repositories&&(a="No repositories");$('<div style="font-size:medium;font-weight:normal"></div>').html(a).insertAfter(e)}}),t.preventDefault()})),k.on("js-pset-viewoptions",(function(){C(this.nextSibling,this.parentNode)})),k.on("js-pset-setgrader",(function(){var t=$(this.closest("form"));$.ajax(t[0].getAttribute("action"),{data:t.serializeWith({}),type:"POST",cache:!1,dataType:"json",success:function(e){var a;t.find(".ajaxsave61").html(e.ok?"Saved":"<span class='error'>Error: "+e.error+"</span>"),e.ok&&(a=t.find("a.actas")).length&&a.attr("href",a.attr("href").replace(/actas=[^&;]+/,"actas="+encodeURIComponent(e.grader_email)))},error:function(){t.find(".ajaxsave61").html("<span class='error'>Failed</span>")}})})),k.on("js-pset-setcommit",(function(){this.closest("form").submit()})),k.on("js-pset-flag",(function(){var t=$(this),e=t.closest("form");"flag"!=this.name||e.find("[name=flagreason]").length?"flag"==this.name?$.ajax(e.attr("action"),{data:e.serializeWith({flag:1}),type:"POST",cache:!1,dataType:"json",success:function(a){a&&a.ok&&(e.find(".flagreason").remove(),t.replaceWith("<strong>Flagged</strong>"))},error:function(){e.find(".ajaxsave61").html("<span class='error'>Failed</span>")}}):"resolveflag"==this.name&&$.ajax(e.attr("action"),{data:e.serializeWith({resolveflag:1,flagid:t.attr("data-flagid")}),type:"POST",cache:!1,dataType:"json",success:function(e){e&&e.ok&&t.replaceWith("<strong>Resolved</strong>")},error:function(){e.find(".ajaxsave61").html("<span class='error'>Failed</span>")}}):(t.before('<span class="flagreason">Why do you want to flag this commit? &nbsp;<input type="text" name="flagreason" value="" placeholder="Optional reason" /> &nbsp;</span>'),e.find("[name=flagreason]").on("keypress",(function(e){E(e)||"Enter"!==j(e)||(e.preventDefault(),e.stopImmediatePropagation(),t.click())})).autogrow()[0].focus(),t.html("OK"))})),k.on("pa-diff-unfold",(function(t){return t.metaKey?$(".pa-diff-unfold").each((function(){C(gt(this),this,!1)})):mt(gt(this)).then((t=>C(t,this))),!1})),k.on("pa-diff-toggle-hide-left",(function(t){var e=gt(this),a=m(e,"pa-hide-left");t.metaKey?$(".pa-diff-toggle-hide-left").each((function(){x(gt(this),"pa-hide-left",!a),x(this,"btn-primary",a)})):(x(e,"pa-hide-left",!a),x(this,"btn-primary",a))})),k.on("pa-goto",(function(){$(".pa-line-highlight").removeClass("pa-line-highlight"),vt(this,null).then((t=>{$(t).closest(".pa-filediff").removeClass("hidden");let e=$(t).closest(".pa-dl");e.addClass("pa-line-highlight"),window.scrollTo(0,Math.max(e.geometry().top-Math.max(.1*window.innerHeight,24),0)),push_history_state(this.href)}),null)})),k.on("pa-diff-toggle-markdown",(function(t){var e=gt(this),a=!m(e,"pa-markdown");t.metaKey?$(".pa-diff-toggle-markdown").each((function(){var t=gt(this),e=m(t,"pa-markdown");a&&!e?Nt.call(t):!a&&e&&jt.call(t),x(this,"btn-primary",a)})):((a?Nt:jt).call(e),x(this,"btn-primary",a))})),$((function(){$(".pa-filediff.need-highlight:not(.need-load)").each(Et)})),k.on("pa-gx",(function(t){for(var e=t.currentTarget,a=wt(e,!1);a&&!a.bline;)a=wt(a.tr,!1);var n=wt(e,!0);if(a||n){var i=a?a.aline+1:1,r=a?a.bline+1:1,s=n?n.bline:0;if(!(n&&n.aline<=1)){var o={file:(a||n).file,fromline:r};return s&&(o.linecount=s-r),$.ajax(h("api/blob",p(this,o)),{success:function(t){if(t.ok&&t.data){for(var a=t.data.replace(/\n$/,"").split("\n"),n=a.length-1;n>=0;--n){$('<div class="pa-dl pa-gc"><div class="pa-da" data-landmark="'+(i+n)+'"></div><div class="pa-db" data-landmark="'+(r+n)+'"></div><div class="pa-dd"></div></div>').insertAfter(e).find(".pa-dd").text(a[n])}$(e).remove()}}}),!0}}}));let Lt=0;const Ot={0:{format:0,render:It}};function It(t){return Y(t).replace(/((?:https?|ftp):\/\/(?:[^\s<>\"&]|&amp;)*[^\s<>\"().,:;&])([\"().,:;]*)(?=[\s<>&]|$)/g,(function(t,e,a){return'<a href="'+e+'" rel="noreferrer">'+e+"</a>"+a}))}function Dt(t){var e,a;return t&&((e=Ot[t])||"string"==typeof t&&(a=t.indexOf("."))>0&&(e=Ot[t.substring(0,a)]))?e:(null==t&&(t=Lt),Ot[t]||Ot[0])}function Pt(t,e,a){var n=Dt(t);if(n.format)try{var i=e&&n.render_inline||n.render;return{format:n.formatClass||n.format,content:i.apply(this,a)}}catch(t){g("do_render format "+n.format+": "+t.toString(),t)}return{format:0,content:It(a[0])}}function Rt(t,e){var a,n=[e];for(a=2;a<arguments.length;++a)n.push(arguments[a]);return Pt.call(this,t,!1,n)}function Ft(t,e){var a,n=[e];for(a=2;a<arguments.length;++a)n.push(arguments[a]);return Pt.call(this,t,!0,n)}function Wt(){var t,e,a=$(this),n=this.getAttribute("data-format"),i=this.getAttribute("data-content")||a.text(),r=null;if((e=n.indexOf("."))>0){var s=n.split(/\./);for(n=s[0],r={},e=1;e<s.length;++e)r[s[e]]=!0}(t="DIV"==this.tagName?Rt.call(this,n,i,r):Ft.call(this,n,i,r)).format&&a.html(t.content);var o=$.trim(this.className.replace(/(?:^| )(?:need-format|format\d+)(?= |$)/g," "));this.className=o+(o?" format":"format")+(t.format||0),t.format&&a.trigger("renderText",t)}function Ht(t,e){if(e&&hljs.getLanguage(e))try{return hljs.highlight(e,t,!0).value}catch(t){}return""}let Bt;$.extend(Rt,{add_format:function(t){t.format&&(Ot[t.format]=t)},format:function(t){return Dt(t)},set_default_format:function(t){Lt=t},inline:Ft,on:Wt,on_page:function(){$(".need-format").each(Wt)}}),Rt.add_format({format:1,render:function(t){return Bt||(Bt=window.markdownit({highlight:Ht}).use(markdownit_katex)),Bt.render(t)}}),$(Rt.on_page);const Ut={0:!1,1:{b:!0},2:{f:!0},3:{i:!0},4:{u:!0},5:{bl:!0},7:{rv:!0},8:{x:!0},9:{s:!0},21:{du:!0},22:{b:!1,f:!1},23:{i:!1},24:{u:!1},25:{bl:!1},27:{rv:!1},28:{x:!1},29:{s:!1},30:{fg:0},31:{fg:1},32:{fg:2},33:{fg:3},34:{fg:4},35:{fg:5},36:{fg:6},37:{fg:7},38:"fg",39:{fg:!1},40:{bg:0},41:{bg:1},42:{bg:2},43:{bg:3},44:{bg:4},45:{bg:5},46:{bg:6},47:{bg:7},48:"bg",49:{bg:!1},90:{fg:8},91:{fg:9},92:{fg:10},93:{fg:11},94:{fg:12},95:{fg:13},96:{fg:14},97:{fg:15},100:{bg:8},101:{bg:9},102:{bg:10},103:{bg:11},104:{bg:12},105:{bg:13},106:{bg:14},107:{bg:15}},zt={b:1,f:2,i:3,u:4,bl:5,rv:7,x:8,s:9,du:21};function qt(t,e){var a;if(1===arguments.length&&(e=t,t=null),!e||"[m"===e||"[0m"===e)return null;a=""===e.charAt(0)?e.substring(2,e.length-1).split(";"):e.split(";");for(var n=0;n<a.length;++n){var i=Ut[parseInt(a[n])];if(!1===i)t=null;else if(i){if("object"==typeof i)for(var r in i)!1!==i[r]?(t=t||{})[r]=i[r]:t&&delete t[r];else if("fg"===i||"bg"===i){var s,o,l;if(t=t||{},n+4<a.length&&2===parseInt(a[n+1]))s=parseInt(a[n+2]),o=parseInt(a[n+3]),l=parseInt(a[n+4]),s<=255&&o<=255&&l<=255&&(t[i]=[s,o,l]);else if(n+2<a.length&&5===parseInt(a[n+1])){var u=parseInt(a[n+1]);u<=15?t[i]=u:u<=231?(s=(u-16-(l=(u-16)%6)-6*(o=(u-16-l)/6%6))/36,t[i]=[51*s,51*o,51*l]):u<=255&&(l=Math.round(255*(u-232)/23),t[i]=[l,l,l])}}}else;}return t&&$.isEmptyObject(t)?null:t}function Jt(t){return $(".pa-filediff").filter((function(){return this.getAttribute("data-pa-file")===t}))}function Kt(t,a,n){var i=!1;if("string"==typeof t&&(n=a,a=t,t=document.createElement("div"),i=!0),n&&n.clear)for(t.removeAttribute("data-pa-terminal-style"),t.removeAttribute("data-pa-outputpart");t.firstChild;)t.removeChild(t.firstChild);var r,s,o=t.getAttribute("data-pa-terminal-style"),l=null;function u(t,a){t.appendChild(function(t,a){if("string"==typeof t?t=document.createTextNode(t):t instanceof jQuery&&(t=t[0]),!a||"[m"===a||"string"==typeof a&&!(a=qt(a)))return t;var n=document.createElement("span"),i=[];for(var r in zt)a[r]&&i.push("ansi"+r);return a.fg&&("number"==typeof a.fg?i.push("ansifg"+a.fg):n.styles.foregroundColor=e("#%02x%02x%02x",a.fg[0],a.fg[1],a.fg[2])),a.bg&&("number"==typeof a.bg?i.push("ansibg"+a.bg):n.styles.backgroundColor=e("#%02x%02x%02x",a.bg[0],a.bg[1],a.bg[2])),i.length&&(n.className=i.join(" ")),n.appendChild(t),n}(a,o))}function d(t){l||(l=document.createDocumentFragment()),l.appendChild(t)}function h(t,e){return/^\x1b\[[\d;]*m$/.test(e)?function(t){if(!t)return"[m";var e=[];for(var a in zt)t[a]&&e.push(zt[a]);return t.fg&&("number"==typeof t.fg?e.push(t.fg<8?30+t.fg:90+t.fg-8):e.push(38,2,t.fg[0],t.fg[1],t.fg[2])),t.bg&&("number"==typeof t.bg?e.push(t.bg<8?40+t.bg:100+t.bg-8):e.push(48,2,t.bg[0],t.bg[1],t.bg[2])),"["+e.join(";")+"m"}(qt(qt(null,t),e)):t}function c(t,e){return""!==t&&t.charAt(t.length-1)===e}function p(t,e){var a,i,r=!e,s=0;for(r&&(e=document.createElement("span")),/\r/.test(t)&&(t=function(t){var e=/\n$/.test(t);if(e&&t.indexOf("\r")===t.length-1)return t.substring(0,t.length-2)+"\n";var a,n=o||"[m",i=(e?t.substr(0,t.length-1):t).split(/\r/),r=[];for(a=0;a<i.length;++a){for(var s=[],l=0,u=null,d=i[a].split(/(\x1b\[[\d;]*m|\x1b\[0?K)/),p=0;p<d.length;p+=2)""!==d[p]&&(s.push(n,d[p]),l+=d[p].length),p+1<d.length&&(c(d[p+1],"K")?u=l:n=h(n,d[p+1]));for(var f=0;f<r.length&&l>=r[f+1].length;)l-=r[f+1].length,f+=2;for(;f<r.length&&l<r[f+1].length&&null===u;)s.push(r[f],r[f+1].substr(l)),l=0,f+=2;r=s}return r.push(n),e&&r.push("\n"),r.join("")}(t));a=t.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=h(o,a[1]),t=a[2];for(((a=t.match(/^([ \t]*)([^:\s]+):(\d+)(?=:)/))||(a=t.match(/^([ \t]*)file \"(.*?)\", line (\d+)/i)))&&function(t,e,a,i,r){for(var s;s=a.match(/^(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/);)o=h(o,s[1]),a=s[2];var l=Jt(a);if(!l.length&&n&&n.directory&&(l=Jt(a=n.directory+a)),l.length){e.length&&u(t,e);var d="Lb"+i+"_"+Q(a),c=$('<a href="#'+d+'" class="uu uic pa-goto"></a>');return c.text(r.substring(e.length).replace(/(?:\x1b\[[\d;]*m|\x1b\[\d*K)/g,"")),u(t,c),!0}return!1}(e,a[1],a[2],a[3],a[0])&&(s=a[0].length,t=t.substr(s));""!==t;){if(i=t,a=t.match(/^(.*?)(\x1b\[[\d;]*m|\x1b\[\d*K)([^]*)$/)){if(""===a[1]){o=h(o,a[2]),t=a[3];continue}i=a[1]}s+i.length>133||s+i.length==133&&"\n"!==i.charAt(132)?(u(e,i=i.substr(0,132-s)),e.className="pa-rl-continues",r&&d(e),e=document.createElement("span"),r=!0,s=0):(u(e,i),s+=i.length),t=t.substr(i.length)}r&&d(e)}"string"==typeof a?((r=a.split(/^/m)).length&&""===r[r.length-1]&&r.pop(),s=r.length&&c(r[r.length-1],"\n")):(r=[],s=!0,l=a);var f=t.lastChild,g=null;if(f&&f.lastChild&&m(f.lastChild,"pa-runcursor")&&(g=f.lastChild,f.removeChild(g)),f&&null!==(a=f.getAttribute("data-pa-outputpart"))&&""!==a&&r.length){for(;f.firstChild;)f.removeChild(f.firstChild);r[0]=a+r[0],f.removeAttribute("data-pa-outputpart")}else f&&(r.length||l)&&(f.appendChild(document.createTextNode("\n")),f.removeAttribute("data-pa-outputpart")),f=null;var v,b,x,y=o;for(v=0;v<r.length;v=b){for(y=o,x=r[v],b=v+1;!c(x,"\n")&&b<r.length;++b)x+=r[b];b==r.length&&s&&(x=x.substring(0,x.length-1)),p(x,v?null:f)}n&&n.cursor&&!t.lastChild&&!l&&d(""),l&&t.appendChild(l);var w=t.childNodes.length;if(w>=4e3){for(v=t.firstChild;"DIV"===v.tagName&&"pa-rl-group"===v.className;)v=v.nextSibling,--w;for(var A=null,_=0;v&&(b=v.nextSibling);)(!A||_>=4e3&&w>=2e3)&&((A=document.createElement("div")).className="pa-rl-group",t.insertBefore(A,v),_=0),t.removeChild(v),A.appendChild(v),v=b,++_,--w}if(n&&n.cursor&&(g||((g=document.createElement("span")).className="pa-runcursor"),t.lastChild.appendChild(g)),!s&&t.lastChild&&(o=y,t.lastChild.setAttribute("data-pa-outputpart",x)),null!=o?t.setAttribute("data-pa-terminal-style",o):t.removeAttribute("data-pa-terminal-style"),i)return t.innerHTML}function Vt(){var t=this.closest(".pa-psetinfo");R(h("api/grade",p(t)),null,"GET").then((function(e){e&&e.ok&&$(t).data("pa-gradeinfo",e).each($pa.loadgrades)}))}function Xt(a,n){var i,r,o,l,u,d,h=$(a).closest("form"),c=a.getAttribute("data-pa-run-category")||a.value,p=$(a).closest(".pa-psetinfo").attr("data-pa-directory"),f=document.getElementById("pa-run-"+c),g=$(f).find("pre");if("object"!=typeof n&&(n={}),n.unfold&&f.dataset.paTimestamp)r=+f.dataset.paTimestamp;else{if(h.prop("outstanding"))return!0;h.find("button").prop("disabled",!0),h.prop("outstanding",!0)}function x(){i||!m(f,"pa-run-short")&&!f.hasAttribute("data-pa-runbottom")||requestAnimationFrame((function(){f.scrollHeight>f.clientHeight&&b(f,"pa-run-short"),f.hasAttribute("data-pa-runbottom")&&(f.scrollTop=Math.max(f.scrollHeight-f.clientHeight,0))}))}delete f.dataset.paTimestamp,C(f,jQuery("#pa-runout-"+c).removeClass("hidden"),!0),r||n.noclear?f.lastChild&&$(f.lastChild).find("span.pa-runcursor").remove():(g.html(""),v(g[0].parentElement,"pa-run-short"),g[0].removeAttribute("data-pa-terminal-style"),$(f).children(".pa-runrange").remove()),f.dataset.paXtermJs&&"false"!==f.dataset.paXtermJs&&window.Terminal&&(b(g[0].parentElement,"pa-run-short"),v(g[0].parentElement,"pa-run-xterm-js"),(i=new Terminal({cols:(o=80,l=132,u=$('<span style="position:absolute">0</span>').appendTo(g),d=Math.trunc(g.width()/u.width()/1.33),u.remove(),Math.max(o,Math.min(d,l))),rows:25})).open(g[0]),i.attachCustomKeyEventHandler((function(t){if("keydown"===t.type){var e=j(t),a=E(t);"Enter"!==e||a?"Escape"!==e||a?"Backspace"!==e||a?e>="a"&&e<="z"&&(14&a)===E.CTRL?e=String.fromCharCode(e.charCodeAt(0)-96):1===e.length&&0==(14&a)&&j.printable(t)||(e=""):e="\b":e="":e="\r",""!==e&&P({write:e})}return!1}))),f.hasAttribute("data-pa-opened")||(f.setAttribute("data-pa-opened","true"),i||(f.setAttribute("data-pa-runbottom","true"),f.addEventListener("scroll",(function(){requestAnimationFrame((function(){f.scrollTop+f.clientHeight>=f.scrollHeight-10?f.setAttribute("data-pa-runbottom","true"):f.removeAttribute("data-pa-runbottom")}))})),x()));var y="",w=-1,A=50,_=null,k=null;function M(){i?i.write("[?25l"):f.lastChild&&$(f.lastChild).find(".pa-runcursor").remove()}function S(){h.find("button").prop("disabled",!1),h.prop("outstanding",!1),M(),a.hasAttribute("data-pa-run-grade")&&Vt.call(a.closest(".pa-psetinfo"))}function T(t){i?i.write(t):Kt(g[0],t,{cursor:!0,directory:p})}function N(t){"string"==typeof t&&(t=$(t)[0]),i?window.console&&console.log("xterm.js cannot render "+t):Kt(g[0],t,{cursor:!0})}function L(t,e){if(null!==y){var a=(y+=t).indexOf("\n\n");if(a<0)return;t=y.substr(a+2),y=null;var r="";e&&e.timestamp&&(r="...started "+s("%l:%M:%S%P %e %b %Y",new Date(1e3*e.timestamp))),i?(""!==r&&(r="[3;1;38;5;86m"+r+"[m\r\n"),n.noclear||(r="c"+r),t=r+t):(n.noclear||g.html(""),""!==r&&N('<span class="pa-runtime">'+r+"</span>"))}""!==t&&T(t)}function O(a,n){var i,r,s,o,l,u,d,h,p,g;function w(){i&&(i.value=d,r.innerHTML=e("%d:%02d.%03d",Math.trunc(d/6e4),Math.trunc(d/1e3)%60,Math.trunc(d)%1e3))}function A(t){if(null===t){if(!p)return;t=((new Date).getTime()-u)*g}var e=l;if((e>=k.length||t<k[e])&&(e=0),e+2<k.length&&t>=k[e])for(var n=k.length;e<n;){var i=e+(n-e>>1&-2);t<=k[i]?n=i:e=i+2}for(;e<k.length&&t>=k[e];)e+=2;d=t,e<l&&(y="",l=0);var r=a.data;L(r.substring(l<k.length?k[l+1]:r.length,e<k.length?k[e+1]:r.length),a),x(),w(),l=e,h&&(h=clearTimeout(h)),p&&(l<k.length?h=setTimeout(A,Math.min(100,(k[l]-(l?k[l-2]:0))/g),null):(s&&v(s,"paused"),M()))}k||("string"==typeof(k=a.time_data)&&(k=function(t){for(var e=[0,0],a=0;a<t.length;){var n=t.indexOf(",",a);if(n<0)break;var i=t.indexOf("\n",n+1);i<0&&(i=t.length),e.push(+t.substring(a,n),+t.substring(n+1,i)),a=i+1}return e}(k)),g=a.time_factor,k.length>2&&(i=$('<div class="pa-runrange"><button type="button" class="pa-runrange-play"></button><input type="range" class="pa-runrange-range" min="0" max="'+k[k.length-2]+'"><span class="pa-runrange-time"></span><span class="pa-runrange-speed-slow" title="Slow">🐢</span><input type="range" class="pa-runrange-speed" min="0.1" max="10" step="0.1"><span class="pa-runrange-speed-fast" title="Fast">🐇</span></div>').prependTo(f),r=i[0].lastChild,s=i[0].firstChild,i=s.nextSibling,o=(r=i.nextSibling).nextSibling.nextSibling,i.addEventListener("input",(function(t){p=!1,v(s,"paused"),A(+this.value)}),!1),s.addEventListener("click",(function(t){m(s,"paused")?(b(s,"paused"),p=!0,u=(new Date).getTime(),d<k[k.length-2]&&(u-=d/g),A(null)):(v(s,"paused"),p=!1)}),!1),o.addEventListener("input",(function(e){g=+this.value,t.site(!1,"pa-runspeed-"+c,[g,(new Date).getTime()]),p&&(u=(new Date).getTime()-d/g,A(null))}),!1)),(l=t.site_json(!1,"pa-runspeed-"+c))&&l[1]>=(new Date).getTime()-864e5&&(g=l[0]),(g<.1||g>10)&&(g=1),o&&(o.value=g),a={data:a.data,timestamp:a.timestamp},n?(l=k.length,d=k[l-2],p=!1,s&&v(s,"paused"),w()):(l=0,d=0,u=(new Date).getTime(),p=!0,k.length&&A(null)))}function I(t){var e,a;if(_&&g.find("span.pa-runqueue").remove(),t&&t.onqueue)return _=t.queueid,a="On queue, "+t.nahead+(1==t.nahead?" job":" jobs")+" ahead",t.headage&&(a+=", oldest began about "+(e=t.headage<10?t.headage:5*Math.round(t.headage/5+.5))+(1==e?" second":" seconds")+" ago"),g[0].insertBefore($("<span class='pa-runqueue'>"+a+"</span>")[0],g[0].lastChild),void setTimeout(P,1e4);if(t&&"working"==t.status?$("#pa-runstop-"+c).length||$('<button id="pa-runstop-'+c+'" class="btn btn-danger pa-runstop" type="button">Stop</button>').click(R).appendTo("#pa-runout-"+c+" > h3"):$("#pa-runstop-"+c).remove(),!t||!t.ok)return e="Unknown error",t&&t.loggedout?e="You have been logged out (perhaps due to inactivity). Please reload this page.":t&&(t.error_text?e=t.error_text:t.error&&!0!==t.error?e=t.error:t.message&&(e=t.message)),T("[1;3;31m"+e+"[m\r\n"),x(),S();if(r=r||t.timestamp,t.data&&t.offset<w&&(t.data=t.data.substring(w-t.offset)),t.data){if(w=t.lastoffset,t.done&&null!=t.time_data&&""===y)return void O(t);L(t.data,t),A=100}t.result&&(null!==y&&L("\n\n",t),L(t.result,t)),t.data||t.result||(A=Math.min(2*A,500)),x(),"old"==t.status?setTimeout(P,2e3):t.done?(S(),t.timed&&!m(f.firstChild,"pa-runrange")&&P({offset:0},D)):setTimeout(P,A)}function D(t){t.data&&t.done&&null!=t.time_data&&O(t,!0)}function P(t,e){var a={};h[0].run||(a.run=c),a.offset=w,r&&(a.check=r),_&&(a.queueid=_),t&&$.extend(a,t),jQuery.ajax(h.attr("action"),{data:h.serializeWith(a),type:"POST",cache:!1,dataType:"json",success:e||I,timeout:3e4,error:function(){h.find(".ajaxsave61").html("Failed"),h.prop("outstanding",!1)}})}function R(){P({stop:1})}return n.headline&&n.noclear&&!i&&g[0].firstChild&&T("\n\n"),n.headline&&n.headline instanceof Node?N(n.headline):n.headline&&T("[1;37m"+n.headline+"[m\n"),n.unfold&&f.getAttribute("data-pa-content")&&T(f.getAttribute("data-pa-content")),f.removeAttribute("data-pa-content"),x(),P(),!1}function Gt(t,e){for(var a=$("#pa-runsettings"),n=a.find(".n").length;a.find("[data-runsetting-num="+n+"]").length;)++n;var i=$('<div class="pa-p" data-runsetting-num="'+n+'"><div class="pa-pt"></div><div class="pa-pd"><input name="n'+n+'" class="uich pa-runconfig ignore-diff n" size="30" placeholder="Name"> &nbsp; <input name="v'+n+'" class="uich pa-runconfig ignore-diff v" size="40" placeholder="Value"></div></div>');t&&(i.find(".n").val(t),i.find(".v").val(e)),a.append(i),t||i.find(".n").focus()}Rt.add_format({format:2,render:function(t){return Kt(t)}}),k.on("pa-runner",(function(){Xt(this)})),k.on("pa-run-show",(function(){var t=this.closest(".pa-runout").id.substring(10),e=document.getElementById("pa-run-"+t);e.dataset.paTimestamp&&!$(e).is(":visible")?Xt(jQuery(".pa-runner[value='"+t+"']")[0],{unfold:!0}):C(e,jQuery("#pa-runout-"+t))})),k.on("pa-runconfig",(function(t){"define"===this.name?Gt():function(){var t,e,a,n=$("#pa-runsettings .pa-p"),i={};for(t=0;t!=n.length;++t)e=$.trim($(n[t]).find(".n").val()),a=$.trim($(n[t]).find(".v").val()),""!=e&&(i[e]=a);$.ajax(n.closest("form").attr("action"),{data:{runsettings:i},type:"POST",cache:!1,dataType:"json"})}()}));class Yt{constructor(t){this.n=t.n,this.cdf=t.cdf,this.cdfu=t.cdfu||null,this.mean=t.mean||null,this.median=t.median||null,this.stddev=t.stddev||null,this.cutoff=t.cutoff||null}min(){return this.cdf.length?this.cdf[0]:0}max(){return this.cdf.length?this.cdf[this.cdf.length-2]:0}count_at(t){let e=this.cdf,a=0,n=e.length;for(;a<n;){let i=a+2*(n-a>>2);e[i]>=t?n=i:a=i+2}return e[a+1]}}class Qt{constructor(t,e,a,n){var i=e.max,r=e.min,s=(i-r)*a,o=1/s;function l(t){return t>=-s&&t<=s?.75*o*(1-(t*=o)*t):0}var u,d=[];for(u=0;u!==n+1;++u)d.push(0);var h=t.cdf,c=(i-r)/n,p=1/c;for(u=0;u<h.length;u+=2)for(var f=h[u+1]-(0===u?0:h[u-1]),g=Math.floor((h[u]-r-s)*p),m=Math.ceil((h[u]-r+s)*p);g<m;){var v=Math.max(-1,Math.min(n+1,g));v>=0&&v<=n&&(d[v]+=l(g*c-h[u]+r)*f),++g}var b=0;if(t.n){var x=1/t.n;for(u=0;u!==n+1;++u)d[u]*=x,b=Math.max(b,d[u])}this.series=t,this.kde=d,this.maxp=b,this.binwidth=c}}class Zt{constructor(t){this.pset=t.pset,this.psetid=t.psetid,this.maxtotal=t.maxtotal||null,this.entry=t.entry||null,this.series={};for(let e in t.series)this.series[e]=new Yt(t.series[e])}}function te(t){var e,a,n=0,i=this.getTotalLength();if(n!=i){for(;i-n>.5;)if(e=n+(i-n)/2,(a=this.getPointAtLength(e)).x>=t+.25)i=e;else{if(a.x>=t-.25)return a.y;n=e}if((a=this.getPointAtLength(i===e?n:i)).x>=t-.25&&a.x<=t+.25)return a.y}return null}const ee={m:2,M:2,z:0,Z:0,l:2,L:2,h:1,H:1,v:1,V:1,c:6,C:6,s:4,S:4,q:4,Q:4,t:2,T:2,a:7,A:7,b:1,B:1};let ae={},ne=0,ie=!1;function re(t){if(t instanceof SVGPathElement&&(t=t.getAttribute("d")),ae[t])return ae[t];for(var e,a,n,i,r,s,o=[],l=0,u=0,d=0,h=0,c=!1,p=0,f=0,m=1,v=function(t){t instanceof SVGPathElement&&(t=t.getAttribute("d")),t=t.split(/([a-zA-Z]|[-+]?(?:\d+\.?\d*|\.\d+)(?:[Ee][-+]?\d+)?)/);var e,a=1,n=t.length;return function(){for(var i,r=null;a<n;){if((i=t[a])>="A"){if(r)break;r=[i],e=i,"m"!==i&&"M"!==i&&"z"!==i&&"Z"!==i||(e="m"===i||"z"===i?"l":"L")}else{if(!r&&e)r=[e];else if(!r||r.length===ee[r[0]]+1)break;r.push(+i)}a+=2}return r}}(t);i=v();)if("b"!==(r=i[0])&&"B"!==r)if("z"!==r&&"Z"!==r){if(1==ee[r]&&(1==i.length?i=["L"]:"h"===r?i=["l",i[1],0]:"H"===r?i=["L",i[1],u]:"v"===r?i=["l",0,i[1]]:"V"===r&&(i=["L",l,i[1]])),(r=i[0])>="a"&&!p)for(e="a"!==r?1:6;e<i.length;e+=2)i[e]+=l,i[e+1]+=u;else if(r>="a")for("a"===r&&(i[3]+=p),e="a"!==r?1:6;e<i.length;e+=2)a=i[e],n=i[e+1],i[e]=l+a*m+n*f,i[e+1]=u+a*f+n*m;for(r=i[0]=r.toUpperCase();i.length<ee[r]+1;)i.push(d,h);"S"===r?(a=n=0,s&&"C"===s[0]&&(a=l-s[3],n=u-s[4]),i=["C",l+a,u+n,i[1],i[2],i[3],i[4]],r="C"):"T"===r&&(a=n=0,s&&"Q"===s[0]&&(a=l-s[1],n=u-s[2]),i=["Q",l+a,u+n,i[1],i[2]],r="Q"),c||"M"===r||(0!==o.length&&"Z"!==o[o.length-1][0]&&o.push(["M"]),c=!0),"M"===r?(d=i[1],h=i[2],c=!1):"L"===r?o.push(["L",l,u,i[1],i[2]]):"C"===r?o.push(["C",l,u,i[1],i[2],i[3],i[4],i[5],i[6]]):"Q"===r?o.push(["C",l,u,l+2*(i[1]-l)/3,u+2*(i[2]-u)/3,i[3]+2*(i[1]-i[3])/3,i[4]+2*(i[2]-i[4])/3,i[3],i[4]]):(1==++ie&&g("bad normalize "+r),o.push(i)),s=i,l=i[i.length-2],u=i[i.length-1]}else s=o.length?o[o.length-1]:null,c&&(l==d&&u==h||o.push(["L",l,u,d,h]),o.push(["Z"]),c=!1),l=d,u=h;else p="b"===r?p+i[1]:i[1],m=Math.cos(p),f=Math.sin(p);return ne>=1e3&&(ae={},ne=0),ae[t]=o,++ne,o}function se(t,e,a){if(a&&!function(t,e,a){function n(t,n,i,r){return t-e[0]>=a||e[0]-i>=a||n-e[1]>=a||e[1]-r>=a}if("clientX"in e){var i=t.getBoundingClientRect(),r=e[0]-e.clientX,s=e[1]-e.clientY;if(i&&n(i.left+r,i.top+s,i.right+r,i.bottom+s))return!1}for(var o,l,u,d,h=re(t),c=0;c!==h.length;++c){var p=h[c];if("L"===p[0])o=Math.min(p[1],p[3]),l=Math.min(p[2],p[4]),u=Math.max(p[1],p[3]),d=Math.max(p[2],p[4]);else{if("C"!==p[0]){if("Z"===p[0]||"M"===p[0])continue;return!0}o=Math.min(p[1],p[3],p[5],p[7]),l=Math.min(p[2],p[4],p[6],p[8]),u=Math.max(p[1],p[3],p[5],p[7]),d=Math.max(p[2],p[4],p[6],p[8])}if(!n(o,l,u,d))return!0}return!1}(t,e,a.distance))return a;var n,i,r,s,o=t.getTotalLength(),l=((s=t)instanceof SVGPathElement&&(s=s.getAttribute("d")),ae[s]?ae[s].length:s.replace(/[^A-DF-Za-df-z]+/g,"").length),u=Math.max(o/l/8,4),d=a?(a.distance+.01)*(a.distance+.01):1/0;function h(a){var r=t.getPointAtLength(a),s=e[0]-r.x,o=e[1]-r.y,l=s*s+o*o;return l<d&&(n=[r.x,r.y],i=a,d=l),r}if(l>20){var c,p,f=function(t,e){var a=re(t);function n(t,a,n,i){var r=e[0]<t?t-e[0]:e[0]>n?e[0]-n:0,s=e[1]<a?a-e[1]:e[1]>i?e[1]-i:0;return Math.max(r,s)}var i,r,s=1/0,o=-1/0,l=24;for(i=0;i!==a.length;++i)"L"===(r=a[i])[0]?(s=Math.min(s,r[1],r[3]),o=Math.max(o,r[1],r[3])):"C"===r[0]&&(s=Math.min(s,r[1],r[3],r[5],r[7]),o=Math.max(o,r[1],r[3],r[5],r[7]));s-=l,o+=l;var u,d,h,c,p,f=Math.max(Math.ceil((o-s)/l),1),g=new Array(f+1);for(g.fill(1/0),i=0;i!==a.length;++i){if("L"===(r=a[i])[0])u=Math.min(r[1],r[3]),d=Math.min(r[2],r[4]),h=Math.max(r[1],r[3]),c=Math.max(r[2],r[4]);else{if("C"!==r[0])continue;u=Math.min(r[1],r[3],r[5],r[7]),d=Math.min(r[2],r[4],r[6],r[8]),h=Math.max(r[1],r[3],r[5],r[7]),c=Math.max(r[2],r[4],r[6],r[8])}for(p=n(u,d,h,c),u=Math.floor((u-s)/l),h=Math.ceil((h-s)/l);u<=h;)g[u]=Math.min(g[u],p),++u}for(i=0;i!==g.length;++i)g[i]<1/0&&(g[i]=g[i]*g[i]);return g.xmin=s,g.xmax=o,g.width=l,g.point=e,g}(t,e),g=f.xmin,m=f.width;for(r=0;r<o;)c=h(r),f[p=Math.floor((c.x-g)/m)]>d&&f[p-1]>d&&f[p+1]>d?r+=m:r+=u}else for(r=0;r<o;r+=u)h(r);h(o);do{(r=i-u/2)>0&&h(r),(r+=u)<o&&h(r),u/=2}while(u>.5);return n&&(n.distance=Math.sqrt(d),n.pathNode=t,n.pathLength=i),n&&(!a||n.distance<=a.distance+.01)?n:a}class oe{constructor(){this.is=[]}lower(t){for(var e=this.is,a=0,n=e.length;a<n;){var i=a+2*(n-a>>2);if(e[i]>t)n=i;else{if(!(t>e[i+1]))return i;a=i+2}}return a}contains(t){var e=this.lower(t);return e<this.is.length&&t>=this.is[e]}overlaps(t,e){var a=this.lower(t);return a<this.is.length&&e>=this.is[a]}add(t,e){var a=this.is,n=this.lower(t);(n>=a.length||t<a[n])&&a.splice(n,0,t,t);for(var i=n;i+2<a.length&&e>=a[i+2];)i+=2;i!==n&&a.splice(n+1,i-n),a[n+1]=Math.max(a[n+1],e)}clear(){this.is=[]}}function le(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}class ue{constructor(t,e,a){var n=$(t),i=a.indexOf("noextra")>=0?e.series.noextra:e.series.all,r=i.min(),s=s<0?s-1:0;e.entry&&"letter"===e.entry.type&&(s=Math.min(65,r<0?r:Math.max(r-5,0))),this.min=s,this.max=i.max(),e.maxtotal&&(this.max=Math.max(this.max,e.maxtotal)),this.total=e.maxtotal,this.cutoff=e.cutoff,this.svg=le("svg"),this.gg=le("g"),this.gx=le("g"),this.gy=le("g"),this.xl=this.xt=!0,this.yl=this.yt="pdf"!==a.substring(0,3),this.tw=n.width(),this.th=n.height(),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.setAttribute("width",this.tw),this.svg.setAttribute("height",this.th),this.svg.setAttribute("overflow","visible"),this.svg.appendChild(this.gg),this.gx.setAttribute("class","pa-gg-axis pa-gg-xaxis"),this.svg.appendChild(this.gx),this.gy.setAttribute("class","pa-gg-axis pa-gg-yaxis"),this.svg.appendChild(this.gy),this.maxp=0,this.hoveranno=null,this.hoveron=!1,n.html(this.svg);var o=le("text");o.appendChild(document.createTextNode("888")),this.gx.appendChild(o);var l=o.getBBox();if(this.xdw=l.width/3,this.xdh=l.height,this.gx.removeChild(o),this.xlw=this.xdw*(Math.floor(Math.log10(this.max))+1),this.mt=Math.ceil(Math.max(this.yl?this.xdh/2:0,2)),this.mr=Math.ceil(this.xl?this.xlw/2:0),this.mb=(this.xt?5:0)+(this.xl?this.xdh+3:0),this.yl){var u=this.th-this.mt-Math.max(this.mb,Math.ceil(this.xdh/2));if(u>this.xdh){var d=n.hasClass("pa-grgraph-min-yaxis");this.yfmt=d?"%.0r%%":"%.0r";var h=u/this.xdh;this.ymax=100,this.ylu=h>15?10:h>5?25:h>3?50:100,this.ml=5+(this.yt?5:0)+(d?4.2:3)*this.xdw,n.hasClass("pa-grgraph-min-yaxis")||(this.yltext=le("text"),this.yltext.appendChild(document.createTextNode("% of grades")),this.gy.appendChild(this.yltext),(l=this.yltext.getBBox()).width<=.875*u?this.ml+=.5*this.xdw+this.xdh:(this.gy.removeText(this.yltext),this.yltext=null)),this.mb=Math.max(this.mb,Math.ceil(this.xdh/2))}else this.yl=!1,this.ml=0,this.mt=2}else this.ml=this.yt?5:0;this.xl&&(this.ml=Math.max(this.ml,Math.ceil(this.xdw/2))),this.gw=this.tw-this.ml-this.mr;var c=this.gh=this.th-this.mt-this.mb,p=this.gw/(this.max-this.min);if(this.xax=function(t){return(t-s)*p},this.yax=function(t){return c-t*c},this.unxax=function(t){return t/p+s},this.unyax=function(t){return-(t-c)/c},e.entry&&e.entry.type){var f=pa_grade_types[e.entry.type];f&&f.tics&&(this.xtics=f.tics.call(f))}this.max-this.min>900?this.xfmt="%.0r":this.max-this.min>10?this.xfmt="%.1r":this.xfmt="%.3r",this.gg.setAttribute("transform","translate("+this.ml+","+this.mt+")"),this.gx.setAttribute("transform","translate("+this.ml+","+(this.mt+this.gh+(this.xt?2:-5))+")"),this.gy.setAttribute("transform","translate("+(this.ml+(this.yt?-2:5))+","+this.mt+")")}numeric_xaxis(){var t,e=Math.floor(Math.log10(this.max))+1,a=this.xdw*(e+.5),n=this.gw/a,i=Math.pow(10,Math.max(0,e-2)),r=(this.max-this.min)/i;t=n>4*r&&i>1?i/2:n>2*r?i:n>r*(i<=1?.75:1)?2*i:i>1&&n>.6*r?2.5*i:n>.3*r?5*i:10*i;for(var s,o=Math.floor(this.min/t)*t,l=[],u=!1;o<this.max+t;){var d=o,h=this.xl;if(this.total&&(d>this.total&&d-t<this.total&&!u&&(d=this.total,o-=t),d==this.total&&(u=!0)),o+=t,!(d<this.min)){d>this.max&&(d=this.max);var c=this.xax(d);l.push("M",c,",0v5"),(this.total&&d!=this.total&&Math.abs(c-this.xax(this.total))<a||d!=this.max&&d!=this.total&&Math.abs(c-this.xax(this.max))<a)&&(h=!1),h&&((s=le("text")).appendChild(document.createTextNode(d)),s.setAttribute("x",c),s.setAttribute("y",this.xdh+3),this.gx.appendChild(s))}}this.xt&&((s=le("path")).setAttribute("d",l.join("")),s.setAttribute("fill","none"),s.setAttribute("stroke","black"),this.gx.appendChild(s))}xtics_xaxis(){var t=new oe,e=new oe,a=[];for(i=0;i!==this.xtics.length;++i)if(xt=this.xtics[i],!(xt.x<this.min||xt.x>this.max)){var n=this.xax(xt.x);if((xt.notic||!e.contains(n))&&(xt.notic||(a.push("M",n,",0v5"),e.add(n-3,n+3)),this.xl&&xt.text)){var r=this.xdw*(xt.label_space||xt.text.length+.5)*.5;if(!t.overlaps(n-r,n+r)){var s=le("text");s.appendChild(document.createTextNode(xt.text)),s.setAttribute("x",n),s.setAttribute("y",this.xdh+3),this.gx.appendChild(s),r=this.xdw*(xt.text.length+.5)*.5,t.add(n-r,n+r)}}}this.xt&&((s=le("path")).setAttribute("d",a.join("")),s.setAttribute("fill","none"),s.setAttribute("stroke","black"),this.gx.appendChild(s))}xaxis(){this.xtics?this.xtics_xaxis():this.numeric_xaxis()}yaxis(){for(var t,a=0,n=[];a<=this.ymax&&this.yl;)(t=le("text")).appendChild(document.createTextNode(e(this.yfmt,a))),t.setAttribute("x",-8),t.setAttribute("y",this.yax(a/this.ymax)+.25*this.xdh),this.gy.appendChild(t),n.push("M-5,",this.yax(a/this.ymax),"h5"),a+=this.ylu;this.yt&&((t=le("path")).setAttribute("d",n.join("")),t.setAttribute("fill","none"),t.setAttribute("stroke","black"),this.gy.appendChild(t)),this.yltext&&(this.yltext.setAttribute("transform","translate("+(-this.ml+this.xdh)+","+this.yax(.5)+") rotate(-90)"),this.yltext.setAttribute("text-anchor","middle"))}container(){return this.svg.closest(".pa-grgraph")}append_cdf(t,e){var a,n=t.cdf,i=[],r=1/t.n,s=this.cutoff||0,o=0;if(s)for(;o<n.length&&n[o+1]<s*t.n;)o+=2;for(;o<n.length;o+=2)0!==i.length?(a=Math.max(0,n[o]-Math.min(1,n[o]-n[o-2])/2),i.push("H",this.xax(a))):i.push("M",this.xax(Math.max(0,n[o]-.5)),",",this.yax(s)),i.push("V",this.yax(n[o+1]*r));0!==i.length&&i.push("H",this.xax(n[n.length-2]+.5));var l=le("path");return l.setAttribute("d",i.join("")),l.setAttribute("fill","none"),l.setAttribute("class",e),this.gg.appendChild(l),this.last_curve=l,this.last_curve_series=t,l}append_pdf(t,e){if(0===t.maxp)return null;var a=[],n=t.kde,i=.9/this.maxp,r=this.xax,s=this.yax,o=[0,0,0,0],l=[0,0,0,0],u=[0,0,0,0],d=[0,0,0,0],h=1e-6;function c(t){var e=(t+2)%4,n=(t+3)%4,i=(t+1)%4,r=o[n],s=l[n],c=o[t],p=l[t];if(u[n]>h){var f=2*d[n]+3*u[n]*u[t]+d[t],g=3*u[n]*(u[n]+u[t]);r=(r*f-o[e]*d[t]+o[t]*d[n])/g,s=(s*f-l[e]*d[t]+l[t]*d[n])/g}if(u[i]>h){var m=2*d[i]+3*u[i]*u[t]+d[t],v=3*u[i]*(u[i]+u[t]);c=(c*m-o[i]*d[t]+o[n]*d[i])/v,p=(p*m-l[i]*d[t]+l[n]*d[i])/v}a.push("C",r,s,c,p,o[t],l[t])}for(var p=0;p!==n.length;++p){var f=r(this.min+p*t.binwidth),g=s(n[p]*i);if(0===p)a.push("M",f,g),o[3]=o[0]=f,l[3]=l[0]=g;else{var m=(p+3)%4,v=p%4;o[v]=f,l[v]=g;var b=o[m]-f,x=l[m]-g;if(d[v]=Math.sqrt(b*b+x*x),u[v]=Math.sqrt(d[v]),p>1&&c(m),p===n.length-1){var y=(p+1)%4;o[y]=f,l[y]=g,d[y]=0,u[y]=0,c(v)}}}var w=le("path");return w.setAttribute("d",a.join(" ")),w.setAttribute("fill","none"),w.setAttribute("class",e),this.gg.appendChild(w),this.last_curve=w,this.last_curve_series=t.series,w}remove_if(t){for(var e=this.gg.firstChild;e;){var a=e.nextSibling;t.call(e)&&this.gg.removeChild(e),e=a}}highlight_last_curve(t,e,a){if(!this.last_curve||!this.last_curve_series.cdfu)return null;var n,i,r,s,o,l,u,d=m(this.last_curve,"pa-gg-pdf"),h=this.last_curve_series.cdf,c=this.last_curve_series.cdfu,p=[];for(i=(n=d?.9/(this.maxp*t.n):1/t.n)*this.gh,r=s=0;r!==h.length;r+=2){for(u=0;s!==h[r+1];++s)e(c[s],t)&&++u;u&&(o=this.xax(h[r]),null!=(l=d?te.call(this.last_curve,o):this.yax(h[r+1]*n))&&p.push("M",o,",",l,"v",u*i))}if(p.length){var f=le("path");return f.setAttribute("d",p.join("")),f.setAttribute("fill","none"),f.setAttribute("class",a),this.gg.appendChild(f),v(this.gg,"pa-gg-has-hl"),f}return null}typed_annotation(t){var e=le("circle");return e.setAttribute("class","pa-gg-mark hl-"+(t||"main")),e.setAttribute("r",t&&"main"!==t?3.5:5),e}star_annotation(t,e,a,n){null==e&&(e=Math.PI/2),null==a&&(a=5);var i=le("path");i.setAttribute("class",n);for(var r=["M"],s=Math.cos,o=Math.sin,l=Math.PI/a,u=0;u<2*a;++u)r.push(t[1&u]*s(e)," ",t[1&u]*o(e),u?" ":"L"),e+=l;return r.push("z"),i.setAttribute("d",r.join("")),i}annotate_last_curve(t,e,a){if(this.last_curve){var n=this.xax(t),i=te.call(this.last_curve,n);if(null===i&&this.cutoff&&(i=this.yax(this.cutoff)),null!==i)return(e=e||this.typed_annotation()).setAttribute("transform","translate("+n+","+i+")"),this.gg.insertBefore(e,a||null),!0}return!1}user_x(t){if(this.last_curve_series.cdfu){if(!this.last_curve_series.ucdf){var e,a,n=this.last_curve_series.cdf,i=this.last_curve_series.cdfu,r=this.last_curve_series.ucdf={};for(e=a=0;a!==i.length;++a){for(;a>=n[e+1];)e+=2;r[i[a]]=n[e]}}return this.last_curve_series.ucdf[t]}}highlight_users(){if(this.last_curve&&this.last_curve_series.cdfu){this.last_highlight=this.last_highlight||{};for(var t=this.container().attributes,e={},a=0;a!==t.length;++a){if(t[a].name.startsWith("data-pa-highlight"))e[n="data-pa-highlight"===t[a].name?"main":t[a].name.substring(18)]=t[a].value,this.last_highlight[n]=this.last_highlight[n]||""}for(var n in this.last_highlight){var i=e[n]||"";if(this.last_highlight[n]!==i){var r,s={},o=i.split(/\s+/);for(a=0;a!==o.length;++a)""!==o[a]&&(s[o[a]]=1);for(var l,u=this.gg.firstChild,d="pa-gg-mark hl-"+n;u&&(!m(u,"pa-gg-mark")||u.className.animVal<d);)u=u.nextSibling;for(;u&&u.className.animVal===d;){l=u.nextSibling;var h=+u.getAttribute("data-pa-uid");s[h]?s[h]=2:this.gg.removeChild(u),u=l}for(a=0;a!==o.length;++a)if(1===s[o[a]]&&null!=(r=this.user_x(o[a]))){var c=this.typed_annotation(n);c.setAttribute("data-pa-uid",o[a]),this.annotate_last_curve(r,c,u)}this.last_highlight[n]=i}}}}hover(){var t=this;function a(t,e,a){var n=null;for(var i of t){var r=i.getAttribute("transform").match(/^translate\(([-+\d.]+),([-+\d.]+)\)$/);if(r){var s=+r[1]-e[0],o=+r[2]-e[1],l=s*s+o*o;l<a&&((n=[+r[1],+r[2]]).pathNode=i,a=l)}}return n&&(n.distance=Math.sqrt(a)),n}function n(n){var i={distance:20},r=t.xfmt;if("mousemove"!==n.type&&(t.hoveron="mouseleave"!==n.type),t.hoveron){var s=function(t,e){var a,n=t.ownerSVGElement||t;if(n.createSVGPoint)(a=n.createSVGPoint()).x=e.clientX,a.y=e.clientY,a=a.matrixTransform(t.getScreenCTM().inverse());else{var i=t.getBoundingClientRect();a={x:e.clientX-i.left-t.clientLeft,y:e.clientY-i.top-t.clientTop}}var r=[a.x,a.y];return r.clientX=e.clientX,r.clientY=e.clientY,r}(t.svg,n),o=t.gg.querySelectorAll(".pa-gg-pdf, .pa-gg-cdf");for(var l of(s[0]-=t.ml,s[1]-=t.mt,o))i=se(l,s,i);if(i.pathNode){var u=a(t.gg.querySelectorAll(".pa-gg-mark.hl-main"),i,36)||a(t.gg.querySelectorAll(".pa-gg-mark:not(.hl-main)"),i,25);u&&(i=u,"%.0r"!==r&&"%.1f"!==r||(r="%.2r"))}}var d=t.hoveranno;if(i.pathNode){if(!d){d=t.hoveranno=[t.star_annotation([4,10],null,null,"pa-gg-hover-mark")],t.gg.appendChild(d[0]);var h=le("path");h.setAttribute("d","M0,0v5"),h.setAttribute("fill","none"),h.setAttribute("stroke","black"),t.gx.appendChild(h),d.push(h),(h=le("rect")).setAttribute("class","pa-gg-hover-box"),h.setAttribute("y",5),h.setAttribute("height",t.xdh+1.5),h.setAttribute("rx",3),t.gx.appendChild(h),d.push(h),(h=le("text")).appendChild(document.createTextNode("")),h.setAttribute("class","pa-gg-hover-text"),h.setAttribute("y",t.xdh+3),t.gx.appendChild(h),d.push(h),(h=le("text")).appendChild(document.createTextNode("")),h.setAttribute("class","pa-gg-anno-name"),h.setAttribute("text-anchor","end"),h.setAttribute("dx",-8),t.gg.appendChild(h),d.push(h),t.yl&&((h=le("path")).setAttribute("d","M-5,0h5"),h.setAttribute("fill","none"),h.setAttribute("stroke","black"),t.gy.appendChild(h),d.push(h),(h=le("rect")).setAttribute("class","pa-gg-hover-box"),h.setAttribute("height",t.xdh+1),h.setAttribute("rx",3),t.gy.appendChild(h),d.push(h),(h=le("text")).appendChild(document.createTextNode("")),h.setAttribute("class","pa-gg-hover-text"),h.setAttribute("x",-8),t.gy.appendChild(h),d.push(h))}d[0].setAttribute("transform","translate("+i[0]+","+i[1]+")"),d[1].setAttribute("transform","translate("+i[0]+",0)"),d[3].setAttribute("x",i[0]),d[3].firstChild.data=e(r,t.unxax(i[0]));var c,p,f=d[3].getBBox();d[2].setAttribute("x",i[0]-f.width/2-2),d[2].setAttribute("width",f.width+4),i.pathNode.hasAttribute("data-pa-uid")&&(c=$(".gtable").data("paTable"))&&(p=c.name_text(i.pathNode.getAttribute("data-pa-uid")))?(d[4].firstChild.data=p,d[4].setAttribute("x",i[0]),d[4].setAttribute("y",i[1])):d[4].firstChild.data="",t.yl&&(d[5].setAttribute("transform","translate(0,"+i[1]+")"),d[7].setAttribute("y",i[1]+.25*t.xdh),d[7].firstChild.data=e(t.yfmt,t.unyax(i[1])*t.ymax),f=d[7].getBBox(),d[6].setAttribute("x",-f.width-10),d[6].setAttribute("y",i[1]-(t.xdh+2)/2),d[6].setAttribute("width",f.width+4))}else d&&(t.gg.removeChild(d[0]),t.gx.removeChild(d[1]),t.gx.removeChild(d[2]),t.gx.removeChild(d[3]),t.gg.removeChild(d[4]),t.yl&&(t.gy.removeChild(d[5]),t.gy.removeChild(d[6]),t.gy.removeChild(d[7])),t.hoveranno=null)}this.svg.addEventListener("mouseenter",n,!1),this.svg.addEventListener("mousemove",n,!1),this.svg.addEventListener("mouseleave",n,!1)}}function de(t){return document.getElementById(t)}var he,ce;function pe(t,e){return t===e||(t=(null==t?"":t).replace(/\r\n?/g,"\n"))===(e=(null==e?"":e).replace(/\r\n?/g,"\n"))}function fe(){return(new Date).getTime()}function ge(){return fe()/1e3}function me(t,e){return"string"==typeof e&&(e=""===e?[]:[e]),0===e.length?"":(e=1===e.length?e[0]:"<p>"+e.join("</p><p>")+"</p>",0!==t&&1!==t&&2!==t||(t=["info","warning","error"][t]),'<div class="msg msg-'+t+'">'+e+"</div>")}function ve(t){return"checkbox"===t.type||"radio"===t.type}function be(t){var e=function(t){return t.hasAttribute("data-default-value")?t.getAttribute("data-default-value"):ve(t)?(t.hasAttribute("data-default-checked")?t.getAttribute("data-default-checked"):t.defaultChecked)?t.value:"":t.defaultValue}(t);return ve(t)?t.checked?e!==t.value:""!==e:!pe("SELECT"===t.tagName?$(t).val():t.value,e)}function xe(){this.clear()}function ye(t){var e=new xe,a=null;function n(t){var e=a.find("form")[0],n=a.find(".popup-body"),i=me(2,t.error);for(var r in a.find(".msg-error").remove(),n.length?n.prepend(i):a.find("h2").after(i),t.errf||{}){var s=e[r];if(s){var o=$(s).closest(".entryi, .f-i");(o.length?o:$(s)).addClass("has-error")}}return a}function i(){ft.erase(),a.find("textarea, input").unautogrow(),a.trigger("closedialog"),a.remove(),b(document.body,"modal-open")}return t=t||{},e.push('<div class="modal" role="dialog"><div class="modal-dialog'+(t.anchor&&t.anchor!==window?"":" modal-dialog-centered")+(t.style?'" style="'+Y(t.style):"")+'" role="document"><div class="modal-content"><form enctype="multipart/form-data" accept-charset="UTF-8"'+(t.form_class?' class="'+t.form_class+'"':"")+">","</form></div></div></div>"),e.push_actions=function(t){return e.push('<div class="popup-actions">',"</div>"),t&&e.push(t.join("")).pop(),e},e.show=function(r){if(!a){for(var s in(a=$(e.render()).appendTo(document.body)).find(".need-tooltip").each(ft),a.on("click",(function(t){t.target===a[0]&&i()})),a.find("button[name=cancel]").on("click",i),t.action&&(t.action instanceof HTMLFormElement?a.find("form").attr({action:t.action.action,method:t.action.method}):a.find("form").attr({action:t.action,method:t.method||"post"})),{minWidth:1,maxWidth:1,width:1})null!=t[s]&&a.children().css(s,t[s]);a.show_errors=n,a.close=i}return!1!==r&&(!function(t,e){ft.erase(),t.jquery&&(t=t[0]);for(;!m(t,"modal-dialog");)t=t.childNodes[0];var a,n=t.parentNode;if(v(n,"show"),v(document.body,"modal-open"),!m(t,"modal-dialog-centered")){var i=$(e).geometry(),r=$(window).geometry(),s=$(n).offset(),o=(i.top+i.bottom-t.offsetHeight)/2;o=Math.max(r.top+5,Math.min(r.bottom-5-t.offsetHeight,o))-s.top,t.style.top=o+"px";var l=(i.right+i.left-t.offsetWidth)/2;l=Math.max(r.left+5,Math.min(r.right-5-t.offsetWidth,l))-s.left,t.style.left=l+"px"}$(t).find("input, button, textarea, select").filter(":visible").each((function(){if(m(this,"want-focus"))return a=this,!1;a||m(this,"dangerous")||m(this,"no-focus")||(a=this)})),a&&function(t){if(t.jquery&&(t=t[0]),t.focus(),!t.hotcrp_ever_focused){if(t.select&&m(t,"want-select"))t.select();else if(t.setSelectionRange)try{t.setSelectionRange(t.value.length,t.value.length)}catch(t){}t.hotcrp_ever_focused=!0}}(a)}(a,t.anchor||window),a.find(".need-autogrow").autogrow(),a.find(".need-tooltip").each(ft)),a},e}$.fn.extend({geometry:function(t){var e,a;if(this[0]==window)e={left:this.scrollLeft(),top:this.scrollTop()};else{if(1==this.length&&this[0].getBoundingClientRect)return e=$.extend({},this[0].getBoundingClientRect()),(a=window.pageXOffset)&&(e.left+=a,e.right+=a),(a=window.pageYOffset)&&(e.top+=a,e.bottom+=a),"width"in e||(e.width=e.right-e.left,e.height=e.bottom-e.top),e;e=this.offset()}return e&&(e.width=t?this.outerWidth():this.width(),e.height=t?this.outerHeight():this.height(),e.right=e.left+e.width,e.bottom=e.top+e.height),e},scrollIntoView:function(t){t=t||{};for(var e=0;e!==this.length;++e){for(var a=$(this[e]).geometry(),n=this[e].parentNode;n&&n.tagName&&"visible"===$(n).css("overflow-y");)n=n.parentNode;n=n&&n.tagName?n:window;var i=$(n).geometry();if(a.top<i.top+(t.marginTop||0)||t.atTop){var r=Math.max(a.top-(t.marginTop||0),0);n===window?n.scrollTo(n.scrollX,r):n.scrollTop=r}else if(a.bottom>i.bottom-(t.marginBottom||0)){r=Math.max(a.bottom+(t.marginBottom||0)-i.height,0);n===window?n.scrollTo(n.scrollX,r):n.scrollTop=r}}return this},serializeWith:function(t){var e,a,n=this.serialize();if(null!=n&&t)for(e in a=n.length&&"&"!=n[n.length-1]?"&":"",t)null!=t[e]&&(n+=a+encodeURIComponent(e)+"="+encodeURIComponent(t[e]),a="&");return n}}),he="pushState"in window.history?function(t){var e;return history.state||(e={href:location.href},$(document).trigger("collectState",[e]),history.replaceState(e,document.title,e.href)),t&&(e={href:t},$(document).trigger("collectState",[e]),history.pushState(e,document.title,e.href)),!0}:function(){return!1},$((function(){$("form.need-unload-protection").each((function(){var t=this;b(t,"need-unload-protection"),$(t).on("submit",(function(){v(this,"submitting")})),$(window).on("beforeunload",(function(){if(m(t,"alert")&&!m(t,"submitting"))return"If you leave this page now, your edits may be lost."}))}))})),xe.prototype.push=function(t,e){return t&&e?(this.open.push(this.html+t),this.close.push(e),this.html="",this.open.length-1):(this.html+=t,this)},xe.prototype.pop=function(t){var e=this.open.length;for(null==t&&(t=Math.max(0,e-1));e>t;)--e,this.html=this.open[e]+this.html+this.close[e],this.open.pop(),this.close.pop();return this},xe.prototype.pop_n=function(t){return this.pop(Math.max(0,this.open.length-t)),this},xe.prototype.push_pop=function(t){return this.html+=t,this.pop()},xe.prototype.pop_push=function(t,e){return this.pop(),this.push(t,e)},xe.prototype.pop_collapse=function(t){for(null==t&&(t=this.open.length?this.open.length-1:0);this.open.length>t;)""!==this.html&&(this.html=this.open[this.open.length-1]+this.html+this.close[this.open.length-1]),this.open.pop(),this.close.pop();return this},xe.prototype.render=function(){return this.pop(0),this.html},xe.prototype.clear=function(){return this.open=[],this.close=[],this.html="",this},xe.prototype.next_htctl_id=(ce=1,function(){for(;document.getElementById("htctl"+ce);)++ce;return"htctl"+(++ce-1)});var we=function(){var t,e=!1;function a(a,n){var i,r;a&&"string"==typeof a&&(a=de(a)),a&&e&&(i=new Date(1e3*n),r=s(t?"%A %#e %b %Y %#R your time":"%A %#e %b %Y %#r your time",i),"SPAN"==a.tagName?(a.innerHTML=" ("+r+")",a.style.display="inline"):(a.innerHTML=r,a.style.display="block"))}return a.initialize=function(a,n){t=n,e=Math.abs((new Date).getTimezoneOffset()-a)>=60},a}(),Ae=[];function _e(t){if(t)"string"==typeof t?Ae.push(_e[t]):Ae.push(t);else for(var e=0;e<Ae.length;++e)Ae[e]()}_e.time=function(t,e){we.initialize(t,e)},_e.opencomment=function(){location.hash.match(/^\#?commentnew$/)&&open_new_comment()};var $e={},ke=1;function Ce(t,e,a){var n,i,r,s,o,l;if(t instanceof Array)for(n=0;n<t.length;n++)Ce(t[n],e,a);else if("string"==typeof t)o=a,null!=$e[t]&&null!=$e[t][a]&&(o=$e[t][a]),l=o||"",Ce(de("fold"+t)||de(t),e,o),(i=de("foldsession."+t+l))?i.src=i.src.replace(/val=.*/,"val="+(e?1:0)+"&u="+ke++):(i=de("foldsession."+t))&&(i.src=i.src.replace(/val=.*/,"val="+(e?1:0)+"&sub="+(a||l)+"&u="+ke++)),!e&&(i=de("fold"+t+l+"_d"))&&(i.setSelectionRange&&null==i.hotcrp_ever_focused&&(i.setSelectionRange(i.value.length,i.value.length),i.hotcrp_ever_focused=!0),i.focus());else if(t&&(r="fold"+(l=a||"")+"o",s="fold"+l+"c",null==e&&t.className.indexOf(r)>=0&&(e=!0),t.className=e?t.className.replace(r,s):t.className.replace(s,r),document.recalc))try{t.innerHTML=t.innerHTML+""}catch(t){}return!1}function Me(t){var e=t.getAttribute("data-pa-note");return"string"==typeof e&&""!==e&&(e=JSON.parse(e)),"number"==typeof e&&(e=[!1,"",0,e]),e||[!1,""]}function Se(t,e){!1===e||null===e?t.removeAttribute("data-pa-note"):void 0!==e&&t.setAttribute("data-pa-note",JSON.stringify(e))}function Te(){function t(t){return""===Me(t)[1]}function e(t,e){var a=$(t).find(".pa-note-links a");a.length||(a=$('<a class="ui pa-goto"></a>'),$('<div class="pa-note-links"></div>').append(a).prependTo($(t).find(".pa-notecontent"))),a.attr("href",function(t){var e,a=wt(t);return a&&(e=bt(a.ufile,a.lineid))?"#"+e.id:""}(e));var n=e?"NEXT >":"TOP";a.text()!==n&&a.text(n)}for(var a=$(".pa-gw"),n=0;n<a.length&&a[n]!==this;)++n;if(n<a.length){for(var i=n-1;i>=0&&t(a[i]);)--i;for(var r=n+1;r<a.length&&t(a[r]);)++r;i>=0&&e(a[i],t(this)?a[r]:this),e(this,a[r])}}function Ne(t,e){var a=this,n=$(this);if(!m(a,"pa-gw")){for(;!m(a,"pa-dl");)a=a.parentElement;for(var i=a.nextSibling;i&&(i.nodeType!==Node.ELEMENT_NODE||m(i,"pa-gn"));)a=i,i=i.nextSibling;var r,s,o,l,u=yt(a=(n=$('<div class="pa-dl pa-gw"><div class="pa-notebox"></div></div>').insertAfter(a))[0],!1,1);u&&(r=m(u,"pa-gd")?"a"+u.firstChild.getAttribute("data-landmark"):m(u,"pa-gr")&&(s=u.lastChild.firstChild)&&(o=s.getAttribute("data-landmark"))&&(l=o.indexOf("-"))>=0?"b"+o.substring(l+1):"b"+u.firstChild.nextSibling.getAttribute("data-landmark"),a.setAttribute("data-landmark",r))}if(0==arguments.length)return a;Se(a,t);var d=n.find(".pa-notebox"),h=d.children();if(e?h.slideUp(80).queue((function(){h.remove()})):h.remove(),""===t[1])return Te.call(a),e?n.children().slideUp(80):v(a,"hidden"),a;var c='<div class="pa-notecontent clearfix">';if(t[2]){var p=$.isArray(t[2])?t[2]:[t[2]],f=[];for(var g in p){var x=siteinfo.pc[p[g]];x&&(x.nick?f.push(x.nick):x.nicklen||x.lastpos?f.push(x.name.substr(0,x.nicklen||x.lastpos-1)):f.push(x.name))}f.length&&(c+='<div class="pa-note-author">['+f.join(", ")+"]</div>")}if(c+='<div class="pa-note pa-'+(t[0]?"comment":"grade")+"note",t[4]&&"number"==typeof t[4]&&(c+='" data-format="'+t[4]),c+='"></div></div>',d.append(c),t[4]){var y=Rt(t[4],t[1]);d.find(".pa-note").addClass("format"+(y.format||0)).html(y.content)}else d.find(".pa-note").addClass("format0").text(t[1]);return Te.call(a),e?d.find(".pa-notecontent").hide().slideDown(80):b(a,"hidden"),a}k.on("js-foldup",(function(t,e){var a,n,i,r=this;if("number"==typeof e?e={n:e}:e||(e={}),"DIV"!==this.tagName||!t||!t.target.closest("a")||e.required){!("n"in e)&&r.hasAttribute("data-fold-target")&&(n=r.getAttribute("data-fold-target").match(/^(\D[^#]*$|.*(?=#)|)#?(\d*)([cou]?)$/))&&(""!==n[1]&&(r=document.getElementById(n[1])),e.n=parseInt(n[2])||0,"f"in e||""===n[3]||("u"===n[3]&&"INPUT"===this.tagName&&"checkbox"===this.type?e.f=this.checked:e.f="c"===n[3]));for(var s="fold"+(e.n||"");r&&(!r.id||"fold"!=r.id.substr(0,4))&&!m(r,"has-fold")&&(null==e.n||!m(r,s+"c")&&!m(r,s+"o"));)r=r.parentNode;if(!r)return!0;if(null==e.n){i=y(r);for(var o=0;o!==i.length;++o)"fold"===i[o].substring(0,4)&&(n=i[o].match(/^fold(\d*)[oc]$/))&&(null==e.n||+n[1]<e.n)&&(e.n=+n[1],s="fold"+(e.n||""))}if(!("f"in e)&&("INPUT"===this.tagName||"SELECT"===this.tagName)){var l=null;if("checkbox"===this.type)e.f=!this.checked;else if("radio"===this.type){if(!this.checked)return!0;l=this.value}else"select-one"===this.type&&(l=this.selectedIndex<0?"":this.options[this.selectedIndex].value);if(null!==l){var u=(r.getAttribute("data-"+s+"-values")||"").split(/\s+/);e.f=u.indexOf(l)<0}}a=!m(r,s+"c"),"f"in e&&!e.f===a||(e.f=a,Ce(r,a,e.n||0),$(r).trigger(e.f?"fold":"unfold",e)),this.hasAttribute("aria-expanded")&&this.setAttribute("aria-expanded",a?"false":"true"),t&&"object"==typeof t&&"click"===t.type&&!m(t.target,"uic")&&(t.stopPropagation(),t.preventDefault())}})),k.on("pa-pset-upload-grades",(function(){$("#upload").show()})),k.on("pa-signin-radio",(function(t){let e;"login"===this.value?(Ce("logingroup",!1),Ce("logingroup",!1,2),e="Sign in"):"forgot"===this.value?(Ce("logingroup",!0),Ce("logingroup",!1,2),e="Reset password"):"new"===this.value&&(Ce("logingroup",!0),Ce("logingroup",!0,2),e="Create account"),document.getElementById("signin").value=e})),function(t){var e,a,n,i,r;function s(){var t;if(e&&(t=bt(e.ufile,e.lineid))){for(t=t.closest(".pa-dl");t&&!t.offsetParent;)t=t.previousSibling;return t}return null}function o(t){t&&null!=t.pageX&&(r=t.timeStamp,n=t.screenX,i=t.screenY)}function l(a){var l,u;if(!("mousemove"===a.type&&r&&(Math.abs(a.screenX-n)<=1&&Math.abs(a.screenY-i)<=1||a.timeStamp-r<=200)||("keydown"===a.type||"keyup"===a.type)&&j.modifier(a))){if("keydown"!==a.type||"ArrowUp"!==(l=j(a))&&"ArrowDown"!==l&&"Enter"!==l||(u=E(a))&&(u!==E.META||"Enter"!==l)||!e)return d();var h=s();if(!h)return d();if("ArrowDown"!==l&&"ArrowUp"!==l||(b(h,"live"),h=yt(h,"ArrowDown"===l,0))){if(e=wt(h),a.preventDefault(),o(a),"Enter"===l)w();else{var c=h.closest(".pa-with-fixed");t(h).addClass("live").scrollIntoView(c?{marginTop:c.firstChild.offsetHeight}:null)}return!0}}}function u(e,a){v(e,"live"),t(".pa-filediff").removeClass("live"),t(document).off(".pa-linenote"),t(document).on((a?"keydown.pa-linenote ":"")+"mousemove.pa-linenote mousedown.pa-linenote",l)}function d(){t(".pa-dl.live").removeClass("live"),t(".pa-filediff").addClass("live"),t(document).off(".pa-linenote")}function h(e,a){var n=Me(e=e.closest(".pa-dl")),i=e?t(e).find("textarea"):null;if(!e||!a&&i.length&&!pe(n[1],i.val().replace(/\s+$/,"")))return!1;b(e,"editing"),t(e).find(":focus").blur(),Ne.call(e,n,!0);var r=s();return r&&u(r,!0),!0}var f=function(e){if(!m(this,"pa-gw"))throw new Error("!");if(m(this,"pa-outstanding"))return!1;v(this,"pa-outstanding");var a,n,i=this,r=Me(this),s=m(this,"editing"),o=this.closest(".pa-filediff"),l=o.closest(".pa-psetinfo"),u=this.closest(".pa-grade-range-block"),d=o.getAttribute("data-pa-file"),f=yt(this,!1,1);if(n=this.hasAttribute("data-landmark")?this.getAttribute("data-landmark"):m(f,"pa-gd")?"a"+f.firstChild.getAttribute("data-landmark"):"b"+f.firstChild.nextSibling.getAttribute("data-landmark"),s){var g=t(this).find("form")[0];a={note:g.note.value},g.iscomment&&g.iscomment.checked&&(a.iscomment=1),t(g).find(".pa-save-message").remove(),t(g).find(".aab").append('<div class="aabut pa-save-message">Saving…</div>')}else"function"==typeof e&&(e=e(r?r[1]:"",r)),a={note:e};return a.format=r?r[4]:null,null==a.format&&(a.format=o.getAttribute("data-default-format")),u&&u.setAttribute("data-pa-notes-outstanding",+u.getAttribute("data-pa-notes-outstanding")+1),new Promise((function(e,o){R(c("api/linenote",p(l,{file:d,line:n,oldversion:r&&r[3]||0})),a).then((function(a){b(i,"pa-outstanding"),a&&a.ok?(b(i,"pa-save-failed"),r=(r=a.linenotes[d])&&r[n],Se(i,r),s?(t(i).find(".pa-save-message").html("Saved"),h(i)):Ne.call(i,r),e(i)):(v(i,"pa-save-failed"),s&&t(i).find(".pa-save-message").html('<strong class="err">'+Y(a.error||"Failed")+"</strong>"),o(i)),u&&function(e){var a=+e.getAttribute("data-pa-notes-outstanding")-1;a?e.setAttribute("data-pa-notes-outstanding",a):(e.removeAttribute("data-pa-notes-outstanding"),t(e).find(".pa-grade").each((function(){Je.call(this,null,!0)})))}(u)}))}))};function g(t){return h(this,!0),!0}function x(e){return!("Escape"===j(e)&&!E(e)&&h(this))&&("Enter"!==j(e)||E(e)!==E.META||(t(this).closest("form").submit(),!1))}function y(t,e){return t*t+e*e<144}function w(a){var n;if(n=e.notetr?t(e.notetr):t(Ne.call(e.tr)),o(a),n.hasClass("editing")){if(h(n[0]))return a&&a.stopPropagation(),!0;var i=n.find("textarea").focus();return i[0].setSelectionRange&&i[0].setSelectionRange(0,i.val().length),!1}return function(a,n,i){a.removeClass("hidden").addClass("editing"),n&&Se(a[0],n);var r=a.find(".pa-notebox");if(i){a.css("display","").children().css("display","");var s=r.children();s.slideUp(80).queue((function(){s.remove()}))}var o=t(e.tr).closest(".pa-psetinfo"),l=n?n[4]:null;null==l&&(l=a.closest(".pa-filediff").attr("data-default-format"));var u='<form method="post" action="'+Y(c("api/linenote",p(o[0],{file:e.file,line:e.lineid,oldversion:n&&n[3]||0,format:l})))+'" enctype="multipart/form-data" accept-charset="UTF-8" class="ui-submit pa-noteform"><textarea class="pa-note-entry" name="note"></textarea><div class="aab aabr pa-note-aa"><div class="aabut"><button class="btn-primary" type="submit">Save comment</button></div><div class="aabut"><button type="button" name="cancel">Cancel</button></div>';o[0].hasAttribute("data-pa-user-can-view-grades")||(u+='<div class="aabut"><label><input type="checkbox" name="iscomment" value="1">Show immediately</label></div>');var d=t(u+"</div></form>").appendTo(r),h=d.find("textarea");n&&null!==n[1]&&(h.text(n[1]),h[0].setSelectionRange&&h[0].setSelectionRange(n[1].length,n[1].length)),h.autogrow().keydown(x),d.find("input[name=iscomment]").prop("checked",!(!n||!n[0])),d.find("button[name=cancel]").click(g),d.on("submit",(function(){f.call(this.closest(".pa-dl"))})),i&&(h.focus(),d.hide().slideDown(100))}(n,Me(n[0]),!0),u(e.tr,!1),!1}k.on("pa-editablenotes",(function(t){var n=t.target.closest(".pa-dl");if(0===t.button&&n&&!n.matches(".pa-gn, .pa-gx")){var i=wt(t.target),r=fe();"mousedown"===t.type&&i?e&&e.tr===i.tr&&a&&y(a[0]-t.clientX,a[1]-t.clientY)&&r-a[2]<=500||(e=i,a=[t.clientX,t.clientY,r,!1]):"mouseup"===t.type&&i?e&&e.tr===i.tr&&a&&y(a[0]-t.clientX,a[1]-t.clientY)&&!a[3]&&(e=i,a[3]=!0,w(t)):"click"===t.type&&i?(e=i,w(t)):e=a=null}}))}($);var je,Ee=window.pa_grade_types={};function Le(t,e){e.type=t,e.tcell=e.tcell||e.text,Ee[t]=e}function Oe(t,e){var a='<div class="pa-pd"><span class="pa-gradewidth"><input type="text" class="uich pa-gradevalue pa-gradewidth" name="'.concat(this.key,'" id="',t,'"></span> <span class="pa-gradedesc">');return e.max_text?a+=e.max_text:this.max&&(a+="of "+this.max),a+"</span></div>"}function Ie(t,e,a){var n,i=t.key,r=t.title?Y(t.title):i,s=Ee[t.type||"numeric"];if((e||t.student)&&s.entry){a=!1!==a;var o={editable:e},l="pa-ge"+ ++Ie.id_counter;n=(a?'<form class="ui-submit ':'<div class="')+"pa-grade pa-p","section"===t.type&&(n+=" pa-p-section"),!1===t.visible&&(n+=" pa-p-hidden"),n=n.concat('" data-pa-grade="',i),a||(n=n.concat('" data-pa-grade-type="',s.type)),n=n.concat('"><label class="pa-pt" for="',l,'">',r,"</label>"),t.edit_description&&(n+='<div class="pa-pdesc">'+Y(t.edit_description)+"</div>"),n+=s.entry.call(t,l,o)+(a?"</form>":"</div>")}else n='<div class="pa-grade pa-p',"section"===t.type&&(n+=" pa-p-section"),n+='" data-pa-grade="'+i+'"><div class="pa-pt">'+r+"</div>","text"===t.type?n+='<div class="pa-pd pa-gradevalue"></div>':(n+='<div class="pa-pd"><span class="pa-gradevalue pa-gradewidth"></span>',t.max&&"letter"!==t.type&&(n+=' <span class="pa-gradedesc">of '+t.max+"</span>"),n+="</div>"),n+="</div>";return n}function De(){var t=We.call(this);"checkbox"===this.type&&(this.value=this.checked?t.max:""),this.type="text",this.className=(m(this,"ui")||m(this,"uich")?"uich ":"")+"pa-gradevalue pa-gradewidth";var e=this.closest(".pa-pd");$(e).find(".pa-grade-uncheckbox").remove(),$(e).find('input[name^="'+this.name+':"]').addClass("hidden")}function Pe(){var t=this.value.trim(),e=We.call(this);this.type="checkbox",this.checked=""!==t&&"0"!==t,this.value=e.max,this.className=(m(this,"uich")?"ui ":"")+"pa-gradevalue",$(this.closest(".pa-pd")).find(".pa-gradedesc").append(' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a>')}function Re(t,e,a,n){var i,r=$(this),s=r.find(".pa-gradevalue"),o=s[0]&&"SPAN"!==s[0].tagName&&"DIV"!==s[0].tagName,l=Ee[t.type||"numeric"];if(t.max&&o&&(!e||e<=t.max?r.find(".pa-gradeabovemax").remove():r.find(".pa-gradeabovemax").length||r.find(".pa-pd").after('<div class="pa-pd pa-gradeabovemax">Grade is above max</div>')),o)if(null==a||e===a)r.find(".pa-gradediffers").remove();else{var u=("late_hours"===t.key?"auto-late hours":"autograde")+" is "+l.text.call(t,a);r.find(".pa-gradediffers").length||r.find(".pa-pd").first().append('<span class="pa-gradediffers"></span>');var d=r.find(".pa-gradediffers");d.text()!==u&&d.text(u)}if(o?(i=null==e?"":l.text.call(t,e,!0),l.reflect_value?l.reflect_value.call(t,s[0],e,n||{}):s.val()!==i&&(!s.is(":focus")||n&&n.reset)&&s.val(i),s[0].hasAttribute("placeholder")&&(s[0].removeAttribute("placeholder"),"select"===l.type&&""===s[0].options[0].value&&s[0].remove(0)),"checkbox"===s[0].type?(s[0].checked=!!e,s[0].indeterminate=n&&n.mixed):s.val()!==i&&(!s.is(":focus")||n&&n.reset)&&s.val(i),n&&n.reset&&(s[0].setAttribute("data-default-value",null==e?"":l.text.call(t,e,!0)),n.mixed&&(s[0].setAttribute("placeholder","Mixed"),"select"===l.type&&(s.prepend('<option value="">Mixed</option>'),s[0].selectedIndex=0)))):(i=l.text.call(t,e,!1),s.text()!==i&&s.text(i),x(this,"hidden",""===i&&!t.max&&"section"!==t.type)),t.landmark&&this.parentElement&&m(this.parentElement,"want-pa-landmark-links")){var h=/^(.*):(\d+)$/.exec(t.landmark),c=$(bt(h[1],"a"+h[2])),p="";if(c.length){var f=$(this).closest(".pa-psetinfo")[0].getAttribute("data-pa-directory")||"";f&&h[1].substr(0,f.length)===f&&(h[1]=h[1].substr(f.length)),p='@<a href="#'+c[0].id+'" class="ui pa-goto">'+Y(h[1]+":"+h[2])+"</a>"}var g=r.find(".pa-gradeboxref");c.length?g.length&&g.html()===p||(g.remove(),r.find(".pa-pd").first().append('<span class="pa-gradeboxref">'+p+"</span>")):g.remove()}}function Fe(){for(var t=this.closest(".pa-psetinfo"),e=null;t;){var a=$(t).data("pa-gradeinfo");if("string"==typeof a&&(a=JSON.parse(a),$(t).data("pa-gradeinfo",a)),(e=e?$.extend(e,a):a)&&e.entries)break;t=t.parentElement.closest(".pa-psetinfo")}return e}function We(){var t=this.closest(".pa-grade");return Fe.call(t).entries[t.getAttribute("data-pa-grade")]}function He(t){t=t||Fe.call(this);var e=this.getAttribute("data-pa-grade"),a=t.entries[e];"late_hours"===e?Re.call(this,{key:"late_hours"},t.late_hours,t.auto_late_hours):a&&Re.call(this,a,t.grades?t.grades[a.pos]:null,t.autogrades?t.autogrades[a.pos]:null)}function Be(){b(this,"need-pa-grade");var t,e=this.getAttribute("data-pa-grade"),a=Fe.call(this);if(a&&e&&(t=a.entries[e])&&($(this).html(Ie(t,a.editable)),$(this).find(".need-autogrow").autogrow(),He.call($(this).find(".pa-grade")[0],a),t.landmark_range&&this.closest(".pa-gradebox")&&Je.call(this.firstChild,t),this.hasAttribute("data-pa-landmark-buttons")))for(var n=JSON.parse(this.getAttribute("data-pa-landmark-buttons")),i=0;i<n.length;++i)"string"==typeof n[i]?$(this).find(".pa-pd").first().append(n[i]):n[i].className&&$(this).find(".pa-pd").first().append('<button type="button" class="btn uic uikd pa-grade-button" data-pa-grade-button="'+n[i].className+'">'+n[i].title+"</button>")}function Ue(){b(this,"need-pa-gradelist"),v(this,"pa-gradelist");var t=this.closest(".pa-psetinfo"),e=Fe.call(t);if(e){for(var a=this.firstChild;a&&!m(a,"pa-grade");)a=a.nextSibling;for(var n=0;n!==e.order.length;++n){var i=e.order[n];if(i)if(a&&a.getAttribute("data-pa-grade")===i)a=a.nextSibling;else{var r=$(Ie(e.entries[i],e.editable))[0];this.insertBefore(r,a),He.call(r,e)}}for(;a;){r=a;a=a.nextSibling,this.removeChild(r)}$(this).find(".need-autogrow").autogrow()}}function ze(){if(!m(this,"pa-psetinfo"))throw new Error("bad pa_loadgrades");var t=Fe.call(this);if(t&&t.order){$(this).find(".need-pa-grade").each((function(){Be.call(this,!0)})),$(this).find(".pa-gradelist").each((function(){Ue.call(this,!0)})),$(this).find(".pa-grade").each((function(){var e=this.getAttribute("data-pa-grade"),a=t.entries[e];"late_hours"===e?Re.call(this,{key:"late_hours"},t.late_hours,t.auto_late_hours):a&&Re.call(this,a,t.grades?t.grades[a.pos]:null,t.autogrades?t.autogrades[a.pos]:null)}));var e=Ke(t),a=""+e[0],n=!1;e[0]&&$(this).find(".pa-gradelist:not(.pa-gradebox)").each((function(){$(this).find(".pa-total").length||$(this).prepend(function(t,e){var a='<div class="pa-total pa-p',n=0;for(var i in t.entries)"text"!==t.entries[i].type&&"select"!==t.entries[i].type&&"section"!==t.entries[i].type&&++n;return n<=1&&(a+=" hidden"),a+'"><div class="pa-pt">total</div><div class="pa-pd"><span class="pa-gradevalue pa-gradewidth"></span> <span class="pa-gradedesc">of '+e[1]+"</span></div></div>"}(t,e))})),$(this).find(".pa-total").each((function(){var t=$(this).find(".pa-gradevalue");t.text()!==a&&(t.text(a),n=!0)})),n&&Xe($(this).find(".pa-grgraph"))}}function qe(t,e,a,n){var i=-1,r=-1,s=this;if("function"==typeof t){a=t,n=e;var o=We.call(this),l=o&&o.landmark_range?/:(\d+):(\d+)$/.exec(o.landmark_range):null;if(!l||!(s=s.closest(".pa-filediff")))return null;t=+l[1],e=+l[2]}for(;s=yt(s,!0,3);){var u=s.firstChild;u.hasAttribute("data-landmark")&&(i=+u.getAttribute("data-landmark")),(u=u.nextSibling)&&u.hasAttribute("data-landmark")&&(r=+u.getAttribute("data-landmark")),i>=t&&i<=e&&(!n||s.matches(n))&&a.call(this,s,i,r)}}function Je(t,e){var a=this.closest(".pa-grade"),n=$(a).find(".pa-pt").html(),i=null;t||(t=We.call(a)),qe.call(this,(function(t,e,a){var r,s,o=Me(t);o[1]&&((r=/^[\s❮→]*(\+)(\d+(?:\.\d+)?|\.\d+)((?![.,]\w|[\w%$*])\S*?)[.,;:❯]?(?:\s|$)/.exec(o[1]))||(r=/^[\s❮→]*()(\d+(?:\.\d+)?|\.\d+)(\/[\d.]+(?![.,]\w|[\w%$*\/])\S*?)[.,;:❯]?(?:\s|$)/.exec(o[1])))&&(null===i&&(i=0),i+=parseFloat(r[2]),s=n+": "+Y(r[1])+"<b>"+Y(r[2])+"</b>"+Y(r[3]));var l=$(t).find(".pa-note-gradecontrib");!l.length&&s&&(l=$('<div class="pa-note-gradecontrib"></div>').insertBefore($(t).find(".pa-note"))),s?l.html(s):l.remove()}),".pa-gw"),t.round&&null!=i&&(i="up"===t.round?Math.ceil(i):"down"===t.round?Math.floor(i):Math.round(i));var r=$(this).find(".pa-notes-grade");if(null===i)r.remove();else{if(!r.length){r=$('<a class="uic uikd pa-notes-grade" href=""></a>');for(var s=this.lastChild.firstChild;s&&(1!==s.nodeType||m(s,"pa-gradewidth")||m(s,"pa-gradedesc"));)s=s.nextSibling;this.firstChild.nextSibling.insertBefore(r[0],s)}r.text("Notes grade "+i)}var o=$(this).find(".pa-gradevalue")[0];if(o){var l,u=null===i?"":""+i;e&&(l=$(o).val())==o.getAttribute("data-pa-notes-grade")&&u!=l&&$(o).val(u).change(),o.setAttribute("data-pa-notes-grade",u)}return i}function Ke(t,e){"string"==typeof t&&(t=JSON.parse(t));for(var a=0,n=0;n<t.order.length;++n){var i=t.order[n],r=i?t.entries[i]:null;!r||!r.in_total||e&&r.is_extra||(a+=t.grades&&t.grades[n]||0)}return[Math.round(1e3*a)/1e3,Math.round(1e3*t.maxtotal)/1e3]}function Ve(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Xe(e){var a=e.data("paGradeData");if(!a)return e.addClass("hidden"),void e.removeData("paGradeGraph");var n=e.closest(".pa-psetinfo"),i=!n.length||n[0].hasAttribute("data-pa-user-extension"),r=[];a.series.extension&&n.length&&i&&r.push("cdf-extension","pdf-extension"),r.push("cdf","pdf"),a.series.extension&&!n.length&&r.push("cdf-extension","pdf-extension"),a.series.noextra&&r.push("cdf-noextra","pdf-noextra"),r.push("all"),e[0].setAttribute("data-pa-gg-types",r.join(" "));var s=e[0].getAttribute("data-pa-gg-type");if(s||(s=t(!0,"pa-gg-type")),!s){var o=t(!1,"pa-gg-type");if(o&&"{"===o[0])try{"string"==typeof(o=JSON.parse(o)).type&&"number"==typeof o.at&&o.at>=ge()-7200&&(s=o.type)}catch(t){}}s&&"default"!==s||(s=r[0]),r.indexOf(s)<0&&(s="pdf"===s.substring(0,3)?r[1]:r[0]),e[0].setAttribute("data-pa-gg-type",s),e.removeClass("cdf pdf all cdf-extension pdf-extension all-extension cdf-noextra pdf-noextra all-noextra"),e.addClass(s);var l="all"===s.substring(0,3),u=(s.substring(0,3),l||s.substring(0,3),s.indexOf("-extension")>=0||l&&i&&a.extension),d=s.indexOf("-noextra")>=0||l&&a.series.noextra&&!u,h=0;d&&(h=Math.max(h,a.series.noextra.max())),u&&(h=Math.max(h,a.series.extension.max())),(l||!d&&!u)&&(h=Math.max(h,a.series.all.max()));a.maxtotal&&Math.max(h,a.maxtotal);e.removeClass("hidden");var c=e.find(".plot");c.length||(c=e);var p=new ue(c[0],a,s);(e.data("paGradeGraph",p),p.total&&p.total<p.max)&&((w=Ve("line")).setAttribute("x1",p.xax(p.total)),w.setAttribute("y1",p.yax(0)),w.setAttribute("x2",p.xax(p.total)),w.setAttribute("y2",p.yax(1)),w.setAttribute("class","pa-gg-anno-total"),p.gg.appendChild(w));var f=Math.ceil((p.max-p.min)/2),g=.08,m={};for(var x in"pdf-extension"===s&&(m.extension=new Qt(a.series.extension,p,g,f)),"pdf-noextra"===s&&(m.noextra=new Qt(a.series.noextra,p,g,f)),"pdf"===s&&(m.main=new Qt(a.series.all,p,g,f)),m)p.maxp=Math.max(p.maxp,m[x].maxp);if("pdf-noextra"===s&&p.append_pdf(m.noextra,"pa-gg-pdf pa-gg-noextra"),"pdf"===s&&p.append_pdf(m.main,"pa-gg-pdf"),"pdf-extension"===s&&p.append_pdf(m.extension,"pa-gg-pdf pa-gg-extension"),("cdf-noextra"===s||"all"===s&&a.series.noextra)&&p.append_cdf(a.series.noextra,"pa-gg-cdf pa-gg-noextra"),"cdf"!==s&&"all"!==s||p.append_cdf(a.series.all,"pa-gg-cdf"),("cdf-extension"===s||"all"===s&&a.series.extension&&i)&&p.append_cdf(a.series.extension,"pa-gg-cdf pa-gg-extension"),a.cutoff&&"pdf"!==s.substring(0,3)){var y=Ve("rect");y.setAttribute("x",p.xax(0)),y.setAttribute("y",p.yax(a.cutoff)),y.setAttribute("width",p.xax(p.max)),y.setAttribute("height",p.yax(0)-p.yax(a.cutoff)),y.setAttribute("fill","rgba(255,0,0,0.1)"),p.gg.appendChild(y)}var w=null,A=n.data("pa-gradeinfo");A&&(w=Ke(A,d&&!l)[0]),null!=w&&p.annotate_last_curve(w),p.xaxis(),p.yaxis(),e[0].hasAttribute("data-pa-highlight")&&p.highlight_users(),p.hover(),e.find(".statistics").each((function(){var t=p.last_curve_series,e=[];if(t&&t.mean&&e.push("mean "+t.mean.toFixed(1)),t&&t.median&&e.push("median "+t.median.toFixed(1)),t&&t.stddev&&e.push("stddev "+t.stddev.toFixed(1)),e=[e.join(", ")],t&&null!=w){var a=t.count_at(w);t.cutoff&&a<t.cutoff*t.n?e.push("≤"+Math.round(100*t.cutoff)+" %ile"):e.push(Math.round(Math.min(Math.max(1,100*a/t.n),99))+" %ile")}e.length?(b(this,"hidden"),this.innerHTML=e.join(" · ")):(v(this,"hidden"),this.innerHTML="")})),e.find(".pa-grgraph-type").each((function(){var t=[];s.startsWith("cdf")?t.push("CDF"):s.startsWith("pdf")&&t.push("PDF"),u&&!l&&t.push("extension"),d&&!l&&t.push("no extra credit");var e=t.length?" ("+t.join(", ")+")":"";this.innerHTML="grade statistics"+e})),p.highlight_users()}function Ge(t){t=t.replace(/^[^#]*/,"");for(var e,a=/([^#=\/]+)[=\/]?([^\/]*)/g,n={};e=a.exec(t);)n[e[1]]=decodeURIComponent(e[2].replace(/\+/g," "));return n}function Ye(t){var e=Ge(location.hash);for(var a in t)null===t[a]||void 0===t[a]?delete e[a]:e[a]=t[a];var n=function(t){var e=[];for(var a in t)null===t[a]||void 0===t[a]||""===t[a]?e.push(a):e.push(a+"="+encodeURIComponent(t[a]).replace(/%20/g,"+"));return e.sort(),e.length?"#"+e.join("/"):""}(e);n!==location.hash&&he(location.origin+location.pathname+location.search+n)}Le("numeric",{text:function(t){return null==t?"":t+""},entry:Oe}),Le("formula",{text:function(t){return null==t?"":t.toFixed(1)}}),Le("text",{text:function(t){return null==t?"":t},entry:function(t,e){return'<div class="pa-pd"><textarea class="uich pa-pd pa-gradevalue need-autogrow" name="'.concat(this.key,'" id="',t,'"></textarea></div>')},justify:"left",sort:"forward"}),Le("select",{text:function(t){return null==t?"":t},entry:function(t,e){for(var a='<div class="pa-pd"><span class="select"><select class="uich pa-gradevalue" name="'.concat(this.key,'" id="',t,'"><option value="">None</option>'),n=0;n!==this.options.length;++n){var i=Y(this.options[n]);a=a.concat('<option value="',i,'">',i,"</option>")}return a+"</select></span></div>"},justify:"left",sort:"forward"}),Le("checkbox",{text:function(t,e){return e?t+"":null==t||0===t?"–":t==(this.max||1)?"✓":t+""},tcell:function(t){return null==t||0===t?"":t==(this.max||1)?"✓":t+""},entry:function(t,e){var a='<div class="pa-pd"><span class="pa-gradewidth"><input type="checkbox" class="ui pa-gradevalue ml-0" name="'.concat(this.key,'" id="',t,'" value="',this.max,'"></span>');return e.editable&&(a=a.concat(' <span class="pa-gradedesc">of ',this.max,' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>')),a+"</div>"},justify:"center",reflect_value:function(t,e,a){var n=null==e||""===e||0===e||this&&e===this.max;n||"checkbox"!==t.type?n&&"checkbox"!==t.type&&a.reset&&Pe.call(t):De.call(t),"checkbox"===t.type?(t.checked=!!e,t.indeterminate=a.mixed):t.value===e||!a.reset&&$(t).is(":focus")||(t.value=e+"")}}),function(){function t(t){return{text:function(e,a){return a?e+"":null==e||0===e?"–":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):e+""},tcell:function(e){return null==e||0===e?"":e>0&&Math.abs(e-Math.round(e))<.05?t.repeat(Math.round(e)):e+""},entry:function(t,e){for(var a='<div class="pa-pd"><span class="pa-gradewidth"><input type="hidden" class="uich pa-gradevalue" name="'.concat(this.key,'">'),n=0;n<this.max;++n)a=a.concat('<input type="checkbox" class="ui js-checkboxes-grade ml-0" name="',this.key,":",n,'" value="1"'),n===this.max-1&&(a+=' id="'+t+'"'),a+=">";return a+="</span>",e.editable&&(a+=' <span class="pa-gradedesc">of '+this.max+' <a href="" class="x ui pa-grade-uncheckbox" tabindex="-1">#</a></span>'),a+"</div>"},justify:"left",reflect_value:function(t,e,a){var n=null==e||""===e||0===e||e>=0&&(!this||e<=this.max)&&Math.abs(e-Math.round(e))<.05;n||"hidden"!==t.type?n&&"hidden"!==t.type&&a.reset&&Pe.call(t):De.call(t),t.value===e||!a.reset&&$(t).is(":focus")||(t.value=e);var i=t.name+":",r=Math.round(e||0);$(t.closest(".pa-pd")).find("input[type=checkbox]").each((function(){if(this.name.startsWith(i)){var t=+this.name.substring(i.length);this.checked=t<r,this.indeterminate=a.mixed}}))}}}Le("checkboxes",t("✓")),Le("stars",t("⭐")),k.on("js-checkboxes-grade",(function(t){var e=this.name.indexOf(":"),a=this.name.substring(0,e),n=this.name.substring(e+1),i=this.closest("form").elements[a],r=this.checked?+n+1+"":n;i.value!==r&&(i.value=r,$(i).trigger("change"))}))}(),Le("section",{text:function(){return""},entry:function(){return""}}),je={98:"A+",95:"A",92:"A-",88:"B+",85:"B",82:"B-",78:"C+",75:"C",72:"C-",68:"D+",65:"D",62:"D-",50:"F"},Le("letter",{text:function(t){return null==t?"":je[t]||t+""},entry:function(t,e){return e.max_text="letter grade",Oe.call(this,t,e)},justify:"left",tics:function(){var t=[];for(var e in je)1===je[e].length&&t.push({x:e,text:je[e]});for(var e in je)2===je[e].length&&t.push({x:e,text:je[e],label_space:5});for(var e in je)2===je[e].length&&t.push({x:e,text:je[e].substring(1),label_space:2,notic:!0});return t}}),Ie.id_counter=0,k.on("pa-grade-uncheckbox",(function(){$(this.closest(".pa-pd")).find(".pa-gradevalue").each((function(){De.call(this),this.focus(),this.select()}))})),k.on("pa-gradevalue",(function(t){var e,a,n=this.closest("form"),i=this;n&&m(n,"pa-grade")?$(n).submit():"hidden"===i.type&&(e=i.closest(".pa-grade").getAttribute("data-pa-grade-type"))&&(a=Ee[e]).reflect_value&&setTimeout((function(){a.reflect_value.call(null,i,+i.value,{})}),0)})),function(){function t(t){var e=$(t);e.find(".pa-gradediffers, .pa-save-message").remove();var a=e.find(".pa-pd").first(),n=a.find(".pa-gradedesc");n.length||($(a[0].firstChild).after(' <span class="pa-gradedesc"></span>'),n=a.find(".pa-gradedesc")),n.append('<span class="pa-save-message"><span class="spinner"></span></span>');var i=Fe.call(t),r={},s={};e.find("input.pa-gradevalue, textarea.pa-gradevalue, select.pa-gradevalue").each((function(){var t=i.entries[this.name];i.grades&&t&&null!=i.grades[t.pos]?s[this.name]=i.grades[t.pos]:"late_hours"===this.name&&null!=i.late_hours&&(s[this.name]=i.late_hours),"checkbox"!==this.type&&"radio"!==this.type||this.checked?r[this.name]=this.value:"checkbox"===this.type&&(r[this.name]=0)})),e.data("paOutstandingPromise",new Promise((function(a,n){R(c("api/grade",p(e[0])),{grades:r,oldgrades:s}).then((function(i){e.removeData("paOutstandingPromise"),i.ok?(e.find(".pa-save-message").html('<span class="savesuccess"></span>').addClass("fadeout"),$(t).closest(".pa-psetinfo").data("pa-gradeinfo",i).each(ze),a(t)):(e.find(".pa-save-message").html('<strong class="err">'+i.error+"</strong>"),n(t))}))})))}k.on("pa-grade",(function(e){e.preventDefault();var a=$(this).data("paOutstandingPromise");a?a.then(t):t(this)}))}(),k.on("pa-grade-button",(function(t){if("keydown"===t.type){var e,a=j(t);if(t.ctrlKey&&("n"===a||"N"===a||"p"===a||"P"===a||"A"===a)&&(e=this.closest(".pa-grade"))){var n=e.getAttribute("data-pa-grade"),i=$(".pa-grade[data-pa-grade="+n+"] .pa-grade-button[data-pa-grade-button="+this.getAttribute("data-pa-grade-button")+"]").filter(":visible"),r=i.toArray().indexOf(this);if(r>=0){if("n"===a||"N"===a||"p"===a||"P"===a){var s=i[(r+("n"===a||"N"===a?1:i.length-1))%i.length],o=s.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),s.focus(),$(s).scrollIntoView()}else i.click();t.preventDefault()}}}else"click"===t.type&&k.trigger.call(this,this.getAttribute("data-pa-grade-button"),t)})),$((function(){$(".need-pa-grade").each(Be),$(".need-pa-gradelist").each(Ue)})),k.on("pa-notes-grade",(function(t){if("keydown"===t.type){var e,a=j(t);if(t.ctrlKey&&("n"===a||"N"===a||"p"===a||"P"===a||"A"===a)&&(e=this.closest(".pa-grade"))){var n=e.getAttribute("data-pa-grade"),i=$(".pa-grade[data-pa-grade="+n+"] .pa-notes-grade").filter(":visible"),r=i.toArray().indexOf(this);if(r>=0){if("n"===a||"N"===a||"p"===a||"P"===a){var s=i[(r+("n"===a||"N"===a?1:i.length-1))%i.length],o=s.closest(".pa-dg");o&&$(o).scrollIntoView({marginTop:24,atTop:!0}),s.focus(),$(s).scrollIntoView()}else i.click();t.preventDefault()}}}else if("click"===t.type){var l=$(this).closest(".pa-grade").find(".pa-gradevalue");l.length&&l.val()!=l.attr("data-pa-notes-grade")&&l.val(l.attr("data-pa-notes-grade")).change(),t.preventDefault()}})),k.on("js-grgraph-flip",(function(){var e=$(this).closest(".pa-grgraph"),a=(e[0].getAttribute("data-pa-gg-types")||"").split(/ /),n=e[0].getAttribute("data-pa-gg-type"),i=a.indexOf(n);i>=0&&(i=(i+(m(this,"prev")?a.length-1:1))%a.length,e[0].setAttribute("data-pa-gg-type",a[i]),t(!0,"pa-gg-type",a[i]),t(!1,"pa-gg-type",{type:a[i],at:ge()}),Xe(e))})),function(){var t=m(document.body,"want-grgraph-hash");function e(t,e,a){var n="data-pa-highlight"+("main"===e?"":"-"+e);a=a||"",$(t).find(".pa-grgraph").each((function(){var t=this.getAttribute(n)||"",i=this;t===a||"main"!==e&&"course"===this.getAttribute("data-pa-pset")||(a?this.setAttribute(n,a):this.removeAttribute(n),window.requestAnimationFrame((function(){var t=$(i).data("paGradeGraph");t&&t.highlight_users()})))}))}function a(t,n){var i,r={},s={},o=!1;for(var l of t.match(/[-\d.]+/g)||[])r[l]=!0;if($(".js-grgraph-highlight-course").each((function(){var t,e=this.getAttribute("data-pa-highlight-range")||"90-100",a=this.getAttribute("data-pa-highlight-type")||"h00";if(s[a]=s[a]||[],this.checked=!!r[e])if(t=e.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-([-+]?(?:\d+\.?\d*|\.\d))(\.?)$/))s[a].push(+t[1],+t[2]+(t[3]?1e-5:0)),o=!0;else{if(!(t=e.match(/^([-+]?(?:\d+\.?\d*|\.\d+))-$/)))throw new Error("bad range");s[a].push(+t[1],1/0),o=!0}})),o)if(i=function(){var t=null;return $(".pa-grgraph[data-pa-pset=course]").each((function(){var e=$(this).data("paGradeData");if(e&&e.series.all&&e.series.all.cdfu)return t=e.series.all,!1})),t}())for(var u in s){var d=[];if((r=s[u]).length){for(var h=0;h!==i.cdf.length;h+=2)for(var c=0;c!==r.length;c+=2)if(i.cdf[h]>=r[c]&&i.cdf[h]<r[c+1]){var p=h?i.cdf[h-1]:0;Array.prototype.push.apply(d,i.cdfu.slice(p,i.cdf[h+1]));break}d.sort()}e(document.body,u,d.join(" "))}else setTimeout((function(){a(Ge(location.hash).hr||"",n+1)}),8<<Math.max(n,230));else for(var u in s)e(document.body,u,"")}function n(t){var n=Ge(t);for(var i of(e(document.body,"main",n.hs||""),$("input[type=checkbox].js-grgraph-highlight").prop("checked",!1),(n.hs||"").match(/\d+/g)||[]))$("tr[data-pa-uid="+i+"] input[type=checkbox].js-grgraph-highlight").prop("checked",!0);for(var r of(a(n.hr||"",0),$(".js-grgraph-highlight-course").prop("checked",!1),(n.hr||"").match(/[-\d.]+/g)||[]))$('.js-grgraph-highlight-course[data-pa-highlight-range="'+r+'"]').prop("checked",!0)}k.on("js-grgraph-highlight",(function(a){if("change"===a.type){var n=this.getAttribute("data-range-type"),i=($(this).closest("form").find("input[type=checkbox]"),[]);$(this).closest("form").find("input[type=checkbox]").each((function(){var t;this.getAttribute("data-range-type")===n&&this.checked&&(t=this.closest("tr"))&&t.hasAttribute("data-pa-uid")&&i.push(+t.getAttribute("data-pa-uid"))})),i.sort((function(t,e){return t-e})),t?(Ye({hs:i.length?i.join(" "):null}),e(document.body,"main",i.join(" "))):e(this.closest("form"),"main",i.join(" "))}})),k.on("js-grgraph-highlight-course",(function(e){var n=[];$(".js-grgraph-highlight-course").each((function(){this.checked&&n.push(this.getAttribute("data-pa-highlight-range"))})),t&&Ye({hr:n.length?n.join(" "):null}),a(n.join(" "),0)})),t&&($(window).on("popstate",(function(t){var e=(t.originalEvent||t).state;e&&e.href&&n(e.href)})).on("hashchange",(function(t){n(location.href)})),$((function(){n(location.href)})))}(),$((function(){var t=document.body.getAttribute("data-now")-(new Date).getTime()/1e3;$(".pa-download-timed").each((function(){var e=this,a=setInterval(n,15e3);function n(){var n,i=+e.getAttribute("data-pa-download-at"),r=+e.getAttribute("data-pa-commit-at"),o=+e.getAttribute("data-pa-download-expiry"),l=(new Date).getTime()/1e3+t;n=l>o?s("%Y/%m/%d %H:%M",i):Math.round((l-i)/60)+" min",r>i&&(n+=" · "+Math.round((r-i)/60)+" min before commit"),$(e).find(".pa-download-timer").text(n),l>o&&clearInterval(a)}n()}))})),k.on("pa-anonymized-link",(function(t){var e=this.getAttribute("data-pa-link");t&&t.metaKey?window.open(e):window.location=e})),window.$pa={beforeunload:function(t){var e=!0;if($(".pa-gw textarea").each((function(){var t=this.closest(".pa-dl"),a=Me(t);!a||pe(this.value,a[1])||m(t,"pa-save-failed")||(e=!1)})),!e)return event.returnValue="You have unsaved notes. You will lose them if you leave the page now."},checklatest:function(){var t,e,a,n=(new Date).getTime();function i(n){!n||!n.hash||n.hash===a||n.snaphash&&n.snaphash===a||($(".pa-commitcontainer .pa-pd").first().append('<div class="pa-inf-error"><span class="pa-inf-alert">Newer commits are available.</span> <a href="'+h("pset",{u:peteramati_uservalue,pset:e,commit:n.hash})+'">Load them</a></div>'),clearTimeout(t))}(e=$(".pa-commitcontainer").first().attr("data-pa-pset"))&&(a=$(".pa-commitcontainer").first().attr("data-pa-commit"),setTimeout((function r(){var s=(new Date).getTime();t=s-n<=6e4?setTimeout(r,a?1e4:2e3):s-n<=6e5?setTimeout(r,a?2e4:1e4):s-n<=36e5?setTimeout(r,1.25*(s-n)):null,$.ajax(c("api/latestcommit",{u:peteramati_uservalue,pset:e}),{type:"GET",cache:!1,dataType:"json",success:i})}),2e3))},filediff_markdown:Nt,fold:Ce,gradecdf:function(){var t=this,e=t.getAttribute("data-pa-pset");$.ajax(c("api/gradestatistics",e?{pset:e}:{}),{type:"GET",cache:!0,dataType:"json",success:function(e){e.series&&e.series.all&&($(t).data("paGradeData",new Zt(e)),Xe($(t)))}})},onload:_e,loadgrades:ze,load_runsettings:function(t){var e,a,n=$("#pa-runsettings"),i=n.find(".n");for(a in i.attr("data-outstanding","1"),t){for(e=0;e!=i.length&&$.trim($(i[0]).val())!=a;++e);e==i.length?Gt(a,t[a]):$.trim(n.find("[name=v"+e+"]").val())!=t[a]&&(n.find("[name=v"+e+"]").val(t[a]),$(i[e]).removeAttr("data-outstanding"))}for(e=0;e!=i.length;++e)$(i[e]).attr("data-outstanding")&&$("[data-runsetting-num="+$(i[e]).attr("name").substr(1)+"]").remove()},pset_actions:function(){var t=$(this);function e(){var e=t.find("select[name='state']").val();t.find(".pa-if-enabled").toggleClass("hidden","disabled"===e),t.find(".pa-if-visible").toggleClass("hidden","disabled"===e||"invisible"===e)}e(),t.find("select[name='state']").on("change",e),t.find("input, select").on("change",(function(){t.find("[type='submit']").addClass("alert")})),t.removeClass("need-pa-pset-actions")},render_text_page:Rt.on_page,render_pset_table:function(a,n){var i,r,o,l,u,d,p,f,g,y,w,A=$(this),_=0,k=[],C=null,M=a.flagged_commits,S=a.grades_visible,T={f:M?"at":"username",last:!0,rev:1},N=-1,j=null,E=a.anonymous,L={checkbox:{th:'<th class="gt-checkbox" scope="col"></th>',td:function(t,e){return""==e?"<td></td>":'<td class="gt-checkbox"><input type="checkbox" name="'+z(t)+'" value="1" class="'+(this.className||"uic js-range-click papsel")+'" data-range-type="s61"></td>'},tw:1.5},rownumber:{th:'<th class="gt-rownumber" scope="col"></th>',td:function(t,e){return""==e?"<td></td>":'<td class="gt-rownumber">'+e+".</td>"},tw:.75*Math.ceil(Math.log10(Math.max(n.length,1)))+1},pset:{th:'<th class="gt-pset l plsortable" data-pa-sort="pset" scope="col">Pset</th>',td:function(t){return'<td class="gt-pset"><a href="'+F(t)+'" class="track">'+Y(peteramati_psets[t.psetid].title)+(t.hash?"/"+t.hash.substr(0,7):"")+"</a></td>"},tw:12},at:{th:'<th class="gt-at l plsortable" data-pa-sort="at" scope="col">Flagged</th>',td:function(t){return'<td class="gt-at">'+(t.at?s("%#e %b %#k:%M",t.at):"")+"</td>"},tw:8},username:{th:function(){var t='<span class="heading">'+(E||!T.email?"Username":"Email")+"</span>";return a.anonymous&&a.can_override_anonymous?t+=' <a href="" class="uu n js-switch-anon">[anon]</a>':a.anonymous&&(t+=' <span class="n">[anon]</span>'),'<th class="gt-username l plsortable" data-pa-sort="username" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-username">'+H(t)+"</td>"},tw:12,pin:!0},name:{th:function(){return'<th class="gt-name l plsortable" data-pa-sort="name" scope="col">Name</th>'},td:function(t){return'<td class="gt-name">'+U(t,!1)+"</td>"},tw:14},name2:{th:function(){var t='<span class="heading">'+(E?"Username":"Name")+"</span>";return a.anonymous&&a.can_override_anonymous&&(t+=' <a href="" class="uu n js-switch-anon">[anon]</a>'),'<th class="gt-name2 l plsortable" data-pa-sort="name2" scope="col">'+t+"</th>"},td:function(t){return'<td class="gt-name2">'+U(t,!0)+"</td>"},tw:14},extension:{th:'<th class="gt-extension l plsortable" data-pa-sort="extension" scope="col">X?</th>',td:function(t){return'<td class="gt-extension">'+(t.x?"X":"")+"</td>"},tw:2},grader:{th:'<th class="gt-grader l plsortable" data-pa-sort="grader" scope="col">Grader</th>',td:function(t){var e=t.gradercid?"???":"";return t.gradercid&&siteinfo.pc[t.gradercid]&&(e=q(siteinfo.pc[t.gradercid])),'<td class="gt-grader">'+e+"</td>"},tw:6},notes:{th:'<th class="gt-notes l plsortable" data-pa-sort="gradestatus" scope="col">⎚</th>',td:function(t){var e="";return t.grades_visible&&(e+="⎚"),M&&t.is_grade&&(e+="✱"),t.has_notes&&(e+="♪"),!M&&t.has_nongrader_notes&&(e+="<sup>*</sup>"),'<td class="gt-notes">'+e+"</td>"},tw:2},conversation:{th:'<th class="gt-conversation l" scope="col">Flag</th>',td:function(t){return'<td class="gt-conversation l">'+Y(t.conversation||t.conversation_pfx||"")+(t.conversation_pfx?"…":"")+"</td>"},tw:20},gdialog:{th:"<th></th>",td:function(t){return'<td><a href="" class="ui x js-gdialog" tabindex="-1" scope="col">Ⓖ</a></td>'},tw:1.5,pin:!0},total:{th:'<th class="gt-total r plsortable" data-pa-sort="total" scope="col">Tot</th>',td:function(t){return'<td class="gt-total r">'+t.total+"</td>"},tw:3},grade:{th:function(){return'<th class="'+("right"===this.justify?"gt-grade r":"gt-grade l")+' plsortable" data-pa-sort="grade'+this.gidx+'" scope="col">'+this.gabbr+"</th>"},td:function(t,e,a){var n=t.grades[this.gidx],i=Y(this.typeinfo.tcell.call(this.ge,n));if(a)return i;var r='<td class="'+this.klass;return t.highlight_grades&&t.highlight_grades[this.gkey]&&(r+=" gt-highlight"),r+'">'+i+"</td>"},tw:function(){var t=0;if(this.klass=this.gkey===a.total_key?"gt-total":"gt-grade","right"===this.justify&&(this.klass+=" r"),"select"===this.typeinfo.type){this.klass+=" gt-el";for(var e=0;e!==this.ge.options.length;++e)t=Math.max(t,this.ge.options[e].length);t=Math.floor(1.25*Math.min(t,10))/2}else t=3;return Math.max(t,.5*this.gabbr.length+1.5)}},ngrades:{th:'<th class="gt-ngrades r plsortable" data-pa-sort="ngrades" scope="col">#G</th>',td:function(t){return'<td class="gt-ngrades r">'+(t.ngrades_nonempty||"")+"</td>"},tw:2},repo:{th:'<th class="gt-repo" scope="col"></th>',td:function(t){var e;return e=t.repo?E?'<a href="" data-pa-link="'+Y(t.repo)+'" class="ui pa-anonymized-link">repo</a>':'<a class="track" href="'+Y(t.repo)+'">repo</a>':"",t.repo_broken&&(e+=' <strong class="err">broken</strong>'),t.repo_unconfirmed&&(e+=' <strong class="err">unconfirmed</strong>'),t.repo_too_open&&(e+=' <strong class="err">open</strong>'),t.repo_handout_old&&(e+=' <strong class="err">handout</strong>'),t.repo_partner_error&&(e+=' <strong class="err">partner</strong>'),t.repo_sharing&&(e+=' <strong class="err">sharing</strong>'),'<td class="gt-repo">'+e+"</td>"},tw:10}};function O(t){return function(){return t}}function I(){"name"!==T.f&&"name2"!==T.f&&"username"!==T.f&&"email"!==T.f&&null!=T.nameflag||(T.nameflag=0,"name"!==T.f&&"name2"!==T.f||(T.nameflag|=1),T.last&&(T.nameflag|=2),T.email&&(T.nameflag|=4),E&&(T.nameflag|=8))}function D(t){return E&&t.anon_username||t.username||""}function P(t){var e={u:D(t),pset:t.psetid?peteramati_psets[t.psetid].urlkey:a.key};return!t.hash||t.is_grade&&!M?t.gradehash&&(e.commit=t.gradehash,e.commit_is_grade=1):e.commit=t.hash,e}function F(t){return Y(h("pset",P(t)))}function W(t,e){return'<a href="'.concat(F(e),'" class="track',e.dropped?' gt-dropped">':'">',t,"</a>")}function H(t){return W(Y(E&&t.anon_username?t.anon_username:T.email&&t.email?t.email:t.username||""),t)}function B(t,e){return null!=t.first&&null!=t.last?e?t.last.concat(", ",t.first):t.first.concat(" ",t.last):null!=t.first?t.first:null!=t.last?t.last:""}function U(t,e){var a=Y(e&&E?t.anon_username||"?":B(t,j));return e?W(a,t):a}function z(t){var e=E&&t.anon_username||t.username;return"s:"+encodeURIComponent(e).replace(/\./g,"%2E")}function q(t){return t.__nickname||(t.nick?t.__nickname=t.nick:t.nicklen||t.lastpos?t.__nickname=t.name.substr(0,t.nicklen||t.lastpos-1):t.__nickname=t.name),t.__nickname}function J(t){var e,a,i=t.children("tbody"),r=t.children("thead")[0].firstChild.childNodes.length,s=i[0],o=function(t){for(var e={},a=t.find("tbody")[0].firstChild,n=null;a;)a.hasAttribute("data-pa-partner")?n.push(a):e[a.getAttribute("data-pa-spos")]=n=[a],a=a.nextSibling;return e}(t),l=0,u=!1,d=s.firstChild;for(e=0;e!==n.length;++e){for(var h=n[e];(a=d)&&"gt-boring"===a.className;)d=d.nextSibling,s.removeChild(a);h.boringness!==u&&!1!==u&&s.insertBefore($('<tr class="gt-boring"><td colspan="'+r+'"><hr></td></tr>')[0],d),u=h.boringness;var c=o[h._spos];for(a=0;a<c.length;++a)d!==c[a]?s.insertBefore(c[a],d):d=d.nextSibling,b(c[a],"k"+(1-l%2)),v(c[a],"k"+l%2);++l}l=0;i.find(".gt-rownumber").html((function(){return++l+"."}));var p=T.f&&T.last;p!==j&&(j=p,i.find(".gt-name, .gt-name2").html((function(){return U(k[this.parentNode.getAttribute("data-pa-spos")],m(this,"gt-name2"))})))}function K(){for(var t=[],e=0;e!==n.length;++e)t.push(D(n[e]));o.value=t.join(" ")}function V(){J(A),C&&J(C),o&&K(),t.site(!0,"pa-pset"+a.id+"-table",JSON.stringify(T))}function X(){for(var t={},e=A.find("tbody")[0].firstChild;e;)t[e.getAttribute("data-pa-uid")]=e,e=e.nextSibling;return t}function G(){var t=C?$([A[0],C[0]]):A;t.find("td.gt-username").each((function(){var t=k[this.parentNode.getAttribute("data-pa-spos")];$(this).html(H(t))})),t.find("th.gt-username > span.heading").html(E||!T.email?"Username":"Email"),t.find("td.gt-name2").each((function(){var t=k[this.parentNode.getAttribute("data-pa-spos")];$(this).html(U(t,!0))})),t.find("th.gt-name2 > span.heading").html(E?"Username":"Name")}function Q(){A.toggleClass("gt-anonymous",!!E),_&&r&&(A.css("width",_-(E?r.width:0)+"px"),$(A[0].firstChild).find(".gt-name").css("width",(E?0:r.width)+"px"))}function Z(t){(E=!E)||(T.override_anonymous=!0),Q(),G(),A.find("tbody input.gt-check").each((function(){var t=k[this.parentNode.parentNode.getAttribute("data-pa-spos")];this.setAttribute("name",z(t))})),at(),V(),A.closest("form").find("input[name=anonymous]").val(E?1:0),t.preventDefault(),t.stopPropagation()}function tt(t,e){return t._sort_user<e._sort_user?-T.rev:t._sort_user==e._sort_user?0:T.rev}function et(t,e){var a=t.gradercid?siteinfo.pc[t.gradercid]:null,n=e.gradercid?siteinfo.pc[e.gradercid]:null,i=a&&q(a)||"~~~",r=n&&q(n)||"~~~";return i!=r?i<r?-T.rev:T.rev:0}function at(){var t,a=T.f,i=T.rev;if(function(){if(T.nameflag!==N){N=T.nameflag;for(var t=0;t<n.length;++t)n[t]._sort_user=(a=n[t],i=void 0,i="",8&N&&a.anon_username?i=a.anon_username+" ":1&N&&(i=B(a,2==(2&N))+" "),4&N&&a.email?i+=a.email:i+=a.username||"",null!=a.psetid&&(i+=e(" %5d",a.psetid)),null!=a.at&&(i+=e(" %11g",a.at)),i.toLowerCase())}var a,i}(),"name"!==a&&"name2"!==a||E)if("extension"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.x!=e.x?t.x?i:-i:tt(t,e)}));else if("grader"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:et(t,e)||tt(t,e)}));else if("gradestatus"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.grades_visible!=e.grades_visible?t.grades_visible?-1:1:t.has_notes!=e.has_notes?t.has_notes?-1:1:et(t,e)||tt(t,e)}));else if("pset"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.psetid!=e.psetid?peteramati_psets[t.psetid].pos<peteramati_psets[e.psetid].pos?-i:i:t.pos<e.pos?-i:i}));else if("at"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.at!=e.at?t.at<e.at?-i:i:t.pos<e.pos?-i:i}));else if("total"===a)n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.total!=e.total?t.total<e.total?-i:i:-tt(t,e)}));else if((t=/^grade(\d+)$/.exec(a))&&d[+t[1]]){var r=+t[1],s=d[r].type&&"forward"===Ee[d[r].type].sort,o=s?-i:i;n.sort((function(t,e){if(t.boringness!==e.boringness)return t.boringness-e.boringness;var a=t.grades&&t.grades[r],n=e.grades&&e.grades[r];return""===a||null==a||""===n||null==n?""!==a&&null!=a?o:""!==n&&null!=n?-o:-tt(t,e):a<n?-i:a>n?i:s?tt(t,e):-tt(t,e)}))}else"ngrades"===a&&f?n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:t.ngrades_nonempty!==e.ngrades_nonempty?t.ngrades_nonempty<e.ngrades_nonempty?-i:i:-tt(t,e)})):T.email&&!E?(a="username",n.sort((function(t,e){if(t.boringness!==e.boringness)return t.boringness-e.boringness;var a=(t.email||"").toLowerCase(),n=(e.email||"").toLowerCase();return a!==n?""===a||""===n?""===a?i:-i:a<n?-i:i:tt(t,e)}))):("name2"!==a&&(a="username"),n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:tt(t,e)})));else n.sort((function(t,e){return t.boringness!==e.boringness?t.boringness-e.boringness:tt(t,e)}));var l=C?$([A[0].firstChild,C[0].firstChild]):$(A[0].firstChild);l.find(".plsortable").removeClass("plsortactive plsortreverse"),l.find("th[data-pa-sort='"+a+"']").addClass("plsortactive").toggleClass("plsortreverse",T.rev<0)}function nt(t){if(this.hasAttribute("data-pa-sort")){var e,a=this.getAttribute("data-pa-sort");a!==T.f?(T.f=a,"username"===a||"name"===a||"name2"===a||"grader"===a||"extension"===a||"pset"===a||"at"===a||(e=a.match(/^grade(\d+)$/))&&d[e[1]].type&&"forward"===Ee[d[e[1]].type].sort?T.rev=1:T.rev=-1):"name"===a||"name2"===a&&!E?(T.rev=-T.rev,1===T.rev&&(T.last=!T.last)):"username"===a?(-1!==T.rev||E||(T.email=!T.email,G()),T.rev=-T.rev):T.rev=-T.rev,I(),at(),V()}}function it(){x(this.closest(".pa-pd"),"pa-grade-changed",this.hasAttribute("data-pa-unmixed")||be(this))}function rt(t,e,n){for(var i=t[e.uid],r=k[i.getAttribute("data-pa-spos")],s=0,o=0;o!==n.length;++o){var l,u=n[o],d=a.grades.entries[u];d&&(l=g[d.colpos])&&(r.grades[d.pos]!==e.grades[o]&&(r.grades[d.pos]=e.grades[o],i.childNodes[d.colpos].innerText=l.td.call(l,r,null,!0)),null!=e.grades[o]&&""!==e.grades[o]&&++s)}e.total!==r.total&&(r.total=e.total,y&&(i.childNodes[y].innerText=r.total)),s!==r.ngrades_nonempty&&(r.ngrades_nonempty=s,w&&(i.childNodes[w].innerText=r.ngrades_nonempty||""))}function st(t){l.find(".has-error").removeClass("has-error"),t.ok?l.find(".pa-messages").html(""):(l.find(".pa-messages").html(me(2,Y(t.error))),t.errf&&l.find(".pa-gradevalue").each((function(){t.errf[this.name]&&v(this,"has-error")})))}function ot(t){var e=!1,n={};if(l.find(".pa-gradevalue").each((function(){if((this.hasAttribute("data-pa-unmixed")||be(this))&&!this.indeterminate){var t,i=this.name,r=a.grades.entries[i];t="checkbox"===this.type?this.checked?this.value:"":$(this).val();for(var s=0;s!==u.length;++s){var o=u[s];n[o.uid]=n[o.uid]||{grades:{},oldgrades:{}},n[o.uid].grades[i]=t,n[o.uid].oldgrades[i]=o.grades[r.pos]}e=!0}})),e)if(1===u.length)R(c("api/grade",P(u[0])),n[u[0].uid]).then((function(e){st(e),e.ok&&(rt(X(),e,e.order),t())}));else{for(var i=0;i!==u.length;++i)u[i].gradehash&&(n[u[i].uid].commit=u[i].gradehash,n[u[i].uid].commit_is_grade=1);R(c("api/multigrade",{pset:a.key}),{us:JSON.stringify(n)}).then((function(e){if(st(e),e.ok){var a=X();for(var n in e.us)rt(a,e.us[n],e.order);t()}}))}else t()}function lt(){var t=this.getAttribute("data-pa-spos");ot((function(){dt([t])}))}function ut(){b(this,"has-error")}function dt(t){u=[];for(var e=0;e!==t.length;++e)u.push(k[t[e]]);l.find("h2").html(Y(a.title)+" : "+u.map((function(t){return Y(E?t.anon_username:t.username||t.email)})).join(", "));var n=1===u.length?u[0]:null;if(n){var i=(n.first||n.last?n.first+" "+n.last+" ":"")+"<"+n.email+">";l.find(".gt-name-email").html(Y(i)).removeClass("hidden")}else l.find(".gt-name-email").addClass("hidden");if(l.find(".pa-gradelist").toggleClass("pa-pset-hidden",!!u.find((function(t){return!t.grades_visible}))),l.find(".pa-grade").each((function(){for(var t=this.getAttribute("data-pa-grade"),e=a.grades.entries[t],n=u[0].grades[e.pos],i=!1,r=1;r!==u.length;++r){var s=u[r].grades[e.pos];s===n||null==s&&""===n||""===s&&null==n||(i=!0)}i?Re.call(this,e,null,null,{reset:!0,mixed:!0}):Re.call(this,e,n,null,{reset:!0})})),n){for(var r,s=A.find("tbody")[0].firstChild;s&&s.getAttribute("data-pa-spos")!=n._spos;)s=s.nextSibling;for(r=s;r&&(r===s||!r.hasAttribute("data-pa-spos"));)r=r.previousSibling;for(l.find("button[name=prev]").attr("data-pa-spos",r?r.getAttribute("data-pa-spos"):"").prop("disabled",!r),r=s;r&&(r===s||!r.hasAttribute("data-pa-spos"));)r=r.nextSibling;l.find("button[name=next]").attr("data-pa-spos",r?r.getAttribute("data-pa-spos"):"").prop("disabled",!r)}}function ht(t){!t.ctrlKey||"n"!==t.key&&"p"!==t.key||!($b=l.find("button[name="+("n"===t.key?"next":"prev")+"]"))||$b[0].disabled?"Return"===t.key||"Enter"===t.key?(ot((function(){l.close()})),t.stopImmediatePropagation(),t.preventDefault()):"Esc"===t.key||"Escape"===t.key?(t.stopImmediatePropagation(),l.close()):"Backspace"===t.key&&this.hasAttribute("placeholder")&&ct.call(this):(lt.call($b[0]),t.stopImmediatePropagation(),t.preventDefault())}function ct(){this.hasAttribute("placeholder")&&(this.setAttribute("data-pa-unmixed",1),this.removeAttribute("placeholder"),it.call(this))}function pt(){var t=ye();t.push("<h2></h2>"),E||t.push('<strong class="gt-name-email"></strong>'),t.push('<div class="pa-messages"></div>'),t.push('<div class="pa-gradelist in-modal">',"</div>");for(var e=0;e!==d.length;++e)t.push(Ie(d[e],!0,!1));t.pop(),t.push_actions(),t.push('<button type="button" name="bsubmit" class="btn-primary">Save</button>'),t.push('<button type="button" name="cancel">Cancel</button>'),t.push('<button type="button" name="prev" class="btnl">&lt;</button>'),t.push('<button type="button" name="next" class="btnl">&gt;</button>'),(l=t.show(!1)).children(".modal-dialog").addClass("modal-dialog-wide");var a=A.find(".papsel:checked").toArray().map((function(t){return t.parentElement.parentElement.getAttribute("data-pa-spos")})),n=this.closest("tr").getAttribute("data-pa-spos");a.indexOf(n)<0?dt([n]):(l.find("button[name=prev], button[name=next]").prop("disabled",!0).addClass("hidden"),dt(a)),l.on("change blur",".pa-gradevalue",it),l.on("input change",".pa-gradevalue",ut),l.on("keydown",ht),l.on("keydown","input, textarea, select",ht),l.on("input","input, textarea, select",ct),l.find("button[name=bsubmit]").on("click",(function(){ot((function(){l.close()}))})),l.find("button[name=prev], button[name=next]").on("click",lt),t.show()}function ft(){for(var t=0;t!==g.length&&!g[t].pin;++t);var e=$('<div style="position:absolute;left:0;top:0;bottom:0;width:'+(g[t].left-10)+'px;pointer-events:none"></div>').prependTo(A.parent())[0],a=!1,n=!1;var i=new IntersectionObserver((function(t){for(var i of t)i.target===e?n=i.isIntersecting:a=i.isIntersecting;!a||n||C?a&&n&&C&&(C.parent().remove(),C=null):function(){var t,e,a,n=0,i=[];for(t=0;t!==g.length&&!g[t].pin;++t);for(e=t;e!==g.length&&g[e].pin;++e)n+=g[e].width;for(l='<table class="gtable gtable-fixed gtable-overlay new" style="position:absolute;left:-24px;width:'+(n+24)+'px"><thead><tr class="k0 kfade"><th style="width:24px"></th>',a=t;a!==e;++a)l+='<th style="width:'+g[a].width+'px"'+g[a].th.call(g[a]).substring(3);C=$(l+"</thead><tbody></tbody></table>");var r=A[0].firstChild.firstChild,s=C[0].firstChild.firstChild;for(a=t;a!==e;++a)s.childNodes[a-t+1].className=r.childNodes[a].className;for(A[0].parentNode.prepend($('<div style="position:sticky;left:0;z-index:2"></div>').append(C)[0]),C.find("thead").on("click","th",nt),C.find(".js-switch-anon").click(Z),r=A.children("tbody")[0].firstChild;r;){if(m(r,"gt-boring"))i.push('<tr class="gt-boring"><td colspan="'+(e-t+1)+'"><hr></td></tr>');else{var o=r.getAttribute("data-pa-spos"),l='<tr class="'+r.className+' kfade" data-pa-spos="'+o;for(r.hasAttribute("data-pa-uid")&&(l+='" data-pa-uid="'+r.getAttribute("data-pa-uid")),r.hasAttribute("data-pa-partner")&&(l+='" data-pa-partner="1'),l+='"><td></td>',a=t;a!==e;++a)l+='<td style="height:'+r.childNodes[a].clientHeight+'px"'+g[a].td.call(g[a],k[o],"").substring(3);i.push(l+"</tr>")}r=r.nextSibling}C.find("tbody").html(i.join("")),setTimeout((function(){C&&b(C[0],"new")}),0)}()}));i.observe(e),i.observe(A.parent()[0])}function gt(t,e){for(var a=[],n=0;n!==g.length;++n)a.push(g[n].td.call(g[n],t,e));return a}A.parent().on("click","a.js-gdialog",(function(t){pt.call(this),t.preventDefault()})),function(){var e=t.site(!0,"pa-pset"+a.id+"-table");e&&(T=JSON.parse(e)),T.f&&/^\w+$/.test(T.f)||(T.f="username"),1!==T.rev&&-1!==T.rev&&(T.rev=1),E&&a.can_override_anonymous&&T.override_anonymous||delete T.override_anonymous,E&&T.override_anonymous&&(E=!1),null==T.nameflag&&I(),d=[],p=[];var s=[];if(a.grades)for(var l={},u=[],h=0;h!==a.grades.order.length;++h){var c=a.grades.order[h],m=a.grades.entries[c];if("text"!==m.type){d.push(m),p.push(c);var v=m.title||c;u.push(v);var b=v.match(/^(p)(?:art\s*|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i);if(b=(b=b||v.match(/^(q)(?:uestion\s*|(?=\d))([-.a-z\d]+)(?:[\s:]+|$)/i))||v.match(/^[\s:]*()(\S{1,3}[\d.]*)[^\s\d]*[\s:]*/)){for(var x,_=b[1]+b[2],k=v.substring(b[0].length);x=l[_];){if(!0!==x&&(b=x[1].match(/^(\S{1,3}[\d.]*)\S*[\s:]*(.*)$/))&&(s[x[0]]+=b[1],l[s[x[0]]]=[x[0],b[2]],l[_]=x=!0),!(b=k.match(/^(\S{1,3}[\d.]*)[^\s\d]*[\s:]*(.*)$/))){!0!==x&&(_+=":"+p.length);break}_+=b[1],k=b[2]}s.push(_),l[_]=[p.length-1,k]}else s.push(":"+p.length)}}var C=-1;for(h=0;h<n.length;++h){var N=n[h];N.dropped?N.boringness=2:N.gradehash||a.gitless_grades?N.boringness=0:N.boringness=1;for(var j=0,D=0;D<p.length;++D)p[D]!=a.total_key&&null!=N.grades[D]&&""!==N.grades[D]&&++j;N.ngrades_nonempty=j,-1===C?C=j:C!==j&&(!N.boringness||j>0)&&(C=-2)}if(f=-2===C,a.col)g=a.col;else{for(g=[],a.checkbox&&g.push("checkbox"),g.push("rownumber"),M?(g.push("pset"),g.push("at")):g.push("gdialog"),g.push("username","name","extension","grader"),M&&g.push("conversation"),(M||!a.gitless_grades||S)&&g.push("notes"),a.need_total&&(y=g.length,g.push("total")),h=0;h!==p.length;++h){var P=d[h].type,R=Ee[P||"numeric"];d[h].colpos=g.length,g.push({type:"grade",gidx:h,gkey:p[h],gabbr:s[h],ge:d[h],typeinfo:R,justify:R.justify||"right"})}f&&(w=g.length,g.push("ngrades")),a.gitless||g.push("repo")}for(h=0;h!==g.length;++h)"string"==typeof g[h]&&(g[h]={type:g[h]}),g[h].index=h,Object.assign(g[h],L[g[h].type]),"string"==typeof g[h].th&&(g[h].th=O(g[h].th)),"username"!==g[h].type||i||(i=g[h]),"name"!==g[h].type||r||(r=g[h]);A[0].closest("form")&&(o=$('<input name="slist" type="hidden" value="">')[0],A.after(o))}(),function(){for(var t=$('<thead><tr class="k0"></tr></thead>')[0],e=A.hasClass("want-gtable-fixed"),i=parseFloat(window.getComputedStyle(document.documentElement).fontSize),r=0;r!==g.length;++r){var s=g[r].th.call(g[r]),l=$(s);if(e){g[r].left=_;var u=g[r].tw;"number"!=typeof u&&(u=u.call(g[r])),u*=i,g[r].width=u,l.css("width",u+"px"),_+=u}t.firstChild.appendChild(l[0])}Q(),A[0].appendChild(t),A.toggleClass("gt-useemail",!!T.email),A.find("thead").on("click","th",nt),A.find(".js-switch-anon").click(Z),e&&A.removeClass("want-gtable-fixed").css("table-layout","fixed");var d=$('<tbody class="has-hotlist"></tbody>')[0],h=0,c=0,p=[];for(A[0].appendChild(d),a.no_sort||at(),j="name"===T.f&&T.last,r=0;r!==n.length;++r){var f=n[r];f._spos=k.length,k.push(f),++h,f.boringness!==c&&1!=h&&p.push('<tr class="gt-boring"><td colspan="'+g.length+'"><hr></td></tr>'),c=f.boringness;var m=gt(f,h),v='<tr class="k'+h%2+'" data-pa-spos="'+f._spos;f.uid&&(v+='" data-pa-uid="'+f.uid),p.push(v+'">'+m.join("")+"</tr>");for(var b=0;f.partners&&b<f.partners.length;++b){var x=f.partners[b];x._spos=k.length,k.push(x);for(var y=gt(f.partners[b],""),w=0;w<y.length;++w)y[w]===m[w]&&(y[w]="<td></td>");v='<tr class="k'+h%2+' gtrow-partner" data-pa-spos="'+x._spos,x.uid&&(v+='" data-pa-uid="'+x.uid),p.push(v+'" data-pa-partner="1">'+y.join("")+"</tr>")}p.length>50&&($(p.join("")).appendTo(d),p=[])}0!==p.length&&$(p.join("")).appendTo(d),o&&K(),e&&window.IntersectionObserver&&ft()}(),A.data("paTable",{name_text:function(t){var e,a=A.find("tr[data-pa-uid="+t+"]").attr("data-pa-spos");return a?(e=k[a])?(E?e.anon_username:B(e,j))||"?":"[none]":null}}),A.children("tbody").on("pa-hotlist",(function(t){for(var e=[],i=0;i<n.length;++i){var r=n[i],s="~".concat(encodeURIComponent(D(r)));M&&(s=s.concat("/pset/",peteramati_psets[r.psetid].urlkey),r.hash&&(s=s.concat("/",r.hash))),e.push(s)}t.hotlist={pset:M?null:a.key,items:e}}))},runmany:function t(){var e=$("#runmany61"),a=e.closest("form");if(a.prop("unload61")||($(window).on("beforeunload",(function(){if(a.prop("outstanding")||$("#runmany61_users").text())return"Several server requests are outstanding."})),a.prop("unload61","1")),!a.prop("outstanding")){for(var n,i=$("#runmany61_users").text().split(/[\s,;]+/);!n&&i.length;)n=i.shift();if(!n)return $("#runmany61_who").text("<done>"),void $("#runmany61_users").text("");$("#runmany61_who").text(n),a.find("[name='u']").val(n),$("#runmany61_users").text(i.join(" "));var r=$('<a href="'+siteinfo.site_relative+"~"+encodeURIComponent(n)+"/pset/"+a.find("[name='pset']").val()+'" class="q ansib ansifg7"></a>');r.text(n),Xt(e[0],{noclear:!0,headline:r[0]})}setTimeout(t,10)}}}();
//# sourceMappingURL=pa.min.js.map?mtime=1604190646
